<html>
  <head>
    <meta charSet="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>
      Community detection or Principal Component Analysis - Different apporaches to analyze big datasets
    </title>
    <meta name="description" content="The goal of this blogpost is to showcase different methods to analyze big datasets. The graph-Analysis apporach featuring community detection and ontology enrichment vs the principal component analysis approach that reduces the dimensions of complex datasets."/>
    <meta name="tags" content="CSB, Computational Systems Biology, computational biology, bioinformatics, data science, datascience, research, F#, C#, .NET, dotnet"/>
    <meta name="og:title" content="Community detection or Principal Component Analysis - Different apporaches to analyze big datasets"/>
    <meta name="og:description" content="The goal of this blogpost is to showcase different methods to analyze big datasets. The graph-Analysis apporach featuring community detection and ontology enrichment vs the principal component analysis approach that reduces the dimensions of complex datasets."/>
    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:site" content="@fslaborg"/>
    <meta name="twitter:title" content="Community detection or Principal Component Analysis - Different apporaches to analyze big datasets"/>
    <meta name="twitter:description" content="The goal of this blogpost is to showcase different methods to analyze big datasets. The graph-Analysis apporach featuring community detection and ontology enrichment vs the principal component analysis approach that reduces the dimensions of complex datasets."/>
    <link rel="icon" type="image/png" sizes="32x32" href="https://csbiology.github.io/CSBlog/img/favicon.png"/>
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css"/>
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/@creativebulma/bulma-collapsible@1.0.4/dist/css/bulma-collapsible.min.css"/>
    <script src="https://cdn.jsdelivr.net/npm/@creativebulma/bulma-collapsible@1.0.4/dist/js/bulma-collapsible.min.js"></script>
    <script src="https://csbiology.github.io/CSBlog/js/main.js"></script>
    <script>
      MathJax = {tex: {inlineMath: [['$', '$'], ['\\(', '\\)']]}}
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-svg.js"></script>
    <script defer="true" src="https://kit.fontawesome.com/0d3e0ea7a6.js" crossOrigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma-timeline@3.0.5/dist/css/bulma-timeline.min.css"/>
    <link rel="stylesheet" href="https://csbiology.github.io/CSBlog/styles/notebook.css"/>
    <link rel="stylesheet" href="https://csbiology.github.io/CSBlog/styles/custom.css"/>
  </head>
  <body>
    <div class="columns is-fullheight m-0">
      <div class="column is-2 is-paddingless box m-0">
        <aside class="menu p-4" id="graph-menu">
          <div class="content">
            <h3 class="title is-black is-capitalized is-inline-block is-emphasized-csb-darkblue mb-4">
              Table of contents
            </h3>
            <ul>
              <li>
                <a href="#Study-note:-Community-detection-or-Principal-Component-Analysis---Different-apporaches-to-analyze-big-datasets" class="orange-link">
                  Study note: Community detection or Principal Component Analysis   Different apporaches to analyze big datasets
                </a>
              </li>
              <li>
                <a href="#Introduction" class="orange-link">
                  Introduction
                </a>
              </li>
              <li>
                <a href="#Loading-the-previous-graph" class="orange-link">
                  Loading the previous graph
                </a>
              </li>
              <li>
                <a href="#Modularity" class="orange-link">
                  Modularity
                </a>
              </li>
              <li>
                <a href="#PCA---Principal-component-analysis" class="orange-link">
                  PCA   Principal component analysis
                </a>
              </li>
              <li>
                <a href="#Ontology-Enrichment" class="orange-link">
                  Ontology Enrichment
                </a>
              </li>
              <li>
                <a href="#Further-reading" class="orange-link">
                  Further reading
                </a>
              </li>
            </ul>
          </div>
        </aside>
      </div>
      <div class="column is-10 is-paddingless pl-1 pr-6">
        <nav class="navbar is-dark is-spaced" role="navigation" aria-label="main navigation">
          <div class="navbar-brand">
            <a class="navbar-item" href="https://csbiology.github.io/CSBlog/">
              <img src="https://csbiology.github.io/CSBlog/img/logo_small.png"/>
            </a>
            <a role="button" class="navbar-burger burger" aria-label="menu" aria-expanded="false" data-target="navbar">
              <span aria-hidden="true"></span>
              <span aria-hidden="true"></span>
              <span aria-hidden="true"></span>
            </a>
          </div>
          <div id="navbar" class="navbar-menu">
            <div class="navbar-start">
              <a class="navbar-item" href="https://csbiology.github.io/CSBlog/">
                Home
              </a>
              <a class="navbar-item" href="https://csbiology.github.io/CSBlog/posts/all_posts.html">
                Posts
              </a>
            </div>
            <div class="navbar-end">
              <a href="#" class="navbar-item">
                <i class="fa fa-search"></i>
              </a>
              <a href="#" class="navbar-item">
                <i class="fa fa-shopping-bag"></i>
              </a>
            </div>
          </div>
        </nav>
        <section class="hero is-small is-warning is-bold">
          <div class="hero-body">
            <div class="container has-text-justified">
              <div class="main-TextField">
                <h1 class="title is-capitalized is-black is-inline-block is-emphasized-csb-orange mb-4">
                  Community detection or Principal Component Analysis - Different apporaches to analyze big datasets
                </h1>
                <div class="block">
                  <h3 class="subtitle is-black is-block">
                    Posted on 2022-1-13 by
                    <a href="https://github.com/librachris" class="orange-link">
                      Christopher Lux
                    </a>
                     in 
                    <a href="https://csbiology.github.io/CSBlog/posts/categories/StudyNote.html" class="orange-link">
                      Study Notes
                    </a>
                  </h3>
                </div>
              </div>
            </div>
          </div>
        </section>
        <div class="content jp-Notebook" data-jp-theme-light="true" data-jp-theme-name="JupyterLab Light">
          

<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<h1 id="Study-note:-Community-detection-or-Principal-Component-Analysis---Different-apporaches-to-analyze-big-datasets">Study note: Community detection or Principal Component Analysis - Different apporaches to analyze big datasets<a class="anchor-link" href="#Study-note:-Community-detection-or-Principal-Component-Analysis---Different-apporaches-to-analyze-big-datasets">&#182;</a></h1>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<h2 id="Introduction">Introduction<a class="anchor-link" href="#Introduction">&#182;</a></h2><p>This tutorial picks up where the Fslab advanced tutorials <a href="https://fslab.org/content/tutorials/009_correlation-network.html">Correlation network</a> ended.
 The goal of this blogpost is to showcase different methods to analyze big datasets:
The graph-Analysis apporach featuring community detection and ontology enrichment vs 
the principal component analysis approach that reduces the dimensions of complex datasets.</p>
<p>We are using the following libraries:</p>
<ol>
<li><a href="https://github.com/fslaborg/Deedle">Deedle</a></li>
<li><a href="https://github.com/plotly/Plotly.NET/">Plotly.NET</a></li>
<li><a href="https://github.com/fslaborg/Cyjs.NET">Cyjs.NET</a></li>
<li><a href="https://github.com/CSBiology/BioFSharp">BioFSharp</a></li>
<li><a href="https://github.com/fsprojects/FSharp.Data">FSharp.Data</a></li>
<li><a href="https://github.com/fslaborg/FSharp.Stats">FSharp.Stats</a></li>
<li><a href="https://github.com/CSBiology/FSharp.FGL">FSharp.FGL</a></li>
</ol>
<h2 id="Loading-the-previous-graph">Loading the previous graph<a class="anchor-link" href="#Loading-the-previous-graph">&#182;</a></h2><p>We start by recreating the graph depicted in <a href="https://fslab.org/content/tutorials/009_correlation-network.html">Correlation network</a> .</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[10]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-F#"><pre><span></span><span class="o">#</span><span class="n">r</span><span class="w"> </span><span class="s">"nuget: FSharp.Data, 4.2.7"</span>
<span class="o">#</span><span class="n">r</span><span class="w"> </span><span class="s">"nuget: Deedle, 2.5.0"</span>
<span class="o">#</span><span class="n">r</span><span class="w"> </span><span class="s">"nuget: FSharp.Stats, 0.4.3"</span>
<span class="o">#</span><span class="n">r</span><span class="w"> </span><span class="s">"nuget: Cyjs.NET, 0.0.4"</span>
<span class="o">#</span><span class="n">r</span><span class="w"> </span><span class="s">"nuget: Plotly.NET, 4.0.0"</span>
<span class="o">#</span><span class="n">r</span><span class="w"> </span><span class="s">"nuget: Plotly.NET.Interactive, 4.0.0"</span>

<span class="k">open</span><span class="w"> </span><span class="nn">Deedle</span>
<span class="k">open</span><span class="w"> </span><span class="nn">FSharp.Data</span>
<span class="k">open</span><span class="w"> </span><span class="nn">FSharp.Stats</span>
<span class="k">open</span><span class="w"> </span><span class="nn">FSharp.Stats.Testing</span>
<span class="k">open</span><span class="w"> </span><span class="nn">Cyjs.NET</span>
<span class="k">open</span><span class="w"> </span><span class="nn">Plotly.NET</span>
<span class="k">open</span><span class="w"> </span><span class="nn">Plotly.NET.StyleParam</span>
<span class="k">open</span><span class="w"> </span><span class="nn">Plotly.NET.Interactive</span>

<span class="c1">// Load the data </span>
<span class="k">let</span><span class="w"> </span><span class="nv">rawData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nn">Http</span><span class="p">.</span><span class="n">RequestString</span><span class="w"> </span><span class="s">@"https://raw.githubusercontent.com/HLWeil/datasets/main/data/ecoliGeneExpression.tsv"</span>

<span class="c1">// Create a deedle frame and index the rows with the values of the "Key" column.</span>
<span class="k">let</span><span class="w"> </span><span class="nv">rawFrame</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Frame</span><span class="o">&lt;</span><span class="kt">string</span><span class="o">,</span><span class="kt">string</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
<span class="w">    </span><span class="nn">Frame</span><span class="p">.</span><span class="n">ReadCsvString</span><span class="o">(</span><span class="n">rawData</span><span class="o">,</span><span class="w"> </span><span class="n">separators</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"</span><span class="se">\t</span><span class="s">"</span><span class="o">)</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">Frame</span><span class="p">.</span><span class="n">take</span><span class="w"> </span><span class="mi">500</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">Frame</span><span class="p">.</span><span class="n">indexRows</span><span class="w"> </span><span class="s">"Key"</span>

<span class="c1">// Get the rows as a matrix</span>
<span class="k">let</span><span class="w"> </span><span class="nv">rows</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
<span class="w">    </span><span class="n">rawFrame</span><span class="w"> </span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">Frame</span><span class="p">.</span><span class="n">toJaggedArray</span><span class="w"> </span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">Matrix</span><span class="p">.</span><span class="n">ofJaggedArray</span>

<span class="c1">// Create a correlation network by computing the pearson correlation between every two rows</span>
<span class="k">let</span><span class="w"> </span><span class="nv">correlationNetwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
<span class="w">    </span><span class="nn">Correlation</span><span class="p">.</span><span class="nn">Matrix</span><span class="p">.</span><span class="n">rowWisePearson</span><span class="w"> </span><span class="n">rows</span>

<span class="k">let</span><span class="w"> </span><span class="nv">thr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="o">.</span><span class="mi">8203125</span>

<span class="c1">// Set all correlations less strong than the critical threshold to 0</span>
<span class="k">let</span><span class="w"> </span><span class="nv">filteredNetwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
<span class="w">    </span><span class="n">correlationNetwork</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">Matrix</span><span class="p">.</span><span class="n">map</span><span class="w"> </span><span class="o">(</span><span class="k">fun</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="o">(</span><span class="n">abs</span><span class="w"> </span><span class="n">v</span><span class="o">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">thr</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="mi">0</span><span class="o">.)</span>

<span class="c1">// The styled vertices. The size is based on the degree of this vertex, so that more heavily connected nodes are emphasized</span>
<span class="k">let</span><span class="w"> </span><span class="nv">cytoVertices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
<span class="w">    </span><span class="n">rawFrame</span><span class="o">.</span><span class="n">RowKeys</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">Seq</span><span class="p">.</span><span class="n">toList</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">List</span><span class="p">.</span><span class="n">indexed</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">List</span><span class="p">.</span><span class="n">choose</span><span class="w"> </span><span class="o">(</span><span class="k">fun</span><span class="w"> </span><span class="o">(</span><span class="n">i</span><span class="o">,</span><span class="n">v</span><span class="o">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span>
<span class="w">        </span><span class="k">let</span><span class="w"> </span><span class="nv">degree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
<span class="w">            </span><span class="nn">Matrix</span><span class="p">.</span><span class="n">getRow</span><span class="w"> </span><span class="n">filteredNetwork</span><span class="w"> </span><span class="n">i</span><span class="w"> </span>
<span class="w">            </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">Seq</span><span class="p">.</span><span class="n">filter</span><span class="w"> </span><span class="o">((&lt;&gt;)</span><span class="w"> </span><span class="mi">0</span><span class="o">.)</span>
<span class="w">            </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">Seq</span><span class="p">.</span><span class="n">length</span>
<span class="w">        </span><span class="k">let</span><span class="w"> </span><span class="nv">styling</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="nn">CyParam</span><span class="p">.</span><span class="n">label</span><span class="w"> </span><span class="n">v</span><span class="o">;</span><span class="w"> </span><span class="nn">CyParam</span><span class="p">.</span><span class="n">weight</span><span class="w"> </span><span class="o">(</span><span class="n">sqrt</span><span class="w"> </span><span class="o">(</span><span class="kt">float</span><span class="w"> </span><span class="n">degree</span><span class="o">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="o">.</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="o">(*)</span><span class="w"> </span><span class="mi">10</span><span class="o">.)]</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">degree</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">then</span><span class="w"> </span>
<span class="w">            </span><span class="n">Some</span><span class="w"> </span><span class="o">(</span><span class="nn">Elements</span><span class="p">.</span><span class="n">node</span><span class="w"> </span><span class="o">(</span><span class="kt">string</span><span class="w"> </span><span class="n">i</span><span class="o">)</span><span class="w"> </span><span class="n">styling</span><span class="o">)</span>
<span class="w">        </span><span class="k">else</span><span class="w"> </span>
<span class="w">            </span><span class="n">None</span>
<span class="w">    </span><span class="o">)</span>

<span class="c1">// Styled edges</span>
<span class="k">let</span><span class="w"> </span><span class="nv">cytoEdgesOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
<span class="w">    </span><span class="k">let</span><span class="w"> </span><span class="nv">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">filteredNetwork</span><span class="o">.</span><span class="n">Dimensions</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">fst</span>
<span class="w">    </span><span class="o">[</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">do</span>
<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">do</span>
<span class="w">                </span><span class="k">let</span><span class="w"> </span><span class="nv">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">filteredNetwork</span><span class="o">.[</span><span class="n">i</span><span class="o">,</span><span class="n">j</span><span class="o">]</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="mi">0</span><span class="o">.</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">yield</span><span class="w"> </span><span class="n">i</span><span class="o">,</span><span class="n">j</span><span class="o">,</span><span class="n">v</span>
<span class="w">    </span><span class="o">]</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">List</span><span class="p">.</span><span class="n">mapi</span><span class="w"> </span><span class="o">(</span><span class="k">fun</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">(</span><span class="n">v1</span><span class="o">,</span><span class="n">v2</span><span class="o">,</span><span class="n">weight</span><span class="o">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span>
<span class="w">        </span><span class="k">let</span><span class="w"> </span><span class="nv">styling</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="nn">CyParam</span><span class="p">.</span><span class="n">weight</span><span class="w"> </span><span class="o">(</span><span class="mi">0</span><span class="o">.</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">weight</span><span class="o">)]</span>
<span class="w">        </span><span class="nn">Elements</span><span class="p">.</span><span class="n">edge</span><span class="w"> </span><span class="o">(</span><span class="s">"e"</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">i</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="kt">string</span><span class="w"> </span><span class="n">v1</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="kt">string</span><span class="w"> </span><span class="n">v2</span><span class="o">)</span><span class="w"> </span><span class="n">styling</span>
<span class="w">    </span><span class="o">)</span>
<span class="w">   </span>
<span class="c1">// Resulting cytograph</span>
<span class="k">let</span><span class="w"> </span><span class="nv">cytoGraph</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>

<span class="w">    </span><span class="nn">CyGraph</span><span class="p">.</span><span class="n">initEmpty</span><span class="w"> </span><span class="bp">()</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">CyGraph</span><span class="p">.</span><span class="n">withElements</span><span class="w"> </span><span class="n">cytoVertices</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">CyGraph</span><span class="p">.</span><span class="n">withElements</span><span class="w"> </span><span class="n">cytoEdgesOG</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">CyGraph</span><span class="p">.</span><span class="n">withStyle</span><span class="w"> </span><span class="s">"node"</span><span class="w"> </span>
<span class="w">        </span><span class="o">[</span>
<span class="w">            </span><span class="nn">CyParam</span><span class="p">.</span><span class="n">shape</span><span class="w"> </span><span class="s">"circle"</span>
<span class="w">            </span><span class="nn">CyParam</span><span class="p">.</span><span class="n">content</span><span class="w"> </span><span class="o">=.</span><span class="w"> </span><span class="nn">CyParam</span><span class="p">.</span><span class="n">label</span>
<span class="w">            </span><span class="nn">CyParam</span><span class="p">.</span><span class="n">width</span><span class="w"> </span><span class="o">=.</span><span class="w"> </span><span class="nn">CyParam</span><span class="p">.</span><span class="n">weight</span>
<span class="w">            </span><span class="nn">CyParam</span><span class="p">.</span><span class="n">height</span><span class="w"> </span><span class="o">=.</span><span class="w"> </span><span class="nn">CyParam</span><span class="p">.</span><span class="n">weight</span>
<span class="w">            </span><span class="nn">CyParam</span><span class="p">.</span><span class="nn">Text</span><span class="p">.</span><span class="nn">Align</span><span class="p">.</span><span class="n">center</span>
<span class="w">            </span><span class="nn">CyParam</span><span class="p">.</span><span class="nn">Border</span><span class="p">.</span><span class="n">color</span><span class="w"> </span><span class="s">"#A00975"</span>
<span class="w">            </span><span class="nn">CyParam</span><span class="p">.</span><span class="nn">Border</span><span class="p">.</span><span class="n">width</span><span class="w"> </span><span class="mi">3</span>
<span class="w">        </span><span class="o">]</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">CyGraph</span><span class="p">.</span><span class="n">withStyle</span><span class="w"> </span><span class="s">"edge"</span><span class="w"> </span>
<span class="w">        </span><span class="o">[</span>
<span class="w">            </span><span class="nn">CyParam</span><span class="p">.</span><span class="nn">Line</span><span class="p">.</span><span class="n">color</span><span class="w"> </span><span class="s">"#3D1244"</span>
<span class="w">        </span><span class="o">]</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">CyGraph</span><span class="p">.</span><span class="n">withLayout</span><span class="w"> </span><span class="o">(</span><span class="nn">Layout</span><span class="p">.</span><span class="n">initCose</span><span class="w"> </span><span class="o">(</span><span class="nn">Layout</span><span class="p">.</span><span class="nn">LayoutOptions</span><span class="p">.</span><span class="n">Cose</span><span class="o">(</span><span class="n">NodeOverlap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">400</span><span class="o">,</span><span class="n">ComponentSpacing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span><span class="o">)))</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output " data-mime-type="text/html">
<div><div></div><div></div><div><strong>Installed Packages</strong><ul><li><span>Cyjs.NET, 0.0.4</span></li><li><span>Deedle, 2.5.0</span></li><li><span>FSharp.Data, 4.2.7</span></li><li><span>FSharp.Stats, 0.4.3</span></li><li><span>Plotly.NET, 4.0.0</span></li><li><span>Plotly.NET.Interactive, 4.0.0</span></li></ul></div></div>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p><img src="https://csbiology.github.io/CSBlog/img/cytoGrap.png" alt="Cytograph_Ontology"></p>
<p>Now to recreate this graph in FSharp.FGl.ArrayAdjacencyGraph we simply have to create a vertex list and an edge list:
Once again we are using the data from <a href="https://fslab.org/content/tutorials/009_correlation-network.html">Correlation network</a> .</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[11]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-F#"><pre><span></span><span class="o">#</span><span class="n">r</span><span class="w"> </span><span class="s">"nuget: FSharp.FGL, 0.0.2"</span>
<span class="o">#</span><span class="n">r</span><span class="w"> </span><span class="s">"nuget: FSharp.FGL.ArrayAdjacencyGraph, 0.0.2"</span>

<span class="k">open</span><span class="w"> </span><span class="nn">FSharp.FGL.ArrayAdjacencyGraph</span>

<span class="c1">// Creates a vertex list based on the cytoVertices</span>
<span class="k">let</span><span class="w"> </span><span class="nv">vertexList</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="n">rawFrame</span><span class="o">.</span><span class="n">RowKeys</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">Seq</span><span class="p">.</span><span class="n">toList</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">List</span><span class="p">.</span><span class="n">indexed</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">List</span><span class="p">.</span><span class="n">choose</span><span class="w"> </span><span class="o">(</span><span class="k">fun</span><span class="w"> </span><span class="o">(</span><span class="n">i</span><span class="o">,</span><span class="n">v</span><span class="o">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span>
<span class="w">        </span><span class="k">let</span><span class="w"> </span><span class="nv">degree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
<span class="w">            </span><span class="nn">Matrix</span><span class="p">.</span><span class="n">getRow</span><span class="w"> </span><span class="n">filteredNetwork</span><span class="w"> </span><span class="n">i</span><span class="w"> </span>
<span class="w">            </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">Seq</span><span class="p">.</span><span class="n">filter</span><span class="w"> </span><span class="o">((&lt;&gt;)</span><span class="w"> </span><span class="mi">0</span><span class="o">.)</span>
<span class="w">            </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">Seq</span><span class="p">.</span><span class="n">length</span>
<span class="w">        </span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">degree</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">then</span><span class="w"> </span>
<span class="w">            </span><span class="n">Some</span><span class="w"> </span><span class="o">(</span><span class="n">i</span><span class="o">,</span><span class="n">v</span><span class="o">)</span>
<span class="w">        </span><span class="k">else</span>
<span class="w">            </span><span class="n">None</span>
<span class="w">    </span><span class="o">)</span>

<span class="c1">// Creates an edge list based on the cytoEdges</span>
<span class="k">let</span><span class="w"> </span><span class="nv">edgeList</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="k">let</span><span class="w"> </span><span class="nv">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">filteredNetwork</span><span class="o">.</span><span class="n">Dimensions</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">fst</span>
<span class="w">    </span><span class="o">[</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">do</span>
<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">do</span>
<span class="w">                </span><span class="k">let</span><span class="w"> </span><span class="nv">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">filteredNetwork</span><span class="o">.[</span><span class="n">i</span><span class="o">,</span><span class="n">j</span><span class="o">]</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="mi">0</span><span class="o">.</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">yield</span><span class="w"> </span><span class="n">i</span><span class="o">,</span><span class="n">j</span><span class="o">,</span><span class="n">v</span>
<span class="w">    </span><span class="o">]</span>

<span class="c1">// Creates an ArrayAdjacencyGraph based on vertexList and edgeList</span>
<span class="k">let</span><span class="w"> </span><span class="nv">startingGraph</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
<span class="w">    </span><span class="nn">Graph</span><span class="p">.</span><span class="n">createOfEdgelist</span><span class="w"> </span><span class="n">vertexList</span><span class="w"> </span><span class="n">edgeList</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output " data-mime-type="text/html">
<div><div></div><div></div><div><strong>Installed Packages</strong><ul><li><span>FSharp.FGL, 0.0.2</span></li><li><span>FSharp.FGL.ArrayAdjacencyGraph, 0.0.2</span></li></ul></div></div>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<h2 id="Modularity">Modularity<a class="anchor-link" href="#Modularity">&#182;</a></h2><p>One crucial factor in network science is the ability to represent large datasets in comprehensible graphs.
But when these graphs get to large, it is often very difficult to retrieve useful data from them without using some form of simplification.
One such method is the decomposition of networks into communities, sets of highly interconnected vertices.
By reducing the information of each of the vertices into these communities the size of the network can be reduced quite effectively.
The interdependence of the community-building vertices is often based on a functional module that the vertices belong to.
As such, the detection of communities is a really interesting factor in network science.
The Louvain-algorithm, published in <a href="https://doi.org/10.1088%2F1742-5468%2F2008%2F10%2FP10008">Blondel, Vincent D; Guillaume, Jean-Loup; Lambiotte, Renaud; Lefebvre, Etienne (9 October 2008). "Fast unfolding of communities in large networks". Journal of Statistical Mechanics: Theory and Experiment. 2008 (10): P10008. arXiv:0803.0476. Bibcode:2008JSMTE..10..008B. doi:10.1088/1742-5468/2008/10/P10008. S2CID 334423</a> ,
is one of the possible algorithms for community detection and has been integrated into <a href="https://github.com/CSBiology/FSharp.FGL">FSharp.FGL</a>.</p>
<p>Here we apply this algorithm on our existing graph:</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[12]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-F#"><pre><span></span><span class="k">open</span><span class="w"> </span><span class="nn">ArrayAdjacencyGraph.Algorithms.Louvain.Louvain</span>

<span class="c1">// The graph after being grouped into communities</span>
<span class="k">let</span><span class="w"> </span><span class="nv">louvainGraph</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
<span class="w">    </span><span class="n">louvain</span><span class="w"> </span><span class="n">startingGraph</span><span class="w"> </span><span class="mi">0</span><span class="o">.</span><span class="mi">1</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
<pre>new modularity= 0.4884290168
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>The Louvain algorithm reveals that the graph can be rationed into 34 communities. 
In the following steps, we color the communities that feature more than 5 members using Cyjs.Net.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[13]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-F#"><pre><span></span><span class="c1">// Map that connected the community identifier with a color codex</span>
<span class="k">let</span><span class="w"> </span><span class="nv">colorMap</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span>
<span class="w">    </span><span class="c1">// List of all communities that have more than 5 members</span>
<span class="w">    </span><span class="k">let</span><span class="w"> </span><span class="nv">communitiesToColorList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
<span class="w">        </span><span class="nn">Vertices</span><span class="p">.</span><span class="n">getLabelList</span><span class="w"> </span><span class="n">louvainGraph</span>
<span class="w">        </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">Array</span><span class="p">.</span><span class="n">map</span><span class="w"> </span><span class="o">(</span><span class="n">snd</span><span class="o">)</span>
<span class="w">        </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">Array</span><span class="p">.</span><span class="n">countBy</span><span class="w"> </span><span class="o">(</span><span class="k">fun</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">x</span><span class="o">)</span>
<span class="w">        </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">Array</span><span class="p">.</span><span class="n">choose</span><span class="o">(</span><span class="k">fun</span><span class="w"> </span><span class="o">(</span><span class="n">m</span><span class="o">,</span><span class="n">count</span><span class="o">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="k">then</span>
<span class="w">                </span><span class="n">Some</span><span class="w"> </span><span class="n">m</span>
<span class="w">            </span><span class="k">else</span>
<span class="w">                </span><span class="n">None</span>
<span class="w">            </span><span class="o">)</span>
<span class="w">        </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">List</span><span class="p">.</span><span class="n">ofArray</span>

<span class="w">    </span><span class="c1">// List of hexadecimal colors. </span>
<span class="w">    </span><span class="o">[</span>
<span class="w">        </span><span class="s">"#A00976"</span><span class="o">;</span>
<span class="w">        </span><span class="s">"#D68A0C"</span><span class="o">;</span>
<span class="w">        </span><span class="s">"#13478D"</span><span class="o">;</span>
<span class="w">        </span><span class="s">"#9ACB0B"</span><span class="o">;</span>
<span class="w">        </span><span class="s">"#C249A1"</span><span class="o">;</span>
<span class="w">        </span><span class="s">"#FFC360"</span><span class="o">;</span>
<span class="w">        </span><span class="s">"#4B74AD"</span><span class="o">;</span>
<span class="w">        </span><span class="s">"#CCF35C"</span><span class="o">;</span>
<span class="w">        </span><span class="s">"#640048"</span><span class="o">;</span>
<span class="w">        </span><span class="s">"#855300"</span><span class="o">;</span>
<span class="w">        </span><span class="s">"#052858"</span><span class="o">;</span>
<span class="w">        </span><span class="s">"#5E7F00"</span><span class="o">;</span>
<span class="w">        </span><span class="s">"#CC0000"</span><span class="o">;</span>
<span class="w">        </span><span class="s">"#FFC0CB"</span>

<span class="w">    </span><span class="o">]</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">List</span><span class="p">.</span><span class="n">map2</span><span class="o">(</span><span class="k">fun</span><span class="w"> </span><span class="n">community</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">(</span><span class="n">community</span><span class="o">,</span><span class="n">color</span><span class="o">))</span><span class="w"> </span><span class="n">communitiesToColorList</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">Map</span><span class="p">.</span><span class="n">ofList</span>

<span class="c1">// Map that maps the gene name to the color it is associated with because of its community</span>
<span class="k">let</span><span class="w"> </span><span class="nv">geneNameToColor</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">let</span><span class="w"> </span><span class="nv">louvainLabelToColor</span><span class="o">=</span><span class="w"> </span>
<span class="w">        </span><span class="nn">Vertices</span><span class="p">.</span><span class="n">getLabelList</span><span class="w"> </span><span class="n">louvainGraph</span>
<span class="w">        </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">Array</span><span class="p">.</span><span class="n">countBy</span><span class="w"> </span><span class="o">(</span><span class="k">fun</span><span class="w"> </span><span class="o">(</span><span class="n">gene</span><span class="o">,</span><span class="n">x</span><span class="o">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">x</span><span class="o">)</span>
<span class="w">        </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">Array</span><span class="p">.</span><span class="n">choose</span><span class="o">(</span><span class="k">fun</span><span class="w"> </span><span class="o">(</span><span class="n">m</span><span class="o">,</span><span class="n">count</span><span class="o">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="k">then</span>
<span class="w">                </span><span class="n">Some</span><span class="w"> </span><span class="n">m</span>
<span class="w">            </span><span class="k">else</span>
<span class="w">                </span><span class="n">None</span>
<span class="w">            </span><span class="o">)</span>
<span class="w">        </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">Array</span><span class="p">.</span><span class="n">map</span><span class="o">(</span><span class="k">fun</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">(</span><span class="n">x</span><span class="o">,</span><span class="n">colorMap</span><span class="o">.</span><span class="n">Item</span><span class="w"> </span><span class="o">(</span><span class="n">x</span><span class="o">)))</span>
<span class="w">        </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">Map</span><span class="p">.</span><span class="n">ofArray</span>

<span class="w">    </span><span class="nn">Vertices</span><span class="p">.</span><span class="n">getLabelList</span><span class="w"> </span><span class="n">louvainGraph</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">Array</span><span class="p">.</span><span class="n">map</span><span class="o">(</span><span class="k">fun</span><span class="w"> </span><span class="o">(</span><span class="n">gene</span><span class="o">,</span><span class="n">label</span><span class="o">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span>
<span class="w">        </span><span class="o">(</span><span class="n">gene</span><span class="o">,</span>
<span class="w">            </span><span class="o">(</span><span class="k">if</span><span class="w"> </span><span class="o">(</span><span class="nn">Map</span><span class="p">.</span><span class="n">containsKey</span><span class="w"> </span><span class="n">label</span><span class="w"> </span><span class="n">louvainLabelToColor</span><span class="o">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="nn">Map</span><span class="p">.</span><span class="n">find</span><span class="w"> </span><span class="n">label</span><span class="w"> </span><span class="n">louvainLabelToColor</span><span class="w"> </span>
<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="s">"#808080"</span><span class="o">))</span>
<span class="w">    </span><span class="o">)</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">Map</span><span class="p">.</span><span class="n">ofArray</span>

<span class="c1">// Table that showcases all communities, their member count and their connected color</span>
<span class="k">let</span><span class="w"> </span><span class="nv">colorTable</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="k">let</span><span class="w"> </span><span class="nv">header</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="s">"&lt;b&gt;Community&lt;/b&gt;"</span><span class="o">;</span><span class="s">"Number of members"</span><span class="o">;</span><span class="s">"Color"</span><span class="o">]</span>
<span class="w">    </span><span class="k">let</span><span class="w"> </span><span class="nv">rows</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
<span class="w">        </span><span class="nn">Vertices</span><span class="p">.</span><span class="n">getLabelList</span><span class="w"> </span><span class="n">louvainGraph</span>
<span class="w">        </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">Array</span><span class="p">.</span><span class="n">map</span><span class="w"> </span><span class="o">(</span><span class="n">snd</span><span class="o">)</span>
<span class="w">        </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">Array</span><span class="p">.</span><span class="n">countBy</span><span class="w"> </span><span class="o">(</span><span class="k">fun</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">x</span><span class="o">)</span>
<span class="w">        </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">Array</span><span class="p">.</span><span class="n">sortByDescending</span><span class="w"> </span><span class="o">(</span><span class="k">fun</span><span class="w"> </span><span class="o">(</span><span class="n">community</span><span class="o">,</span><span class="n">count</span><span class="o">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">count</span><span class="o">)</span>
<span class="w">        </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">Array</span><span class="p">.</span><span class="n">map</span><span class="o">(</span><span class="k">fun</span><span class="w"> </span><span class="o">(</span><span class="n">community</span><span class="o">,</span><span class="n">count</span><span class="o">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">[(</span><span class="n">sprintf</span><span class="w"> </span><span class="s">"%i"</span><span class="w"> </span><span class="n">community</span><span class="o">);(</span><span class="n">sprintf</span><span class="w"> </span><span class="s">"%i"</span><span class="w"> </span><span class="n">count</span><span class="o">);(</span><span class="k">if</span><span class="w"> </span><span class="o">(</span><span class="nn">Map</span><span class="p">.</span><span class="n">containsKey</span><span class="w"> </span><span class="n">community</span><span class="w"> </span><span class="n">colorMap</span><span class="o">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="o">(</span><span class="n">colorMap</span><span class="o">.</span><span class="n">Item</span><span class="w"> </span><span class="n">community</span><span class="o">)</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s">"#808080"</span><span class="o">)])</span>
<span class="w">    </span><span class="k">let</span><span class="w"> </span><span class="nv">cellColor</span><span class="w"> </span><span class="o">=</span>
<span class="w">        </span><span class="nn">Array</span><span class="p">.</span><span class="n">map</span><span class="o">(</span><span class="k">fun</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span>
<span class="w">            </span><span class="k">let</span><span class="w"> </span><span class="nv">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nn">Color</span><span class="p">.</span><span class="n">fromString</span><span class="w"> </span><span class="o">(</span><span class="nn">List</span><span class="p">.</span><span class="n">last</span><span class="w"> </span><span class="n">l</span><span class="o">)</span>
<span class="w">            </span><span class="o">[</span><span class="nn">Color</span><span class="p">.</span><span class="n">fromString</span><span class="w"> </span><span class="s">"transparent"</span><span class="o">;</span><span class="nn">Color</span><span class="p">.</span><span class="n">fromString</span><span class="w"> </span><span class="s">"transparent"</span><span class="o">;</span><span class="n">color</span><span class="o">])</span><span class="w"> </span><span class="n">rows</span>
<span class="w">        </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">Seq</span><span class="p">.</span><span class="n">transpose</span>
<span class="w">        </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">Seq</span><span class="p">.</span><span class="n">map</span><span class="w"> </span><span class="nn">Color</span><span class="p">.</span><span class="n">fromColors</span>
<span class="w">        </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">Color</span><span class="p">.</span><span class="n">fromColors</span>
<span class="w">    </span><span class="nn">Chart</span><span class="p">.</span><span class="n">Table</span><span class="o">(</span>
<span class="w">        </span><span class="n">header</span><span class="o">,</span>
<span class="w">        </span><span class="n">rows</span><span class="o">,</span>
<span class="w">        </span><span class="n">HeaderOutlineColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nn">Color</span><span class="p">.</span><span class="n">fromString</span><span class="w"> </span><span class="s">"black"</span><span class="o">,</span>
<span class="w">        </span><span class="n">CellsOutlineColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nn">Color</span><span class="p">.</span><span class="n">fromString</span><span class="w"> </span><span class="s">"black"</span><span class="o">,</span>
<span class="w">        </span><span class="n">CellsOutlineWidth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="o">.</span><span class="mi">1</span><span class="o">,</span><span class="w">        </span>
<span class="w">        </span><span class="n">CellsFillColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cellColor</span>
<span class="w">    </span><span class="o">)</span>

<span class="n">colorTable</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output " data-mime-type="text/html">
<div><div id="937579cb-228e-460c-906f-95ee0a1ae127"><!-- Plotly chart will be drawn inside this DIV --></div><script type="text/javascript">
var renderPlotly_937579cb228e460c906f95ee0a1ae127 = function() {
    var fsharpPlotlyRequire = requirejs.config({context:'fsharp-plotly',paths:{plotly:'https://cdn.plot.ly/plotly-2.18.1.min'}}) || require;
    fsharpPlotlyRequire(['plotly'], function(Plotly) {
        var data = [{"type":"table","cells":{"fill":{"color":[["transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent"],["transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent","transparent"],["#5E7F00","#9ACB0B","#C249A1","#D68A0C","#640048","#4B74AD","#FFC360","#CCF35C","#855300","#A00976","#FFC0CB","#052858","#CC0000","#13478D","#808080","#808080","#808080","#808080","#808080","#808080","#808080","#808080","#808080","#808080","#808080","#808080","#808080","#808080","#808080","#808080","#808080","#808080","#808080","#808080","#808080"]]},"line":{"color":"black","width":0.1},"values":[["19","7","8","2","13","10","9","12","15","0","30","16","21","6","11","4","1","27","18","24","31","26","32","29","28","17","23","22","20","33","14","5","3","25","34"],["42","38","18","17","17","16","15","12","10","9","6","6","6","6","4","4","4","4","3","3","2","2","2","2","2","2","2","2","2","2","2","2","2","1","1"],["#5E7F00","#9ACB0B","#C249A1","#D68A0C","#640048","#4B74AD","#FFC360","#CCF35C","#855300","#A00976","#FFC0CB","#052858","#CC0000","#13478D","#808080","#808080","#808080","#808080","#808080","#808080","#808080","#808080","#808080","#808080","#808080","#808080","#808080","#808080","#808080","#808080","#808080","#808080","#808080","#808080","#808080"]]},"header":{"fill":{},"line":{"color":"black"},"values":["<b>Community</b>","Number of members","Color"]}}];
        var layout = {"width":600,"height":600,"template":{"layout":{"title":{"x":0.05},"font":{"color":"rgba(42, 63, 95, 1.0)"},"paper_bgcolor":"rgba(255, 255, 255, 1.0)","plot_bgcolor":"rgba(229, 236, 246, 1.0)","autotypenumbers":"strict","colorscale":{"diverging":[[0.0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1.0,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"hovermode":"closest","hoverlabel":{"align":"left"},"coloraxis":{"colorbar":{"outlinewidth":0.0,"ticks":""}},"geo":{"showland":true,"landcolor":"rgba(229, 236, 246, 1.0)","showlakes":true,"lakecolor":"rgba(255, 255, 255, 1.0)","subunitcolor":"rgba(255, 255, 255, 1.0)","bgcolor":"rgba(255, 255, 255, 1.0)"},"mapbox":{"style":"light"},"polar":{"bgcolor":"rgba(229, 236, 246, 1.0)","radialaxis":{"linecolor":"rgba(255, 255, 255, 1.0)","gridcolor":"rgba(255, 255, 255, 1.0)","ticks":""},"angularaxis":{"linecolor":"rgba(255, 255, 255, 1.0)","gridcolor":"rgba(255, 255, 255, 1.0)","ticks":""}},"scene":{"xaxis":{"ticks":"","linecolor":"rgba(255, 255, 255, 1.0)","gridcolor":"rgba(255, 255, 255, 1.0)","gridwidth":2.0,"zerolinecolor":"rgba(255, 255, 255, 1.0)","backgroundcolor":"rgba(229, 236, 246, 1.0)","showbackground":true},"yaxis":{"ticks":"","linecolor":"rgba(255, 255, 255, 1.0)","gridcolor":"rgba(255, 255, 255, 1.0)","gridwidth":2.0,"zerolinecolor":"rgba(255, 255, 255, 1.0)","backgroundcolor":"rgba(229, 236, 246, 1.0)","showbackground":true},"zaxis":{"ticks":"","linecolor":"rgba(255, 255, 255, 1.0)","gridcolor":"rgba(255, 255, 255, 1.0)","gridwidth":2.0,"zerolinecolor":"rgba(255, 255, 255, 1.0)","backgroundcolor":"rgba(229, 236, 246, 1.0)","showbackground":true}},"ternary":{"aaxis":{"ticks":"","linecolor":"rgba(255, 255, 255, 1.0)","gridcolor":"rgba(255, 255, 255, 1.0)"},"baxis":{"ticks":"","linecolor":"rgba(255, 255, 255, 1.0)","gridcolor":"rgba(255, 255, 255, 1.0)"},"caxis":{"ticks":"","linecolor":"rgba(255, 255, 255, 1.0)","gridcolor":"rgba(255, 255, 255, 1.0)"},"bgcolor":"rgba(229, 236, 246, 1.0)"},"xaxis":{"title":{"standoff":15},"ticks":"","automargin":"height+width+left+right+top+bottom","linecolor":"rgba(255, 255, 255, 1.0)","gridcolor":"rgba(255, 255, 255, 1.0)","zerolinecolor":"rgba(255, 255, 255, 1.0)","zerolinewidth":2.0},"yaxis":{"title":{"standoff":15},"ticks":"","automargin":"height+width+left+right+top+bottom","linecolor":"rgba(255, 255, 255, 1.0)","gridcolor":"rgba(255, 255, 255, 1.0)","zerolinecolor":"rgba(255, 255, 255, 1.0)","zerolinewidth":2.0},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"shapedefaults":{"line":{"color":"rgba(42, 63, 95, 1.0)"}},"colorway":["rgba(99, 110, 250, 1.0)","rgba(239, 85, 59, 1.0)","rgba(0, 204, 150, 1.0)","rgba(171, 99, 250, 1.0)","rgba(255, 161, 90, 1.0)","rgba(25, 211, 243, 1.0)","rgba(255, 102, 146, 1.0)","rgba(182, 232, 128, 1.0)","rgba(255, 151, 255, 1.0)","rgba(254, 203, 82, 1.0)"]},"data":{"bar":[{"marker":{"line":{"color":"rgba(229, 236, 246, 1.0)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"error_x":{"color":"rgba(42, 63, 95, 1.0)"},"error_y":{"color":"rgba(42, 63, 95, 1.0)"}}],"barpolar":[{"marker":{"line":{"color":"rgba(229, 236, 246, 1.0)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}}}],"carpet":[{"aaxis":{"linecolor":"rgba(255, 255, 255, 1.0)","gridcolor":"rgba(255, 255, 255, 1.0)","endlinecolor":"rgba(42, 63, 95, 1.0)","minorgridcolor":"rgba(255, 255, 255, 1.0)","startlinecolor":"rgba(42, 63, 95, 1.0)"},"baxis":{"linecolor":"rgba(255, 255, 255, 1.0)","gridcolor":"rgba(255, 255, 255, 1.0)","endlinecolor":"rgba(42, 63, 95, 1.0)","minorgridcolor":"rgba(255, 255, 255, 1.0)","startlinecolor":"rgba(42, 63, 95, 1.0)"}}],"choropleth":[{"colorbar":{"outlinewidth":0.0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contour":[{"colorbar":{"outlinewidth":0.0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"colorbar":{"outlinewidth":0.0,"ticks":""}}],"heatmap":[{"colorbar":{"outlinewidth":0.0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"colorbar":{"outlinewidth":0.0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}}}],"histogram2d":[{"colorbar":{"outlinewidth":0.0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0.0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"colorbar":{"outlinewidth":0.0,"ticks":""}}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0.0,"ticks":""}}}],"pie":[{"automargin":true}],"scatter":[{"marker":{"colorbar":{"outlinewidth":0.0,"ticks":""}}}],"scatter3d":[{"marker":{"colorbar":{"outlinewidth":0.0,"ticks":""}},"line":{"colorbar":{"outlinewidth":0.0,"ticks":""}}}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0.0,"ticks":""}}}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0.0,"ticks":""}}}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0.0,"ticks":""}}}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0.0,"ticks":""}}}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0.0,"ticks":""}}}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0.0,"ticks":""}}}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0.0,"ticks":""}}}],"surface":[{"colorbar":{"outlinewidth":0.0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"table":[{"cells":{"fill":{"color":"rgba(235, 240, 248, 1.0)"},"line":{"color":"rgba(255, 255, 255, 1.0)"}},"header":{"fill":{"color":"rgba(200, 212, 227, 1.0)"},"line":{"color":"rgba(255, 255, 255, 1.0)"}}}]}}};
        var config = {"responsive":true};
        Plotly.newPlot('937579cb-228e-460c-906f-95ee0a1ae127', data, layout, config);
    });
};
if ((typeof(requirejs) !==  typeof(Function)) || (typeof(requirejs.config) !== typeof(Function))) {
    var script = document.createElement("script");
    script.setAttribute("src", "https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js");
    script.onload = function(){
        renderPlotly_937579cb228e460c906f95ee0a1ae127();
    };
    document.getElementsByTagName("head")[0].appendChild(script);
}
else {
    renderPlotly_937579cb228e460c906f95ee0a1ae127();
}
</script></div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[14]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-F#"><pre><span></span><span class="c1">// The styled vertices. The color of the vertices is based on their community. The size is based on the degree of this vertex, so that more heavily connected nodes are emphasized.</span>
<span class="k">let</span><span class="w"> </span><span class="nv">cytoVertices2</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="nn">Array</span><span class="p">.</span><span class="n">map2</span><span class="w"> </span><span class="o">(</span><span class="k">fun</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">(</span><span class="n">v</span><span class="o">,</span><span class="n">l</span><span class="o">))</span><span class="w"> </span><span class="o">(</span><span class="n">louvainGraph</span><span class="o">.</span><span class="n">GetVertices</span><span class="bp">()</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="nn">Vertices</span><span class="p">.</span><span class="n">getLabelList</span><span class="w"> </span><span class="n">louvainGraph</span><span class="o">)</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">List</span><span class="p">.</span><span class="n">ofArray</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">List</span><span class="p">.</span><span class="n">map</span><span class="o">(</span><span class="k">fun</span><span class="w"> </span><span class="o">(</span><span class="n">v</span><span class="o">,(</span><span class="n">l</span><span class="o">,</span><span class="n">c</span><span class="o">))</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">        </span><span class="k">let</span><span class="w"> </span><span class="nv">styling</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="nn">CyParam</span><span class="p">.</span><span class="n">label</span><span class="w"> </span><span class="n">l</span><span class="o">;</span><span class="k">if</span><span class="w"> </span><span class="o">(</span><span class="nn">Map</span><span class="p">.</span><span class="n">containsKey</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="n">colorMap</span><span class="o">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="nn">CyParam</span><span class="p">.</span><span class="n">color</span><span class="w"> </span><span class="o">(</span><span class="n">colorMap</span><span class="o">.</span><span class="n">Item</span><span class="w"> </span><span class="o">(</span><span class="n">c</span><span class="o">));</span><span class="nn">CyParam</span><span class="p">.</span><span class="n">weight</span><span class="w"> </span><span class="o">(</span><span class="n">sqrt</span><span class="w"> </span><span class="o">(</span><span class="kt">float</span><span class="w"> </span><span class="o">(</span><span class="nn">Vertices</span><span class="p">.</span><span class="n">degree</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="n">louvainGraph</span><span class="o">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="o">.</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="o">(*)</span><span class="w"> </span><span class="mi">10</span><span class="o">.)]</span>
<span class="w">        </span><span class="o">(</span><span class="nn">Elements</span><span class="p">.</span><span class="n">node</span><span class="w"> </span><span class="o">(</span><span class="kt">string</span><span class="w"> </span><span class="n">v</span><span class="o">)</span><span class="w"> </span><span class="n">styling</span><span class="o">)</span>

<span class="w">    </span><span class="o">)</span>

<span class="c1">// Creates an edge list based on the cytoEdges</span>
<span class="k">let</span><span class="w"> </span><span class="nv">cytoEdges</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
<span class="w">    </span><span class="n">edgeList</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">List</span><span class="p">.</span><span class="n">mapi</span><span class="w"> </span><span class="o">(</span><span class="k">fun</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">(</span><span class="n">v1</span><span class="o">,</span><span class="n">v2</span><span class="o">,</span><span class="n">weight</span><span class="o">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span>
<span class="w">        </span><span class="k">let</span><span class="w"> </span><span class="nv">styling</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="nn">CyParam</span><span class="p">.</span><span class="n">weight</span><span class="w"> </span><span class="o">(</span><span class="mi">0</span><span class="o">.</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">weight</span><span class="o">)]</span>
<span class="w">        </span><span class="nn">Elements</span><span class="p">.</span><span class="n">edge</span><span class="w"> </span><span class="o">(</span><span class="s">"e"</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">i</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="kt">string</span><span class="w"> </span><span class="n">v1</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="kt">string</span><span class="w"> </span><span class="n">v2</span><span class="o">)</span><span class="w"> </span><span class="n">styling</span>
<span class="w">    </span><span class="o">)</span>

<span class="c1">// Resulting cytograph</span>
<span class="k">let</span><span class="w"> </span><span class="nv">cytoGraph2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>

<span class="w">    </span><span class="nn">CyGraph</span><span class="p">.</span><span class="n">initEmpty</span><span class="w"> </span><span class="bp">()</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">CyGraph</span><span class="p">.</span><span class="n">withElements</span><span class="w"> </span><span class="n">cytoVertices2</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">CyGraph</span><span class="p">.</span><span class="n">withElements</span><span class="w"> </span><span class="n">cytoEdges</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">CyGraph</span><span class="p">.</span><span class="n">withStyle</span><span class="w"> </span><span class="s">"node"</span><span class="w"> </span>
<span class="w">        </span><span class="o">[</span>
<span class="w">            </span><span class="nn">CyParam</span><span class="p">.</span><span class="n">shape</span><span class="w"> </span><span class="s">"circle"</span>
<span class="w">            </span><span class="nn">CyParam</span><span class="p">.</span><span class="n">content</span><span class="w"> </span><span class="o">=.</span><span class="w"> </span><span class="nn">CyParam</span><span class="p">.</span><span class="n">label</span>
<span class="w">            </span><span class="nn">CyParam</span><span class="p">.</span><span class="n">width</span><span class="w"> </span><span class="o">=.</span><span class="w"> </span><span class="nn">CyParam</span><span class="p">.</span><span class="n">weight</span>
<span class="w">            </span><span class="nn">CyParam</span><span class="p">.</span><span class="n">height</span><span class="w"> </span><span class="o">=.</span><span class="w"> </span><span class="nn">CyParam</span><span class="p">.</span><span class="n">weight</span>
<span class="w">            </span><span class="nn">CyParam</span><span class="p">.</span><span class="nn">Text</span><span class="p">.</span><span class="nn">Align</span><span class="p">.</span><span class="n">center</span>
<span class="w">            </span><span class="nn">CyParam</span><span class="p">.</span><span class="nn">Border</span><span class="p">.</span><span class="n">color</span><span class="w"> </span><span class="o">=.</span><span class="w"> </span><span class="nn">CyParam</span><span class="p">.</span><span class="n">color</span>
<span class="w">            </span><span class="nn">CyParam</span><span class="p">.</span><span class="nn">Background</span><span class="p">.</span><span class="n">color</span><span class="w"> </span><span class="o">=.</span><span class="w"> </span><span class="nn">CyParam</span><span class="p">.</span><span class="n">color</span>
<span class="w">        </span><span class="o">]</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">CyGraph</span><span class="p">.</span><span class="n">withStyle</span><span class="w"> </span><span class="s">"edge"</span><span class="w"> </span>
<span class="w">        </span><span class="o">[</span>
<span class="w">            </span><span class="nn">CyParam</span><span class="p">.</span><span class="nn">Line</span><span class="p">.</span><span class="n">color</span><span class="w"> </span><span class="s">"#3D1244"</span>
<span class="w">        </span><span class="o">]</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">CyGraph</span><span class="p">.</span><span class="n">withLayout</span><span class="w"> </span><span class="o">(</span><span class="nn">Layout</span><span class="p">.</span><span class="n">initCose</span><span class="w"> </span><span class="o">(</span><span class="nn">Layout</span><span class="p">.</span><span class="nn">LayoutOptions</span><span class="p">.</span><span class="n">Cose</span><span class="o">(</span><span class="n">NodeOverlap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">400</span><span class="o">,</span><span class="n">ComponentSpacing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span><span class="o">)))</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p><img src="https://csbiology.github.io/CSBlog/img/cytoGraphOntology.png" alt="Cytograph_Ontology"></p>
<h2 id="PCA---Principal-component-analysis">PCA - Principal component analysis<a class="anchor-link" href="#PCA---Principal-component-analysis">&#182;</a></h2><p>An entirely different approach to the graph analysis is given by the principal component analysis (PCA) . 
It is most commonly used for dimensional reduction and to build predictive models.
In our case we reduce the dimensions of experiments from the data we used to create the first graph.
More accurately, the PCA reduces the dataset by highlighting its biggest variances.
The PCA algorithm can be found in <a href="https://fslab.org/FSharp.Stats/">FSharp.Stats</a>.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[15]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-F#"><pre><span></span><span class="k">let</span><span class="w"> </span><span class="nv">pcaData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
<span class="w">    </span><span class="n">rows</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">Matrix</span><span class="p">.</span><span class="n">transpose</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="k">fun</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">        </span><span class="k">let</span><span class="w"> </span><span class="nv">pcaComponents</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nn">ML</span><span class="p">.</span><span class="nn">Unsupervised</span><span class="p">.</span><span class="nn">PCA</span><span class="p">.</span><span class="n">compute</span><span class="w"> </span><span class="o">(</span><span class="nn">ML</span><span class="p">.</span><span class="nn">Unsupervised</span><span class="p">.</span><span class="nn">PCA</span><span class="p">.</span><span class="n">toAdjustCenter</span><span class="w"> </span><span class="n">x</span><span class="o">)</span><span class="w"> </span><span class="n">x</span>

<span class="w">        </span><span class="k">let</span><span class="w"> </span><span class="nv">pComponent1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pcaComponents</span><span class="o">.[</span><span class="mi">0</span><span class="o">]</span>
<span class="w">        </span><span class="k">let</span><span class="w"> </span><span class="nv">pComponent2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pcaComponents</span><span class="o">.[</span><span class="mi">1</span><span class="o">]</span>
<span class="w">        </span><span class="k">let</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pComponent1</span><span class="o">.</span><span class="n">EigenVector</span><span class="w"> </span>
<span class="w">        </span><span class="k">let</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pComponent2</span><span class="o">.</span><span class="n">EigenVector</span><span class="w"> </span>
<span class="w">        </span>
<span class="w">        </span><span class="k">let</span><span class="w"> </span><span class="nv">pcaCoordinates</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nn">Array</span><span class="p">.</span><span class="n">map2</span><span class="w"> </span><span class="o">(</span><span class="k">fun</span><span class="w"> </span><span class="n">c1</span><span class="w"> </span><span class="n">c2</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">(</span><span class="n">c1</span><span class="o">,</span><span class="n">c2</span><span class="o">))</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">y</span>
<span class="w">        </span>
<span class="w">        </span><span class="n">pcaCoordinates</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>Using the calculated data, we color each gene based on its coloring in the Louvain-Graph to showcase the differences between the community detection and the PCA.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[16]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-F#"><pre><span></span><span class="c1">// Creation of a pointchart based on the PCA data</span>
<span class="k">let</span><span class="w"> </span><span class="nv">pcaChart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
<span class="w">    </span><span class="k">let</span><span class="w"> </span><span class="nv">labelArray</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rawFrame</span><span class="o">.</span><span class="n">RowKeys</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">Array</span><span class="p">.</span><span class="n">ofSeq</span>

<span class="w">    </span><span class="n">pcaData</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">Array</span><span class="p">.</span><span class="n">mapi</span><span class="o">(</span><span class="k">fun</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span>
<span class="w">        </span><span class="o">(</span><span class="n">labelArray</span><span class="o">.[</span><span class="n">i</span><span class="o">]),</span><span class="nn">Chart</span><span class="p">.</span><span class="n">Point</span><span class="o">(</span>
<span class="w">            </span><span class="o">[</span><span class="n">x</span><span class="o">],</span>
<span class="w">            </span><span class="n">Text</span><span class="o">=</span><span class="n">labelArray</span><span class="o">.[</span><span class="n">i</span><span class="o">],</span>
<span class="w">            </span><span class="n">MarkerColor</span><span class="o">=(</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="o">(</span><span class="nn">Map</span><span class="p">.</span><span class="n">containsKey</span><span class="w"> </span><span class="o">(</span><span class="n">labelArray</span><span class="o">.[</span><span class="n">i</span><span class="o">])</span><span class="w"> </span><span class="n">geneNameToColor</span><span class="o">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                    </span><span class="nn">Color</span><span class="p">.</span><span class="n">fromHex</span><span class="o">(</span><span class="nn">Map</span><span class="p">.</span><span class="n">find</span><span class="o">(</span><span class="n">labelArray</span><span class="o">.[</span><span class="n">i</span><span class="o">])</span><span class="w"> </span><span class="n">geneNameToColor</span><span class="o">)</span>
<span class="w">                </span><span class="k">else</span>
<span class="w">                    </span><span class="nn">Color</span><span class="p">.</span><span class="n">fromString</span><span class="w"> </span><span class="s">"gray"</span>
<span class="w">                    </span><span class="o">))|&gt;</span><span class="w"> </span><span class="nn">Chart</span><span class="p">.</span><span class="n">withTraceInfo</span><span class="o">(</span><span class="n">Name</span><span class="o">=</span><span class="n">labelArray</span><span class="o">.[</span><span class="n">i</span><span class="o">]))</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">Array</span><span class="p">.</span><span class="n">choose</span><span class="o">(</span><span class="k">fun</span><span class="w"> </span><span class="o">(</span><span class="n">l</span><span class="o">,</span><span class="n">chart</span><span class="o">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nn">List</span><span class="p">.</span><span class="n">contains</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">(</span><span class="n">vertexList</span><span class="o">|&gt;</span><span class="nn">List</span><span class="p">.</span><span class="n">map</span><span class="w"> </span><span class="n">snd</span><span class="o">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">Some</span><span class="w"> </span><span class="n">chart</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">None</span><span class="o">)</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">Chart</span><span class="p">.</span><span class="n">combine</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">Chart</span><span class="p">.</span><span class="n">withYAxisStyle</span><span class="o">(</span><span class="n">TitleText</span><span class="o">=</span><span class="s">"PC2"</span><span class="o">)</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">Chart</span><span class="p">.</span><span class="n">withXAxisStyle</span><span class="o">(</span><span class="n">TitleText</span><span class="o">=</span><span class="s">"PC1"</span><span class="o">)</span>

<span class="n">pcaChart</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output " data-mime-type="text/html">
<div><div id="60be05b4-f3ad-4734-9dbb-f15eecdd3f88"><!-- Plotly chart will be drawn inside this DIV --></div><script type="text/javascript">
var renderPlotly_60be05b4f3ad47349dbbf15eecdd3f88 = function() {
    var fsharpPlotlyRequire = requirejs.config({context:'fsharp-plotly',paths:{plotly:'https://cdn.plot.ly/plotly-2.18.1.min'}}) || require;
    fsharpPlotlyRequire(['plotly'], function(Plotly) {
        var data = [{"type":"scatter","mode":"markers","x":[-0.020695203397594116],"y":[-0.04172173406888602],"text":"aaeR","marker":{"color":"rgba(160, 9, 118, 1.0)"},"line":{},"name":"aaeR"},{"type":"scatter","mode":"markers","x":[-0.02779308643962391],"y":[-0.029056157683343395],"text":"aat","marker":{"color":"rgba(128, 128, 128, 1.0)"},"line":{},"name":"aat"},{"type":"scatter","mode":"markers","x":[-0.010178145979593059],"y":[0.05123917305555196],"text":"abgA","marker":{"color":"rgba(214, 138, 12, 1.0)"},"line":{},"name":"abgA"},{"type":"scatter","mode":"markers","x":[-0.02287404615044208],"y":[0.057525736131554116],"text":"abgB","marker":{"color":"rgba(214, 138, 12, 1.0)"},"line":{},"name":"abgB"},{"type":"scatter","mode":"markers","x":[-0.03235931356810276],"y":[0.05672020900372042],"text":"abgR","marker":{"color":"rgba(214, 138, 12, 1.0)"},"line":{},"name":"abgR"},{"type":"scatter","mode":"markers","x":[-0.022460411472082623],"y":[0.06955321908333324],"text":"abgT","marker":{"color":"rgba(214, 138, 12, 1.0)"},"line":{},"name":"abgT"},{"type":"scatter","mode":"markers","x":[-0.11958533891990407],"y":[0.1600722996719751],"text":"aceA","marker":{"color":"rgba(128, 128, 128, 1.0)"},"line":{},"name":"aceA"},{"type":"scatter","mode":"markers","x":[-0.10808305318448763],"y":[0.09387763013738191],"text":"aceB","marker":{"color":"rgba(128, 128, 128, 1.0)"},"line":{},"name":"aceB"},{"type":"scatter","mode":"markers","x":[-0.04832979695782984],"y":[-0.06906245831571543],"text":"aceE","marker":{"color":"rgba(128, 128, 128, 1.0)"},"line":{},"name":"aceE"},{"type":"scatter","mode":"markers","x":[-0.05377761696545636],"y":[-0.059158681882233284],"text":"aceF","marker":{"color":"rgba(128, 128, 128, 1.0)"},"line":{},"name":"aceF"},{"type":"scatter","mode":"markers","x":[-0.014375449662448275],"y":[0.116367770604701],"text":"acnB","marker":{"color":"rgba(19, 71, 141, 1.0)"},"line":{},"name":"acnB"},{"type":"scatter","mode":"markers","x":[-0.0177735434986261],"y":[0.03760988435164234],"text":"acpH","marker":{"color":"rgba(214, 138, 12, 1.0)"},"line":{},"name":"acpH"},{"type":"scatter","mode":"markers","x":[-0.026951557679309655],"y":[-0.019163830446736474],"text":"acpS","marker":{"color":"rgba(154, 203, 11, 1.0)"},"line":{},"name":"acpS"},{"type":"scatter","mode":"markers","x":[-0.050644384611142144],"y":[-0.01612675331838361],"text":"acrA","marker":{"color":"rgba(154, 203, 11, 1.0)"},"line":{},"name":"acrA"},{"type":"scatter","mode":"markers","x":[-0.05310785871165953],"y":[0.002351236111802976],"text":"acrB","marker":{"color":"rgba(154, 203, 11, 1.0)"},"line":{},"name":"acrB"},{"type":"scatter","mode":"markers","x":[0.01573483886095282],"y":[-0.018248200987201913],"text":"acrF","marker":{"color":"rgba(194, 73, 161, 1.0)"},"line":{},"name":"acrF"},{"type":"scatter","mode":"markers","x":[-0.0006678639380220962],"y":[0.20169866417079244],"text":"acs","marker":{"color":"rgba(255, 195, 96, 1.0)"},"line":{},"name":"acs"},{"type":"scatter","mode":"markers","x":[0.009257335821025246],"y":[0.1618361871118685],"text":"actP","marker":{"color":"rgba(255, 195, 96, 1.0)"},"line":{},"name":"actP"},{"type":"scatter","mode":"markers","x":[-0.013657001248576444],"y":[0.03128158134364916],"text":"ada","marker":{"color":"rgba(214, 138, 12, 1.0)"},"line":{},"name":"ada"},{"type":"scatter","mode":"markers","x":[0.06182939135299106],"y":[0.0023112947145529036],"text":"add","marker":{"color":"rgba(75, 116, 173, 1.0)"},"line":{},"name":"add"},{"type":"scatter","mode":"markers","x":[-0.047823593567149845],"y":[0.032264450078757],"text":"adhP","marker":{"color":"rgba(128, 128, 128, 1.0)"},"line":{},"name":"adhP"},{"type":"scatter","mode":"markers","x":[0.018864856342205395],"y":[-0.030841346753968973],"text":"adiA","marker":{"color":"rgba(194, 73, 161, 1.0)"},"line":{},"name":"adiA"},{"type":"scatter","mode":"markers","x":[-0.045223824824119935],"y":[-0.013656706610078721],"text":"adk","marker":{"color":"rgba(128, 128, 128, 1.0)"},"line":{},"name":"adk"},{"type":"scatter","mode":"markers","x":[0.002988583798010713],"y":[0.07768753970979932],"text":"aer","marker":{"color":"rgba(204, 243, 92, 1.0)"},"line":{},"name":"aer"},{"type":"scatter","mode":"markers","x":[0.02182429112435427],"y":[0.02783354110409977],"text":"aes","marker":{"color":"rgba(100, 0, 72, 1.0)"},"line":{},"name":"aes"},{"type":"scatter","mode":"markers","x":[-0.017692349171205345],"y":[0.036721460428867723],"text":"afuB","marker":{"color":"rgba(214, 138, 12, 1.0)"},"line":{},"name":"afuB"},{"type":"scatter","mode":"markers","x":[-0.001140454073465814],"y":[0.024299921987420633],"text":"afuC","marker":{"color":"rgba(214, 138, 12, 1.0)"},"line":{},"name":"afuC"},{"type":"scatter","mode":"markers","x":[0.009621956717462549],"y":[0.012299067679677233],"text":"agaA","marker":{"color":"rgba(128, 128, 128, 1.0)"},"line":{},"name":"agaA"},{"type":"scatter","mode":"markers","x":[0.020493846007261472],"y":[0.024156182989217276],"text":"agaC","marker":{"color":"rgba(100, 0, 72, 1.0)"},"line":{},"name":"agaC"},{"type":"scatter","mode":"markers","x":[0.02023452099812949],"y":[0.01551151953186829],"text":"agaD","marker":{"color":"rgba(100, 0, 72, 1.0)"},"line":{},"name":"agaD"},{"type":"scatter","mode":"markers","x":[0.02648416593393835],"y":[0.00640347877637111],"text":"agaI","marker":{"color":"rgba(100, 0, 72, 1.0)"},"line":{},"name":"agaI"},{"type":"scatter","mode":"markers","x":[-0.02532301517048854],"y":[-0.039103367559623695],"text":"agaR","marker":{"color":"rgba(160, 9, 118, 1.0)"},"line":{},"name":"agaR"},{"type":"scatter","mode":"markers","x":[0.016365538039210883],"y":[0.009749964039736492],"text":"agaW","marker":{"color":"rgba(128, 128, 128, 1.0)"},"line":{},"name":"agaW"},{"type":"scatter","mode":"markers","x":[-0.03911225530162257],"y":[-0.0369588317413036],"text":"aidB","marker":{"color":"rgba(133, 83, 0, 1.0)"},"line":{},"name":"aidB"},{"type":"scatter","mode":"markers","x":[0.00263680870515679],"y":[0.06397122666381255],"text":"ais","marker":{"color":"rgba(204, 243, 92, 1.0)"},"line":{},"name":"ais"},{"type":"scatter","mode":"markers","x":[-0.05303799971582116],"y":[-0.011305708223579137],"text":"alaS","marker":{"color":"rgba(154, 203, 11, 1.0)"},"line":{},"name":"alaS"},{"type":"scatter","mode":"markers","x":[-0.018138802175490788],"y":[0.19547447769829804],"text":"aldA","marker":{"color":"rgba(255, 195, 96, 1.0)"},"line":{},"name":"aldA"},{"type":"scatter","mode":"markers","x":[-0.044349308102765495],"y":[0.0017389030712304015],"text":"allR","marker":{"color":"rgba(154, 203, 11, 1.0)"},"line":{},"name":"allR"},{"type":"scatter","mode":"markers","x":[0.021553007228846146],"y":[0.009633083633397798],"text":"alsA","marker":{"color":"rgba(100, 0, 72, 1.0)"},"line":{},"name":"alsA"},{"type":"scatter","mode":"markers","x":[0.024891572529009927],"y":[0.00230574752635504],"text":"alsB","marker":{"color":"rgba(100, 0, 72, 1.0)"},"line":{},"name":"alsB"},{"type":"scatter","mode":"markers","x":[0.01834283867194268],"y":[0.007218463131878214],"text":"alsC","marker":{"color":"rgba(100, 0, 72, 1.0)"},"line":{},"name":"alsC"},{"type":"scatter","mode":"markers","x":[0.015777384673519544],"y":[-0.032426193773490646],"text":"amiB","marker":{"color":"rgba(5, 40, 88, 1.0)"},"line":{},"name":"amiB"},{"type":"scatter","mode":"markers","x":[-0.04235828282668456],"y":[0.024333835028545817],"text":"amn","marker":{"color":"rgba(154, 203, 11, 1.0)"},"line":{},"name":"amn"},{"type":"scatter","mode":"markers","x":[0.0064124447476204185],"y":[0.038409674620967324],"text":"ampG","marker":{"color":"rgba(214, 138, 12, 1.0)"},"line":{},"name":"ampG"},{"type":"scatter","mode":"markers","x":[-0.0483639537327419],"y":[0.02177399164570443],"text":"amyA","marker":{"color":"rgba(128, 128, 128, 1.0)"},"line":{},"name":"amyA"},{"type":"scatter","mode":"markers","x":[-0.00447269799807118],"y":[0.03456268706819833],"text":"anmK","marker":{"color":"rgba(128, 128, 128, 1.0)"},"line":{},"name":"anmK"},{"type":"scatter","mode":"markers","x":[-0.03723921781243184],"y":[-0.010450782202770941],"text":"ansA","marker":{"color":"rgba(128, 128, 128, 1.0)"},"line":{},"name":"ansA"},{"type":"scatter","mode":"markers","x":[-0.04322852820851078],"y":[0.0055408417819301815],"text":"apaH","marker":{"color":"rgba(154, 203, 11, 1.0)"},"line":{},"name":"apaH"},{"type":"scatter","mode":"markers","x":[-0.029940600116699436],"y":[-0.011865390094292683],"text":"appA","marker":{"color":"rgba(128, 128, 128, 1.0)"},"line":{},"name":"appA"},{"type":"scatter","mode":"markers","x":[-0.03889212450735288],"y":[-0.014031359929955061],"text":"appB","marker":{"color":"rgba(128, 128, 128, 1.0)"},"line":{},"name":"appB"},{"type":"scatter","mode":"markers","x":[-0.037409562247034844],"y":[-0.04125181070642122],"text":"appC","marker":{"color":"rgba(128, 128, 128, 1.0)"},"line":{},"name":"appC"},{"type":"scatter","mode":"markers","x":[0.08046101799021489],"y":[-0.09544405873453068],"text":"araA","marker":{"color":"rgba(194, 73, 161, 1.0)"},"line":{},"name":"araA"},{"type":"scatter","mode":"markers","x":[0.08222307625160243],"y":[-0.08907456673944696],"text":"araB","marker":{"color":"rgba(194, 73, 161, 1.0)"},"line":{},"name":"araB"},{"type":"scatter","mode":"markers","x":[0.05941650619314617],"y":[-0.06620553086543145],"text":"araD","marker":{"color":"rgba(194, 73, 161, 1.0)"},"line":{},"name":"araD"},{"type":"scatter","mode":"markers","x":[0.06113252187253905],"y":[-0.08744443590009081],"text":"araE","marker":{"color":"rgba(194, 73, 161, 1.0)"},"line":{},"name":"araE"},{"type":"scatter","mode":"markers","x":[0.05148615090997763],"y":[0.01417129796342636],"text":"araF","marker":{"color":"rgba(194, 73, 161, 1.0)"},"line":{},"name":"araF"},{"type":"scatter","mode":"markers","x":[0.037246673058469404],"y":[-0.031130616171216412],"text":"araG","marker":{"color":"rgba(194, 73, 161, 1.0)"},"line":{},"name":"araG"},{"type":"scatter","mode":"markers","x":[0.031136190200645137],"y":[-0.03678831987755891],"text":"araH","marker":{"color":"rgba(194, 73, 161, 1.0)"},"line":{},"name":"araH"},{"type":"scatter","mode":"markers","x":[-0.136448411540219],"y":[-0.029321694372364836],"text":"argA","marker":{"color":"rgba(94, 127, 0, 1.0)"},"line":{},"name":"argA"},{"type":"scatter","mode":"markers","x":[-0.11317736261246342],"y":[-0.04668193185578588],"text":"argB","marker":{"color":"rgba(94, 127, 0, 1.0)"},"line":{},"name":"argB"},{"type":"scatter","mode":"markers","x":[-0.138727416343189],"y":[-0.06012892050347062],"text":"argC","marker":{"color":"rgba(94, 127, 0, 1.0)"},"line":{},"name":"argC"},{"type":"scatter","mode":"markers","x":[-0.11281304193209013],"y":[-0.030333921420004153],"text":"argD","marker":{"color":"rgba(94, 127, 0, 1.0)"},"line":{},"name":"argD"},{"type":"scatter","mode":"markers","x":[-0.051992695124981766],"y":[-0.03264131684307208],"text":"argE","marker":{"color":"rgba(94, 127, 0, 1.0)"},"line":{},"name":"argE"},{"type":"scatter","mode":"markers","x":[-0.09314239075526816],"y":[-0.004530319634920042],"text":"argF","marker":{"color":"rgba(94, 127, 0, 1.0)"},"line":{},"name":"argF"},{"type":"scatter","mode":"markers","x":[-0.1322954810852879],"y":[0.0024254843609222763],"text":"argG","marker":{"color":"rgba(94, 127, 0, 1.0)"},"line":{},"name":"argG"},{"type":"scatter","mode":"markers","x":[-0.06768730561342817],"y":[-0.033443063469565236],"text":"argH","marker":{"color":"rgba(94, 127, 0, 1.0)"},"line":{},"name":"argH"},{"type":"scatter","mode":"markers","x":[-0.10465828473395794],"y":[-0.004654693504881463],"text":"argI","marker":{"color":"rgba(94, 127, 0, 1.0)"},"line":{},"name":"argI"},{"type":"scatter","mode":"markers","x":[0.019622562558192936],"y":[0.007235688850865262],"text":"argK","marker":{"color":"rgba(100, 0, 72, 1.0)"},"line":{},"name":"argK"},{"type":"scatter","mode":"markers","x":[-0.02919706719851134],"y":[-0.016937064971272963],"text":"argP","marker":{"color":"rgba(154, 203, 11, 1.0)"},"line":{},"name":"argP"},{"type":"scatter","mode":"markers","x":[0.013685219693332109],"y":[-0.017099136868227074],"text":"argS","marker":{"color":"rgba(75, 116, 173, 1.0)"},"line":{},"name":"argS"},{"type":"scatter","mode":"markers","x":[-0.05980463277307936],"y":[0.16232346270570835],"text":"argT","marker":{"color":"rgba(128, 128, 128, 1.0)"},"line":{},"name":"argT"},{"type":"scatter","mode":"markers","x":[0.03119067662492014],"y":[0.10098469525964317],"text":"argU","marker":{"color":"rgba(128, 128, 128, 1.0)"},"line":{},"name":"argU"},{"type":"scatter","mode":"markers","x":[0.03681510151708313],"y":[0.12426417781336396],"text":"argW","marker":{"color":"rgba(128, 128, 128, 1.0)"},"line":{},"name":"argW"},{"type":"scatter","mode":"markers","x":[-0.031316252350151216],"y":[0.06890735451264629],"text":"arnA","marker":{"color":"rgba(204, 243, 92, 1.0)"},"line":{},"name":"arnA"},{"type":"scatter","mode":"markers","x":[-0.03237156191707255],"y":[0.10121386943606017],"text":"arnB","marker":{"color":"rgba(204, 243, 92, 1.0)"},"line":{},"name":"arnB"},{"type":"scatter","mode":"markers","x":[-0.03753193611285749],"y":[0.08631546838037957],"text":"arnC","marker":{"color":"rgba(204, 243, 92, 1.0)"},"line":{},"name":"arnC"},{"type":"scatter","mode":"markers","x":[-0.004586714354237215],"y":[0.03628636811747285],"text":"arnD","marker":{"color":"rgba(204, 243, 92, 1.0)"},"line":{},"name":"arnD"},{"type":"scatter","mode":"markers","x":[-0.12146830492922665],"y":[-0.01559160358758808],"text":"aroA","marker":{"color":"rgba(94, 127, 0, 1.0)"},"line":{},"name":"aroA"},{"type":"scatter","mode":"markers","x":[-0.011404091346788704],"y":[-0.01569628438005833],"text":"aroB","marker":{"color":"rgba(75, 116, 173, 1.0)"},"line":{},"name":"aroB"},{"type":"scatter","mode":"markers","x":[-0.019692067203275227],"y":[-0.02457112687176183],"text":"aroC","marker":{"color":"rgba(75, 116, 173, 1.0)"},"line":{},"name":"aroC"},{"type":"scatter","mode":"markers","x":[-0.07177667773264615],"y":[0.001845212696093936],"text":"aroD","marker":{"color":"rgba(154, 203, 11, 1.0)"},"line":{},"name":"aroD"},{"type":"scatter","mode":"markers","x":[-0.046207027054674374],"y":[-0.031801141959914486],"text":"aroE","marker":{"color":"rgba(160, 9, 118, 1.0)"},"line":{},"name":"aroE"},{"type":"scatter","mode":"markers","x":[-0.10235031205420107],"y":[-0.03952247079986286],"text":"aroF","marker":{"color":"rgba(94, 127, 0, 1.0)"},"line":{},"name":"aroF"},{"type":"scatter","mode":"markers","x":[-0.12240762448345076],"y":[-0.027662717404584144],"text":"aroG","marker":{"color":"rgba(94, 127, 0, 1.0)"},"line":{},"name":"aroG"},{"type":"scatter","mode":"markers","x":[-0.07414217464493461],"y":[-0.01577718144164805],"text":"aroH","marker":{"color":"rgba(94, 127, 0, 1.0)"},"line":{},"name":"aroH"},{"type":"scatter","mode":"markers","x":[0.0005509640236772854],"y":[-0.04411917744958626],"text":"aroK","marker":{"color":"rgba(75, 116, 173, 1.0)"},"line":{},"name":"aroK"},{"type":"scatter","mode":"markers","x":[-0.06834963354233574],"y":[-0.03247798224501943],"text":"aroL","marker":{"color":"rgba(94, 127, 0, 1.0)"},"line":{},"name":"aroL"},{"type":"scatter","mode":"markers","x":[-0.14121707208054868],"y":[-0.02101438275927734],"text":"aroP","marker":{"color":"rgba(94, 127, 0, 1.0)"},"line":{},"name":"aroP"},{"type":"scatter","mode":"markers","x":[0.024345329324772697],"y":[0.01865887543495835],"text":"arsR","marker":{"color":"rgba(100, 0, 72, 1.0)"},"line":{},"name":"arsR"},{"type":"scatter","mode":"markers","x":[-0.05969404046256809],"y":[0.000899652397929009],"text":"artI","marker":{"color":"rgba(154, 203, 11, 1.0)"},"line":{},"name":"artI"},{"type":"scatter","mode":"markers","x":[-0.14596300648637148],"y":[0.009912416935198669],"text":"artJ","marker":{"color":"rgba(94, 127, 0, 1.0)"},"line":{},"name":"artJ"},{"type":"scatter","mode":"markers","x":[-0.02607731807601233],"y":[0.005670315002813687],"text":"artM","marker":{"color":"rgba(154, 203, 11, 1.0)"},"line":{},"name":"artM"},{"type":"scatter","mode":"markers","x":[-0.04213971937739761],"y":[-0.011847690283518718],"text":"artP","marker":{"color":"rgba(154, 203, 11, 1.0)"},"line":{},"name":"artP"},{"type":"scatter","mode":"markers","x":[-0.05323350431787891],"y":[-0.001571753175581764],"text":"artQ","marker":{"color":"rgba(154, 203, 11, 1.0)"},"line":{},"name":"artQ"},{"type":"scatter","mode":"markers","x":[-0.10637649386048371],"y":[-0.022124089240323646],"text":"asd","marker":{"color":"rgba(154, 203, 11, 1.0)"},"line":{},"name":"asd"},{"type":"scatter","mode":"markers","x":[0.01806071367034955],"y":[-0.015826733833363523],"text":"aslA","marker":{"color":"rgba(194, 73, 161, 1.0)"},"line":{},"name":"aslA"},{"type":"scatter","mode":"markers","x":[0.015401746666815224],"y":[0.0032022745432574657],"text":"aslB","marker":{"color":"rgba(100, 0, 72, 1.0)"},"line":{},"name":"aslB"},{"type":"scatter","mode":"markers","x":[0.024691853333174366],"y":[-0.03596425165826897],"text":"asnC","marker":{"color":"rgba(5, 40, 88, 1.0)"},"line":{},"name":"asnC"},{"type":"scatter","mode":"markers","x":[-0.0366675995078265],"y":[0.008469591724980362],"text":"asnS","marker":{"color":"rgba(154, 203, 11, 1.0)"},"line":{},"name":"asnS"},{"type":"scatter","mode":"markers","x":[-0.10420506261739779],"y":[0.01823886124157428],"text":"aspC","marker":{"color":"rgba(154, 203, 11, 1.0)"},"line":{},"name":"aspC"},{"type":"scatter","mode":"markers","x":[0.02895609410104507],"y":[-0.015875121201575856],"text":"aspS","marker":{"color":"rgba(75, 116, 173, 1.0)"},"line":{},"name":"aspS"},{"type":"scatter","mode":"markers","x":[0.0009124314419120497],"y":[0.07871599028173872],"text":"astA","marker":{"color":"rgba(255, 195, 96, 1.0)"},"line":{},"name":"astA"},{"type":"scatter","mode":"markers","x":[-0.003367502043819914],"y":[0.05945278421753514],"text":"astB","marker":{"color":"rgba(255, 195, 96, 1.0)"},"line":{},"name":"astB"},{"type":"scatter","mode":"markers","x":[-0.0008841301469294365],"y":[0.09348225949548317],"text":"astC","marker":{"color":"rgba(255, 195, 96, 1.0)"},"line":{},"name":"astC"},{"type":"scatter","mode":"markers","x":[-0.006484279729765295],"y":[0.05875221457770991],"text":"astD","marker":{"color":"rgba(255, 195, 96, 1.0)"},"line":{},"name":"astD"},{"type":"scatter","mode":"markers","x":[-0.002450237282286162],"y":[0.06473651005565005],"text":"astE","marker":{"color":"rgba(255, 195, 96, 1.0)"},"line":{},"name":"astE"},{"type":"scatter","mode":"markers","x":[-0.04661239069562365],"y":[-0.012851683880554701],"text":"atpA","marker":{"color":"rgba(204, 0, 0, 1.0)"},"line":{},"name":"atpA"},{"type":"scatter","mode":"markers","x":[-0.006425555409612805],"y":[-0.005611115497074933],"text":"atpB","marker":{"color":"rgba(204, 0, 0, 1.0)"},"line":{},"name":"atpB"},{"type":"scatter","mode":"markers","x":[-0.024791488129184986],"y":[0.025413722381749163],"text":"atpC","marker":{"color":"rgba(154, 203, 11, 1.0)"},"line":{},"name":"atpC"},{"type":"scatter","mode":"markers","x":[-0.05655737049645178],"y":[-0.004986953246610374],"text":"atpD","marker":{"color":"rgba(154, 203, 11, 1.0)"},"line":{},"name":"atpD"},{"type":"scatter","mode":"markers","x":[-0.011091208605833125],"y":[-0.021315563875621682],"text":"atpE","marker":{"color":"rgba(204, 0, 0, 1.0)"},"line":{},"name":"atpE"},{"type":"scatter","mode":"markers","x":[-0.028310883508773015],"y":[-0.02107571643667363],"text":"atpF","marker":{"color":"rgba(204, 0, 0, 1.0)"},"line":{},"name":"atpF"},{"type":"scatter","mode":"markers","x":[-0.058187200273843165],"y":[-0.019329502259579287],"text":"atpG","marker":{"color":"rgba(154, 203, 11, 1.0)"},"line":{},"name":"atpG"},{"type":"scatter","mode":"markers","x":[-0.030261851297732997],"y":[-0.00880216504171952],"text":"atpH","marker":{"color":"rgba(204, 0, 0, 1.0)"},"line":{},"name":"atpH"},{"type":"scatter","mode":"markers","x":[0.004011203897202732],"y":[-0.001694545973455671],"text":"atpI","marker":{"color":"rgba(204, 0, 0, 1.0)"},"line":{},"name":"atpI"},{"type":"scatter","mode":"markers","x":[-0.05468825438864246],"y":[0.00317140663523484],"text":"avtA","marker":{"color":"rgba(94, 127, 0, 1.0)"},"line":{},"name":"avtA"},{"type":"scatter","mode":"markers","x":[-0.028737017871731062],"y":[-1.2518946387553839E-05],"text":"azoR","marker":{"color":"rgba(128, 128, 128, 1.0)"},"line":{},"name":"azoR"},{"type":"scatter","mode":"markers","x":[-0.06777576759562777],"y":[-0.0023269789206994754],"text":"bamA","marker":{"color":"rgba(154, 203, 11, 1.0)"},"line":{},"name":"bamA"},{"type":"scatter","mode":"markers","x":[-0.026180677273483454],"y":[0.0015130949602983888],"text":"bamB","marker":{"color":"rgba(154, 203, 11, 1.0)"},"line":{},"name":"bamB"},{"type":"scatter","mode":"markers","x":[-0.029020756695067595],"y":[-0.012124945457981333],"text":"bamC","marker":{"color":"rgba(128, 128, 128, 1.0)"},"line":{},"name":"bamC"},{"type":"scatter","mode":"markers","x":[-0.023756716756839668],"y":[-0.023854218393237404],"text":"bamD","marker":{"color":"rgba(128, 128, 128, 1.0)"},"line":{},"name":"bamD"},{"type":"scatter","mode":"markers","x":[-0.0036075145396435872],"y":[0.02060417099789861],"text":"basR","marker":{"color":"rgba(128, 128, 128, 1.0)"},"line":{},"name":"basR"},{"type":"scatter","mode":"markers","x":[0.001088866587189258],"y":[0.019657043232286415],"text":"basS","marker":{"color":"rgba(128, 128, 128, 1.0)"},"line":{},"name":"basS"},{"type":"scatter","mode":"markers","x":[-0.059489946234493295],"y":[-0.018244759768570398],"text":"bcp","marker":{"color":"rgba(154, 203, 11, 1.0)"},"line":{},"name":"bcp"},{"type":"scatter","mode":"markers","x":[0.02043150697167321],"y":[0.018010629679781336],"text":"bcsA","marker":{"color":"rgba(100, 0, 72, 1.0)"},"line":{},"name":"bcsA"},{"type":"scatter","mode":"markers","x":[0.014541373812357556],"y":[0.0164428267521969],"text":"bcsB","marker":{"color":"rgba(100, 0, 72, 1.0)"},"line":{},"name":"bcsB"},{"type":"scatter","mode":"markers","x":[0.0024137385583260923],"y":[-0.026886782843672297],"text":"bcsE","marker":{"color":"rgba(128, 128, 128, 1.0)"},"line":{},"name":"bcsE"},{"type":"scatter","mode":"markers","x":[0.004278255173885799],"y":[-0.02269905501382735],"text":"bcsF","marker":{"color":"rgba(128, 128, 128, 1.0)"},"line":{},"name":"bcsF"},{"type":"scatter","mode":"markers","x":[0.017235870497482007],"y":[0.014064612576835944],"text":"bcsZ","marker":{"color":"rgba(100, 0, 72, 1.0)"},"line":{},"name":"bcsZ"},{"type":"scatter","mode":"markers","x":[0.018602648430578333],"y":[0.026408732009017583],"text":"betA","marker":{"color":"rgba(128, 128, 128, 1.0)"},"line":{},"name":"betA"},{"type":"scatter","mode":"markers","x":[0.024628227717695877],"y":[0.03956796942686389],"text":"betB","marker":{"color":"rgba(128, 128, 128, 1.0)"},"line":{},"name":"betB"},{"type":"scatter","mode":"markers","x":[0.014383081245914552],"y":[0.03535961135790112],"text":"betI","marker":{"color":"rgba(128, 128, 128, 1.0)"},"line":{},"name":"betI"},{"type":"scatter","mode":"markers","x":[-0.08171025155767996],"y":[0.01865252910095468],"text":"bfr","marker":{"color":"rgba(154, 203, 11, 1.0)"},"line":{},"name":"bfr"},{"type":"scatter","mode":"markers","x":[-0.017085610560162084],"y":[-0.055425191893078644],"text":"bglA","marker":{"color":"rgba(160, 9, 118, 1.0)"},"line":{},"name":"bglA"},{"type":"scatter","mode":"markers","x":[0.0410288555664025],"y":[-0.030992299794337645],"text":"bglB","marker":{"color":"rgba(194, 73, 161, 1.0)"},"line":{},"name":"bglB"},{"type":"scatter","mode":"markers","x":[0.022064826908888887],"y":[0.009347593540585394],"text":"bglF","marker":{"color":"rgba(100, 0, 72, 1.0)"},"line":{},"name":"bglF"},{"type":"scatter","mode":"markers","x":[0.03638672853439043],"y":[-0.03511364988952507],"text":"bglG","marker":{"color":"rgba(194, 73, 161, 1.0)"},"line":{},"name":"bglG"},{"type":"scatter","mode":"markers","x":[0.02417997546830693],"y":[0.006726063775380403],"text":"bglH","marker":{"color":"rgba(100, 0, 72, 1.0)"},"line":{},"name":"bglH"},{"type":"scatter","mode":"markers","x":[-0.021864523679873776],"y":[0.033899279124430554],"text":"bioA","marker":{"color":"rgba(214, 138, 12, 1.0)"},"line":{},"name":"bioA"},{"type":"scatter","mode":"markers","x":[-0.1010911691171979],"y":[-0.008081238490084216],"text":"bioB","marker":{"color":"rgba(94, 127, 0, 1.0)"},"line":{},"name":"bioB"},{"type":"scatter","mode":"markers","x":[-0.055514065314457094],"y":[0.011789760550493137],"text":"bioC","marker":{"color":"rgba(94, 127, 0, 1.0)"},"line":{},"name":"bioC"},{"type":"scatter","mode":"markers","x":[-0.04811492506744075],"y":[0.0114273162664436],"text":"bioD","marker":{"color":"rgba(94, 127, 0, 1.0)"},"line":{},"name":"bioD"},{"type":"scatter","mode":"markers","x":[-0.07290616921625996],"y":[0.006250918939962473],"text":"bioF","marker":{"color":"rgba(94, 127, 0, 1.0)"},"line":{},"name":"bioF"},{"type":"scatter","mode":"markers","x":[-0.022852088607855106],"y":[-0.011604536329009934],"text":"bisC","marker":{"color":"rgba(154, 203, 11, 1.0)"},"line":{},"name":"bisC"},{"type":"scatter","mode":"markers","x":[0.08484087594081693],"y":[-0.041507954901853446],"text":"bssS","marker":{"color":"rgba(128, 128, 128, 1.0)"},"line":{},"name":"bssS"},{"type":"scatter","mode":"markers","x":[-0.046096057136274196],"y":[0.013540453617636056],"text":"btuD","marker":{"color":"rgba(128, 128, 128, 1.0)"},"line":{},"name":"btuD"},{"type":"scatter","mode":"markers","x":[-0.0595640646077351],"y":[0.011658184930992703],"text":"btuE","marker":{"color":"rgba(154, 203, 11, 1.0)"},"line":{},"name":"btuE"},{"type":"scatter","mode":"markers","x":[0.045348171823711966],"y":[-0.04043292968764194],"text":"cadA","marker":{"color":"rgba(194, 73, 161, 1.0)"},"line":{},"name":"cadA"},{"type":"scatter","mode":"markers","x":[0.04217785307896124],"y":[-0.0153667856592354],"text":"cadB","marker":{"color":"rgba(194, 73, 161, 1.0)"},"line":{},"name":"cadB"},{"type":"scatter","mode":"markers","x":[0.026560089480918075],"y":[-0.021971381834993406],"text":"cadC","marker":{"color":"rgba(194, 73, 161, 1.0)"},"line":{},"name":"cadC"},{"type":"scatter","mode":"markers","x":[0.0097644898363062],"y":[0.03762907270126235],"text":"caiD","marker":{"color":"rgba(128, 128, 128, 1.0)"},"line":{},"name":"caiD"},{"type":"scatter","mode":"markers","x":[0.031199866243205743],"y":[0.007536847710085882],"text":"caiE","marker":{"color":"rgba(100, 0, 72, 1.0)"},"line":{},"name":"caiE"},{"type":"scatter","mode":"markers","x":[0.007812835012829727],"y":[0.03901098073206782],"text":"caiT","marker":{"color":"rgba(128, 128, 128, 1.0)"},"line":{},"name":"caiT"},{"type":"scatter","mode":"markers","x":[-0.15082009362371906],"y":[-0.00475258313468311],"text":"carA","marker":{"color":"rgba(94, 127, 0, 1.0)"},"line":{},"name":"carA"},{"type":"scatter","mode":"markers","x":[-0.08634651246848252],"y":[0.011916239603491008],"text":"carB","marker":{"color":"rgba(94, 127, 0, 1.0)"},"line":{},"name":"carB"},{"type":"scatter","mode":"markers","x":[-0.05662009920972224],"y":[0.005506031248866946],"text":"cbl","marker":{"color":"rgba(94, 127, 0, 1.0)"},"line":{},"name":"cbl"},{"type":"scatter","mode":"markers","x":[-0.042898761902485996],"y":[-0.03174287094574593],"text":"cbpA","marker":{"color":"rgba(133, 83, 0, 1.0)"},"line":{},"name":"cbpA"},{"type":"scatter","mode":"markers","x":[-0.027604221724093565],"y":[-0.00532509661031393],"text":"cbpM","marker":{"color":"rgba(133, 83, 0, 1.0)"},"line":{},"name":"cbpM"},{"type":"scatter","mode":"markers","x":[0.010192510270532466],"y":[-0.01602065613837685],"text":"cbrA","marker":{"color":"rgba(194, 73, 161, 1.0)"},"line":{},"name":"cbrA"},{"type":"scatter","mode":"markers","x":[0.00827934186021743],"y":[0.023949406533402818],"text":"ccmA","marker":{"color":"rgba(128, 128, 128, 1.0)"},"line":{},"name":"ccmA"},{"type":"scatter","mode":"markers","x":[-0.005461470839698684],"y":[0.018592241024829814],"text":"ccmB","marker":{"color":"rgba(128, 128, 128, 1.0)"},"line":{},"name":"ccmB"},{"type":"scatter","mode":"markers","x":[0.023850938595170665],"y":[0.026524310201217323],"text":"cdaR","marker":{"color":"rgba(100, 0, 72, 1.0)"},"line":{},"name":"cdaR"},{"type":"scatter","mode":"markers","x":[-0.06694910042906167],"y":[-0.046130807178743696],"text":"cfa","marker":{"color":"rgba(133, 83, 0, 1.0)"},"line":{},"name":"cfa"},{"type":"scatter","mode":"markers","x":[-0.05828347419242026],"y":[-0.010653578576830395],"text":"chaC","marker":{"color":"rgba(133, 83, 0, 1.0)"},"line":{},"name":"chaC"},{"type":"scatter","mode":"markers","x":[-0.03520046368584753],"y":[-0.00780286845363962],"text":"chbF","marker":{"color":"rgba(128, 128, 128, 1.0)"},"line":{},"name":"chbF"},{"type":"scatter","mode":"markers","x":[0.0009493058349059961],"y":[0.1777300755765388],"text":"cheA","marker":{"color":"rgba(204, 243, 92, 1.0)"},"line":{},"name":"cheA"},{"type":"scatter","mode":"markers","x":[-0.004189779059233503],"y":[0.12732246549780296],"text":"cheB","marker":{"color":"rgba(204, 243, 92, 1.0)"},"line":{},"name":"cheB"},{"type":"scatter","mode":"markers","x":[-0.012058953663905093],"y":[0.11010591805691251],"text":"cheR","marker":{"color":"rgba(204, 243, 92, 1.0)"},"line":{},"name":"cheR"},{"type":"scatter","mode":"markers","x":[-0.02128296139396877],"y":[0.18637112568863073],"text":"cheW","marker":{"color":"rgba(204, 243, 92, 1.0)"},"line":{},"name":"cheW"},{"type":"scatter","mode":"markers","x":[-0.013552885806279183],"y":[0.12536792143901138],"text":"cheY","marker":{"color":"rgba(204, 243, 92, 1.0)"},"line":{},"name":"cheY"},{"type":"scatter","mode":"markers","x":[-0.02781533589442522],"y":[0.13081480057846578],"text":"cheZ","marker":{"color":"rgba(204, 243, 92, 1.0)"},"line":{},"name":"cheZ"},{"type":"scatter","mode":"markers","x":[0.006472533089948323],"y":[-0.012345699611893506],"text":"cho","marker":{"color":"rgba(75, 116, 173, 1.0)"},"line":{},"name":"cho"},{"type":"scatter","mode":"markers","x":[-0.006332724930563076],"y":[0.025498075415223698],"text":"citE","marker":{"color":"rgba(214, 138, 12, 1.0)"},"line":{},"name":"citE"},{"type":"scatter","mode":"markers","x":[-0.0003269254340942956],"y":[0.03603154717409134],"text":"citF","marker":{"color":"rgba(214, 138, 12, 1.0)"},"line":{},"name":"citF"},{"type":"scatter","mode":"markers","x":[-0.0009121108225747614],"y":[0.02714006597706389],"text":"citG","marker":{"color":"rgba(214, 138, 12, 1.0)"},"line":{},"name":"citG"},{"type":"scatter","mode":"markers","x":[-0.008384919629780595],"y":[0.02674921119050068],"text":"citT","marker":{"color":"rgba(214, 138, 12, 1.0)"},"line":{},"name":"citT"},{"type":"scatter","mode":"markers","x":[-0.0026595651274886993],"y":[0.03183770558594046],"text":"citX","marker":{"color":"rgba(214, 138, 12, 1.0)"},"line":{},"name":"citX"},{"type":"scatter","mode":"markers","x":[-0.02176847053406278],"y":[-0.01057378971018449],"text":"clcA","marker":{"color":"rgba(160, 9, 118, 1.0)"},"line":{},"name":"clcA"},{"type":"scatter","mode":"markers","x":[0.0016698129543701184],"y":[0.015503959034162035],"text":"clcB","marker":{"color":"rgba(128, 128, 128, 1.0)"},"line":{},"name":"clcB"},{"type":"scatter","mode":"markers","x":[-0.06581748244601147],"y":[0.04675153649743417],"text":"clpA","marker":{"color":"rgba(154, 203, 11, 1.0)"},"line":{},"name":"clpA"},{"type":"scatter","mode":"markers","x":[-0.058600313917334675],"y":[0.01581214336218535],"text":"clpS","marker":{"color":"rgba(154, 203, 11, 1.0)"},"line":{},"name":"clpS"},{"type":"scatter","mode":"markers","x":[-0.0787254958273046],"y":[-0.004707135150018231],"text":"cls","marker":{"color":"rgba(154, 203, 11, 1.0)"},"line":{},"name":"cls"},{"type":"scatter","mode":"markers","x":[0.012982048320691728],"y":[-0.004586503012748544],"text":"cmk","marker":{"color":"rgba(75, 116, 173, 1.0)"},"line":{},"name":"cmk"},{"type":"scatter","mode":"markers","x":[-0.029195028051508302],"y":[-0.025805676460813894],"text":"cmoA","marker":{"color":"rgba(75, 116, 173, 1.0)"},"line":{},"name":"cmoA"},{"type":"scatter","mode":"markers","x":[-0.007837874307093415],"y":[0.005656883605241457],"text":"cmoB","marker":{"color":"rgba(75, 116, 173, 1.0)"},"line":{},"name":"cmoB"},{"type":"scatter","mode":"markers","x":[0.017386583316614187],"y":[-0.009086320372318386],"text":"cmtB","marker":{"color":"rgba(194, 73, 161, 1.0)"},"line":{},"name":"cmtB"},{"type":"scatter","mode":"markers","x":[-0.03623409035565264],"y":[-0.015464685386732235],"text":"coaA","marker":{"color":"rgba(160, 9, 118, 1.0)"},"line":{},"name":"coaA"},{"type":"scatter","mode":"markers","x":[-0.039672186013806184],"y":[0.014093810019645438],"text":"cobB","marker":{"color":"rgba(154, 203, 11, 1.0)"},"line":{},"name":"cobB"},{"type":"scatter","mode":"markers","x":[-0.046971915186064715],"y":[-0.011057880799783428],"text":"cobS","marker":{"color":"rgba(154, 203, 11, 1.0)"},"line":{},"name":"cobS"},{"type":"scatter","mode":"markers","x":[-0.037265782041475695],"y":[-0.006946402020232328],"text":"cobT","marker":{"color":"rgba(154, 203, 11, 1.0)"},"line":{},"name":"cobT"},{"type":"scatter","mode":"markers","x":[-0.029815683718177378],"y":[0.006778772118790924],"text":"cobU","marker":{"color":"rgba(154, 203, 11, 1.0)"},"line":{},"name":"cobU"},{"type":"scatter","mode":"markers","x":[-0.12825052313875046],"y":[-0.01907295352416633],"text":"codA","marker":{"color":"rgba(94, 127, 0, 1.0)"},"line":{},"name":"codA"},{"type":"scatter","mode":"markers","x":[-0.15906341572588314],"y":[-0.03566960718669895],"text":"codB","marker":{"color":"rgba(94, 127, 0, 1.0)"},"line":{},"name":"codB"},{"type":"scatter","mode":"markers","x":[-0.05295429029227692],"y":[0.006003864130610713],"text":"copA","marker":{"color":"rgba(128, 128, 128, 1.0)"},"line":{},"name":"copA"},{"type":"scatter","mode":"markers","x":[0.006152897716253019],"y":[0.012445816067483835],"text":"cpsB","marker":{"color":"rgba(128, 128, 128, 1.0)"},"line":{},"name":"cpsB"},{"type":"scatter","mode":"markers","x":[0.010692278722869158],"y":[0.020806830061355315],"text":"cpsG","marker":{"color":"rgba(128, 128, 128, 1.0)"},"line":{},"name":"cpsG"},{"type":"scatter","mode":"markers","x":[-0.03117454700366714],"y":[-0.01797239238811547],"text":"creA","marker":{"color":"rgba(154, 203, 11, 1.0)"},"line":{},"name":"creA"},{"type":"scatter","mode":"markers","x":[-0.11559685909997675],"y":[-0.0323511584285005],"text":"csgD","marker":{"color":"rgba(133, 83, 0, 1.0)"},"line":{},"name":"csgD"},{"type":"scatter","mode":"markers","x":[-0.0900965124506647],"y":[-0.02752699930925013],"text":"csgE","marker":{"color":"rgba(133, 83, 0, 1.0)"},"line":{},"name":"csgE"},{"type":"scatter","mode":"markers","x":[-0.10972566942425192],"y":[-0.02917942654011648],"text":"csgF","marker":{"color":"rgba(133, 83, 0, 1.0)"},"line":{},"name":"csgF"},{"type":"scatter","mode":"markers","x":[-0.05867933512322828],"y":[-0.010236046055150152],"text":"csgG","marker":{"color":"rgba(133, 83, 0, 1.0)"},"line":{},"name":"csgG"},{"type":"scatter","mode":"markers","x":[-0.008617178881503474],"y":[0.11077461678845023],"text":"csiD","marker":{"color":"rgba(255, 195, 96, 1.0)"},"line":{},"name":"csiD"},{"type":"scatter","mode":"markers","x":[0.02830553701067605],"y":[-0.06030182364100686],"text":"cspG","marker":{"color":"rgba(194, 73, 161, 1.0)"},"line":{},"name":"cspG"},{"type":"scatter","mode":"markers","x":[0.02143634825906666],"y":[-0.022996745736646944],"text":"cspH","marker":{"color":"rgba(128, 128, 128, 1.0)"},"line":{},"name":"cspH"},{"type":"scatter","mode":"markers","x":[0.021571450085101217],"y":[-0.0417560563139911],"text":"cspI","marker":{"color":"rgba(128, 128, 128, 1.0)"},"line":{},"name":"cspI"},{"type":"scatter","mode":"markers","x":[-0.024741619591728013],"y":[0.16089897236819564],"text":"cstA","marker":{"color":"rgba(255, 195, 96, 1.0)"},"line":{},"name":"cstA"},{"type":"scatter","mode":"markers","x":[-0.03601476962884323],"y":[0.015941631738933988],"text":"cueO","marker":{"color":"rgba(128, 128, 128, 1.0)"},"line":{},"name":"cueO"},{"type":"scatter","mode":"markers","x":[-0.04890945993087473],"y":[0.005419748612585693],"text":"cueR","marker":{"color":"rgba(133, 83, 0, 1.0)"},"line":{},"name":"cueR"},{"type":"scatter","mode":"markers","x":[-0.05064611716544587],"y":[-0.0074820277081362385],"text":"cusA","marker":{"color":"rgba(255, 192, 203, 1.0)"},"line":{},"name":"cusA"},{"type":"scatter","mode":"markers","x":[-0.06293397254920019],"y":[-0.02633084334343966],"text":"cusB","marker":{"color":"rgba(255, 192, 203, 1.0)"},"line":{},"name":"cusB"},{"type":"scatter","mode":"markers","x":[-0.13924062618913832],"y":[-0.06535591525635347],"text":"cusC","marker":{"color":"rgba(255, 192, 203, 1.0)"},"line":{},"name":"cusC"},{"type":"scatter","mode":"markers","x":[-0.16527500881690566],"y":[-0.0762423851392988],"text":"cusF","marker":{"color":"rgba(255, 192, 203, 1.0)"},"line":{},"name":"cusF"},{"type":"scatter","mode":"markers","x":[-0.07098605932270267],"y":[-0.008201747853307961],"text":"cusR","marker":{"color":"rgba(255, 192, 203, 1.0)"},"line":{},"name":"cusR"},{"type":"scatter","mode":"markers","x":[-0.04798866982641468],"y":[-0.02149505774646877],"text":"cusS","marker":{"color":"rgba(255, 192, 203, 1.0)"},"line":{},"name":"cusS"},{"type":"scatter","mode":"markers","x":[-0.0022393750219290437],"y":[0.003907313118013659],"text":"cutC","marker":{"color":"rgba(128, 128, 128, 1.0)"},"line":{},"name":"cutC"},{"type":"scatter","mode":"markers","x":[-0.09859891314671193],"y":[-0.0020339965853763972],"text":"cvpA","marker":{"color":"rgba(94, 127, 0, 1.0)"},"line":{},"name":"cvpA"},{"type":"scatter","mode":"markers","x":[-0.042183791504585545],"y":[0.016599949179609684],"text":"cvrA","marker":{"color":"rgba(94, 127, 0, 1.0)"},"line":{},"name":"cvrA"},{"type":"scatter","mode":"markers","x":[-0.04855764811810967],"y":[-0.0875078170949097],"text":"cyaA","marker":{"color":"rgba(160, 9, 118, 1.0)"},"line":{},"name":"cyaA"},{"type":"scatter","mode":"markers","x":[-0.05398058306746172],"y":[0.00281740848470606],"text":"cybB","marker":{"color":"rgba(154, 203, 11, 1.0)"},"line":{},"name":"cybB"},{"type":"scatter","mode":"markers","x":[-0.02912492309828807],"y":[-0.1356647272015522],"text":"cydA","marker":{"color":"rgba(128, 128, 128, 1.0)"},"line":{},"name":"cydA"},{"type":"scatter","mode":"markers","x":[-0.01579067595629154],"y":[-0.1073977997538227],"text":"cydB","marker":{"color":"rgba(128, 128, 128, 1.0)"},"line":{},"name":"cydB"},{"type":"scatter","mode":"markers","x":[0.021977276772473957],"y":[0.11544840744213855],"text":"cyoA","marker":{"color":"rgba(19, 71, 141, 1.0)"},"line":{},"name":"cyoA"},{"type":"scatter","mode":"markers","x":[0.0066066379413144555],"y":[0.14098805261551026],"text":"cyoB","marker":{"color":"rgba(19, 71, 141, 1.0)"},"line":{},"name":"cyoB"},{"type":"scatter","mode":"markers","x":[-0.021061650954657073],"y":[0.13355814003341218],"text":"cyoC","marker":{"color":"rgba(19, 71, 141, 1.0)"},"line":{},"name":"cyoC"},{"type":"scatter","mode":"markers","x":[-0.03477004679500217],"y":[0.14388296665076983],"text":"cyoD","marker":{"color":"rgba(19, 71, 141, 1.0)"},"line":{},"name":"cyoD"},{"type":"scatter","mode":"markers","x":[-0.021483608318024015],"y":[0.10746330482844378],"text":"cyoE","marker":{"color":"rgba(19, 71, 141, 1.0)"},"line":{},"name":"cyoE"},{"type":"scatter","mode":"markers","x":[-0.07314839206254323],"y":[-0.008319222063112119],"text":"cysA","marker":{"color":"rgba(94, 127, 0, 1.0)"},"line":{},"name":"cysA"},{"type":"scatter","mode":"markers","x":[-0.0594355963846634],"y":[0.02420974822693761],"text":"cysB","marker":{"color":"rgba(154, 203, 11, 1.0)"},"line":{},"name":"cysB"},{"type":"scatter","mode":"markers","x":[-0.12706209091271953],"y":[-0.014098908210851833],"text":"cysC","marker":{"color":"rgba(94, 127, 0, 1.0)"},"line":{},"name":"cysC"},{"type":"scatter","mode":"markers","x":[-0.17210644856284138],"y":[-0.017900183763375613],"text":"cysD","marker":{"color":"rgba(94, 127, 0, 1.0)"},"line":{},"name":"cysD"},{"type":"scatter","mode":"markers","x":[-0.1373181887394596],"y":[0.013762525325184578],"text":"cysH","marker":{"color":"rgba(94, 127, 0, 1.0)"},"line":{},"name":"cysH"},{"type":"scatter","mode":"markers","x":[-0.111911641307783],"y":[-0.0068914747445718684],"text":"cysI","marker":{"color":"rgba(94, 127, 0, 1.0)"},"line":{},"name":"cysI"},{"type":"scatter","mode":"markers","x":[-0.11018482326160255],"y":[-0.0070077865267949725],"text":"cysJ","marker":{"color":"rgba(94, 127, 0, 1.0)"},"line":{},"name":"cysJ"},{"type":"scatter","mode":"markers","x":[-0.1520299648129039],"y":[0.01594528689177382],"text":"cysK","marker":{"color":"rgba(94, 127, 0, 1.0)"},"line":{},"name":"cysK"},{"type":"scatter","mode":"markers","x":[-0.07009436190943644],"y":[0.020055532722392907],"text":"cysM","marker":{"color":"rgba(94, 127, 0, 1.0)"},"line":{},"name":"cysM"},{"type":"scatter","mode":"markers","x":[-0.1575022434992344],"y":[-0.017704108062484014],"text":"cysN","marker":{"color":"rgba(94, 127, 0, 1.0)"},"line":{},"name":"cysN"},{"type":"scatter","mode":"markers","x":[-0.107709014875157],"y":[-0.03476435899874978],"text":"cysP","marker":{"color":"rgba(94, 127, 0, 1.0)"},"line":{},"name":"cysP"},{"type":"scatter","mode":"markers","x":[-0.0065525282683745936],"y":[-0.01615431605728061],"text":"cysS","marker":{"color":"rgba(75, 116, 173, 1.0)"},"line":{},"name":"cysS"},{"type":"scatter","mode":"markers","x":[-0.10934675579199075],"y":[-0.02124145574386858],"text":"cysU","marker":{"color":"rgba(94, 127, 0, 1.0)"},"line":{},"name":"cysU"},{"type":"scatter","mode":"markers","x":[-0.06408536325417245],"y":[-0.0002344216102642381],"text":"cysW","marker":{"color":"rgba(94, 127, 0, 1.0)"},"line":{},"name":"cysW"},{"type":"scatter","mode":"markers","x":[0.004322647639219778],"y":[0.005674267678572324],"text":"cysZ","marker":{"color":"rgba(75, 116, 173, 1.0)"},"line":{},"name":"cysZ"},{"type":"scatter","mode":"markers","x":[-0.06602303764206686],"y":[0.002488810617471597],"text":"dacC","marker":{"color":"rgba(154, 203, 11, 1.0)"},"line":{},"name":"dacC"},{"type":"scatter","mode":"markers","x":[-0.01710286078830952],"y":[0.08397021035669193],"text":"dadA","marker":{"color":"rgba(128, 128, 128, 1.0)"},"line":{},"name":"dadA"},{"type":"scatter","mode":"markers","x":[0.002066658041928322],"y":[0.06298901850650986],"text":"dadX","marker":{"color":"rgba(128, 128, 128, 1.0)"},"line":{},"name":"dadX"},{"type":"scatter","mode":"markers","x":[-0.02008362559865167],"y":[-0.01226552305010362],"text":"damX","marker":{"color":"rgba(75, 116, 173, 1.0)"},"line":{},"name":"damX"},{"type":"scatter","mode":"markers","x":[0.0014762256751327313],"y":[-0.04492002005219103],"text":"dam","marker":{"color":"rgba(75, 116, 173, 1.0)"},"line":{},"name":"dam"},{"type":"scatter","mode":"markers","x":[-0.01726177401354252],"y":[-0.034363468563885446],"text":"dapA","marker":{"color":"rgba(160, 9, 118, 1.0)"},"line":{},"name":"dapA"},{"type":"scatter","mode":"markers","x":[-0.06841432283118737],"y":[0.010386597040477253],"text":"dapB","marker":{"color":"rgba(94, 127, 0, 1.0)"},"line":{},"name":"dapB"},{"type":"scatter","mode":"markers","x":[-0.08308860335252559],"y":[-0.02439399435538631],"text":"dapD","marker":{"color":"rgba(154, 203, 11, 1.0)"},"line":{},"name":"dapD"},{"type":"scatter","mode":"markers","x":[-0.02787453824051109],"y":[0.05258473474235007],"text":"dbpA","marker":{"color":"rgba(214, 138, 12, 1.0)"},"line":{},"name":"dbpA"},{"type":"scatter","mode":"markers","x":[-0.0003018662384442802],"y":[0.022765350523611987],"text":"dcd","marker":{"color":"rgba(128, 128, 128, 1.0)"},"line":{},"name":"dcd"},{"type":"scatter","mode":"markers","x":[-0.027841685597864978],"y":[-0.01193785629822665],"text":"dcm","marker":{"color":"rgba(128, 128, 128, 1.0)"},"line":{},"name":"dcm"},{"type":"scatter","mode":"markers","x":[-0.05417094462798304],"y":[0.009512592220018334],"text":"dcp","marker":{"color":"rgba(154, 203, 11, 1.0)"},"line":{},"name":"dcp"},{"type":"scatter","mode":"markers","x":[0.0476585690370448],"y":[-0.0057235170415553946],"text":"dcrB","marker":{"color":"rgba(128, 128, 128, 1.0)"},"line":{},"name":"dcrB"},{"type":"scatter","mode":"markers","x":[-0.08180724150079086],"y":[-0.013451737376566797],"text":"dcyD","marker":{"color":"rgba(94, 127, 0, 1.0)"},"line":{},"name":"dcyD"},{"type":"scatter","mode":"markers","x":[-0.0018829764824576318],"y":[0.04408303530263703],"text":"ddpA","marker":{"color":"rgba(255, 195, 96, 1.0)"},"line":{},"name":"ddpA"},{"type":"scatter","mode":"markers","x":[0.0008298422763480017],"y":[0.04951163360158315],"text":"ddpB","marker":{"color":"rgba(255, 195, 96, 1.0)"},"line":{},"name":"ddpB"},{"type":"scatter","mode":"markers","x":[-0.00790397000533105],"y":[0.034325641349257315],"text":"ddpC","marker":{"color":"rgba(255, 195, 96, 1.0)"},"line":{},"name":"ddpC"},{"type":"scatter","mode":"markers","x":[-0.00480936190905927],"y":[0.03260598154783867],"text":"ddpD","marker":{"color":"rgba(255, 195, 96, 1.0)"},"line":{},"name":"ddpD"},{"type":"scatter","mode":"markers","x":[-0.0007886755520611033],"y":[0.02589873630640484],"text":"ddpF","marker":{"color":"rgba(214, 138, 12, 1.0)"},"line":{},"name":"ddpF"},{"type":"scatter","mode":"markers","x":[-0.005072490285842176],"y":[0.07388017994471803],"text":"ddpX","marker":{"color":"rgba(255, 195, 96, 1.0)"},"line":{},"name":"ddpX"},{"type":"scatter","mode":"markers","x":[0.014998269301064479],"y":[-0.01363366555983361],"text":"dedA","marker":{"color":"rgba(75, 116, 173, 1.0)"},"line":{},"name":"dedA"},{"type":"scatter","mode":"markers","x":[0.042528078342635264],"y":[-0.05627074226162411],"text":"deoA","marker":{"color":"rgba(5, 40, 88, 1.0)"},"line":{},"name":"deoA"},{"type":"scatter","mode":"markers","x":[0.04473558223977935],"y":[-0.0521907118669273],"text":"deoB","marker":{"color":"rgba(5, 40, 88, 1.0)"},"line":{},"name":"deoB"},{"type":"scatter","mode":"markers","x":[0.0634081405252179],"y":[-0.07960609480323304],"text":"deoC","marker":{"color":"rgba(5, 40, 88, 1.0)"},"line":{},"name":"deoC"},{"type":"scatter","mode":"markers","x":[0.05300674693050288],"y":[-0.06524617836167827],"text":"deoD","marker":{"color":"rgba(5, 40, 88, 1.0)"},"line":{},"name":"deoD"},{"type":"scatter","mode":"markers","x":[0.032472416290230066],"y":[-0.002798616034658825],"text":"dfp","marker":{"color":"rgba(75, 116, 173, 1.0)"},"line":{},"name":"dfp"},{"type":"scatter","mode":"markers","x":[-0.029878748031130452],"y":[-0.02087056003605388],"text":"dgkA","marker":{"color":"rgba(160, 9, 118, 1.0)"},"line":{},"name":"dgkA"}];
        var layout = {"width":600,"height":600,"template":{"layout":{"title":{"x":0.05},"font":{"color":"rgba(42, 63, 95, 1.0)"},"paper_bgcolor":"rgba(255, 255, 255, 1.0)","plot_bgcolor":"rgba(229, 236, 246, 1.0)","autotypenumbers":"strict","colorscale":{"diverging":[[0.0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1.0,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"hovermode":"closest","hoverlabel":{"align":"left"},"coloraxis":{"colorbar":{"outlinewidth":0.0,"ticks":""}},"geo":{"showland":true,"landcolor":"rgba(229, 236, 246, 1.0)","showlakes":true,"lakecolor":"rgba(255, 255, 255, 1.0)","subunitcolor":"rgba(255, 255, 255, 1.0)","bgcolor":"rgba(255, 255, 255, 1.0)"},"mapbox":{"style":"light"},"polar":{"bgcolor":"rgba(229, 236, 246, 1.0)","radialaxis":{"linecolor":"rgba(255, 255, 255, 1.0)","gridcolor":"rgba(255, 255, 255, 1.0)","ticks":""},"angularaxis":{"linecolor":"rgba(255, 255, 255, 1.0)","gridcolor":"rgba(255, 255, 255, 1.0)","ticks":""}},"scene":{"xaxis":{"ticks":"","linecolor":"rgba(255, 255, 255, 1.0)","gridcolor":"rgba(255, 255, 255, 1.0)","gridwidth":2.0,"zerolinecolor":"rgba(255, 255, 255, 1.0)","backgroundcolor":"rgba(229, 236, 246, 1.0)","showbackground":true},"yaxis":{"ticks":"","linecolor":"rgba(255, 255, 255, 1.0)","gridcolor":"rgba(255, 255, 255, 1.0)","gridwidth":2.0,"zerolinecolor":"rgba(255, 255, 255, 1.0)","backgroundcolor":"rgba(229, 236, 246, 1.0)","showbackground":true},"zaxis":{"ticks":"","linecolor":"rgba(255, 255, 255, 1.0)","gridcolor":"rgba(255, 255, 255, 1.0)","gridwidth":2.0,"zerolinecolor":"rgba(255, 255, 255, 1.0)","backgroundcolor":"rgba(229, 236, 246, 1.0)","showbackground":true}},"ternary":{"aaxis":{"ticks":"","linecolor":"rgba(255, 255, 255, 1.0)","gridcolor":"rgba(255, 255, 255, 1.0)"},"baxis":{"ticks":"","linecolor":"rgba(255, 255, 255, 1.0)","gridcolor":"rgba(255, 255, 255, 1.0)"},"caxis":{"ticks":"","linecolor":"rgba(255, 255, 255, 1.0)","gridcolor":"rgba(255, 255, 255, 1.0)"},"bgcolor":"rgba(229, 236, 246, 1.0)"},"xaxis":{"title":{"standoff":15},"ticks":"","automargin":"height+width+left+right+top+bottom","linecolor":"rgba(255, 255, 255, 1.0)","gridcolor":"rgba(255, 255, 255, 1.0)","zerolinecolor":"rgba(255, 255, 255, 1.0)","zerolinewidth":2.0},"yaxis":{"title":{"standoff":15},"ticks":"","automargin":"height+width+left+right+top+bottom","linecolor":"rgba(255, 255, 255, 1.0)","gridcolor":"rgba(255, 255, 255, 1.0)","zerolinecolor":"rgba(255, 255, 255, 1.0)","zerolinewidth":2.0},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"shapedefaults":{"line":{"color":"rgba(42, 63, 95, 1.0)"}},"colorway":["rgba(99, 110, 250, 1.0)","rgba(239, 85, 59, 1.0)","rgba(0, 204, 150, 1.0)","rgba(171, 99, 250, 1.0)","rgba(255, 161, 90, 1.0)","rgba(25, 211, 243, 1.0)","rgba(255, 102, 146, 1.0)","rgba(182, 232, 128, 1.0)","rgba(255, 151, 255, 1.0)","rgba(254, 203, 82, 1.0)"]},"data":{"bar":[{"marker":{"line":{"color":"rgba(229, 236, 246, 1.0)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"error_x":{"color":"rgba(42, 63, 95, 1.0)"},"error_y":{"color":"rgba(42, 63, 95, 1.0)"}}],"barpolar":[{"marker":{"line":{"color":"rgba(229, 236, 246, 1.0)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}}}],"carpet":[{"aaxis":{"linecolor":"rgba(255, 255, 255, 1.0)","gridcolor":"rgba(255, 255, 255, 1.0)","endlinecolor":"rgba(42, 63, 95, 1.0)","minorgridcolor":"rgba(255, 255, 255, 1.0)","startlinecolor":"rgba(42, 63, 95, 1.0)"},"baxis":{"linecolor":"rgba(255, 255, 255, 1.0)","gridcolor":"rgba(255, 255, 255, 1.0)","endlinecolor":"rgba(42, 63, 95, 1.0)","minorgridcolor":"rgba(255, 255, 255, 1.0)","startlinecolor":"rgba(42, 63, 95, 1.0)"}}],"choropleth":[{"colorbar":{"outlinewidth":0.0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contour":[{"colorbar":{"outlinewidth":0.0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"colorbar":{"outlinewidth":0.0,"ticks":""}}],"heatmap":[{"colorbar":{"outlinewidth":0.0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"colorbar":{"outlinewidth":0.0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}}}],"histogram2d":[{"colorbar":{"outlinewidth":0.0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0.0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"colorbar":{"outlinewidth":0.0,"ticks":""}}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0.0,"ticks":""}}}],"pie":[{"automargin":true}],"scatter":[{"marker":{"colorbar":{"outlinewidth":0.0,"ticks":""}}}],"scatter3d":[{"marker":{"colorbar":{"outlinewidth":0.0,"ticks":""}},"line":{"colorbar":{"outlinewidth":0.0,"ticks":""}}}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0.0,"ticks":""}}}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0.0,"ticks":""}}}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0.0,"ticks":""}}}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0.0,"ticks":""}}}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0.0,"ticks":""}}}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0.0,"ticks":""}}}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0.0,"ticks":""}}}],"surface":[{"colorbar":{"outlinewidth":0.0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"table":[{"cells":{"fill":{"color":"rgba(235, 240, 248, 1.0)"},"line":{"color":"rgba(255, 255, 255, 1.0)"}},"header":{"fill":{"color":"rgba(200, 212, 227, 1.0)"},"line":{"color":"rgba(255, 255, 255, 1.0)"}}}]}},"yaxis":{"title":{"text":"PC2"}},"xaxis":{"title":{"text":"PC1"}}};
        var config = {"responsive":true};
        Plotly.newPlot('60be05b4-f3ad-4734-9dbb-f15eecdd3f88', data, layout, config);
    });
};
if ((typeof(requirejs) !==  typeof(Function)) || (typeof(requirejs.config) !== typeof(Function))) {
    var script = document.createElement("script");
    script.setAttribute("src", "https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js");
    script.onload = function(){
        renderPlotly_60be05b4f3ad47349dbbf15eecdd3f88();
    };
    document.getElementsByTagName("head")[0].appendChild(script);
}
else {
    renderPlotly_60be05b4f3ad47349dbbf15eecdd3f88();
}
</script></div>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>While some communities from the Louvain analysis can be spotted in the PCA chart on behalf of their clustering, most of them are widespread, a sign for a high variance in the original dataset.
Using a clustering algorithm would lead to a much different communities than the PCA revealed.
A mathematical demonstration of this was deemed unnecessary, since most of the data points lie on top of another and would therefore be clustered together.</p>
<h2 id="Ontology-Enrichment">Ontology Enrichment<a class="anchor-link" href="#Ontology-Enrichment">&#182;</a></h2><p>Ontology enrichment is a method to identify overrepresented transcript/protein groups in data sets. 
The used annotation is based on the <a href="https://github.com/CSBiology/ARCs/tree/main/AnnotationARC">AnnotationARC</a> .
and the calculation is done via <a href="https://github.com/CSBiology/BioFSharp">BioFSharp.Stats</a> .
Here we try to find overrepresented protein functions in the Louvain communities to see if there is a functional modularity or if the communities are not that relevant, just like the PCA suggested. The result of the ontology enrichment can be seen in the following table. The headers are explained in the <a href="https://csbiology.github.io/BioFSharp//GSEA.html">BioFsharp doku</a> .</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[17]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-F#"><pre><span></span><span class="o">#</span><span class="n">r</span><span class="w"> </span><span class="s">"nuget: BioFSharp, 2.0.0-beta7"</span>
<span class="o">#</span><span class="n">r</span><span class="w"> </span><span class="s">"nuget: BioFSharp.Stats, 2.0.0-beta6"</span>

<span class="k">open</span><span class="w"> </span><span class="nn">BioFSharp</span>
<span class="k">open</span><span class="w"> </span><span class="nn">BioFSharp.Stats</span>

<span class="c1">// Maps the gene name to its molecular function based on the AnnotationARC</span>
<span class="k">let</span><span class="w"> </span><span class="nv">geneNameToMolecularFunction</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="k">let</span><span class="w"> </span><span class="nv">d</span><span class="w"> </span><span class="o">:</span><span class="n">Frame</span><span class="o">&lt;</span><span class="kt">string</span><span class="o">,</span><span class="kt">string</span><span class="o">&gt;=</span>
<span class="w">        </span><span class="nn">Frame</span><span class="p">.</span><span class="n">ReadCsv</span><span class="o">(</span><span class="s">@"../../files/ecoliGeneExpression.tsv"</span><span class="o">,</span><span class="n">separators</span><span class="o">=</span><span class="s">"</span><span class="se">\t</span><span class="s">"</span><span class="o">)</span>
<span class="w">        </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">Frame</span><span class="p">.</span><span class="n">take</span><span class="w"> </span><span class="mi">500</span>
<span class="w">        </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">Frame</span><span class="p">.</span><span class="n">indexRows</span><span class="w"> </span><span class="s">"Key"</span>

<span class="w">    </span><span class="k">let</span><span class="w"> </span><span class="nv">col</span><span class="w"> </span><span class="o">:</span><span class="n">Series</span><span class="o">&lt;</span><span class="kt">string</span><span class="o">,</span><span class="kt">string</span><span class="o">&gt;=</span>
<span class="w">        </span><span class="nn">Frame</span><span class="p">.</span><span class="n">getCol</span><span class="w"> </span><span class="s">"Gene ontology (molecular function)"</span><span class="w"> </span><span class="n">d</span>

<span class="w">    </span><span class="nn">Seq</span><span class="p">.</span><span class="n">map2</span><span class="w"> </span><span class="o">(</span><span class="k">fun</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">(</span><span class="n">name</span><span class="o">,</span><span class="n">f</span><span class="o">))</span><span class="w"> </span><span class="o">(</span><span class="n">col</span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">Series</span><span class="p">.</span><span class="n">keys</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">col</span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">Series</span><span class="p">.</span><span class="n">values</span><span class="o">)</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">Map</span><span class="p">.</span><span class="n">ofSeq</span>

<span class="c1">// List of all the community identifiers we want to use for ontology enrichment</span>
<span class="k">let</span><span class="w"> </span><span class="nv">moduleNumbers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[|</span><span class="mi">0</span><span class="o">..</span><span class="mi">34</span><span class="o">|]</span>

<span class="c1">// Create the ontology terms on the gene data</span>
<span class="k">let</span><span class="w"> </span><span class="nv">ontologyTerms</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="nn">Vertices</span><span class="p">.</span><span class="n">getLabelList</span><span class="w"> </span><span class="n">louvainGraph</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">Array</span><span class="p">.</span><span class="n">map</span><span class="o">(</span><span class="k">fun</span><span class="w"> </span><span class="o">(</span><span class="n">name</span><span class="o">,</span><span class="n">community</span><span class="o">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">(</span><span class="n">name</span><span class="o">,[|</span><span class="mi">1</span><span class="o">.</span><span class="mi">223</span><span class="o">;</span><span class="mi">2</span><span class="o">.</span><span class="mi">123123</span><span class="o">|],</span><span class="n">community</span><span class="o">,(</span><span class="nn">Map</span><span class="p">.</span><span class="n">find</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">geneNameToMolecularFunction</span><span class="o">)))</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">Array</span><span class="p">.</span><span class="n">map</span><span class="w"> </span><span class="o">(</span><span class="k">fun</span><span class="w"> </span><span class="o">(</span><span class="n">name</span><span class="o">,</span><span class="n">data</span><span class="o">,</span><span class="n">modularityClass</span><span class="o">,</span><span class="n">annotation</span><span class="o">)</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">        </span><span class="k">let</span><span class="w"> </span><span class="nv">annotationProcessed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">annotation</span><span class="o">.</span><span class="n">Replace</span><span class="w"> </span><span class="o">(</span><span class="s">"| "</span><span class="o">,</span><span class="s">"|"</span><span class="o">)</span>
<span class="w">        </span><span class="nn">OntologyEnrichment</span><span class="p">.</span><span class="n">createOntologyItem</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">annotationProcessed</span><span class="w"> </span><span class="n">modularityClass</span><span class="w"> </span><span class="n">data</span>
<span class="w">        </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">OntologyEnrichment</span><span class="p">.</span><span class="n">splitMultipleAnnotationsBy</span><span class="w"> </span><span class="sc">'|'</span><span class="w"> </span>
<span class="w">        </span><span class="o">)</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">Seq</span><span class="p">.</span><span class="n">concat</span>

<span class="c1">// Run the ontology enrichment on every enty in ontologyTerms</span>
<span class="k">let</span><span class="w"> </span><span class="nv">gseaResult</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="n">moduleNumbers</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">Array</span><span class="p">.</span><span class="n">map</span><span class="w"> </span><span class="o">(</span><span class="k">fun</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">        </span><span class="n">x</span><span class="o">,</span><span class="nn">OntologyEnrichment</span><span class="p">.</span><span class="n">CalcOverEnrichment</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">(</span><span class="n">Some</span><span class="w"> </span><span class="mi">5</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">Some</span><span class="w"> </span><span class="mi">2</span><span class="o">)</span><span class="w"> </span><span class="n">ontologyTerms</span>
<span class="w">        </span><span class="o">)</span>

<span class="c1">// Return the enriched ontology entries </span>
<span class="k">let</span><span class="w"> </span><span class="nv">ontologyResult</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
<span class="w">    </span><span class="n">gseaResult</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">Array</span><span class="p">.</span><span class="n">map</span><span class="w"> </span><span class="o">(</span><span class="k">fun</span><span class="w"> </span><span class="o">(</span><span class="n">moduleNumber</span><span class="o">,</span><span class="n">moduleEnrichment</span><span class="o">)</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">        </span><span class="k">let</span><span class="w"> </span><span class="nv">pvalues</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">moduleEnrichment</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">Seq</span><span class="p">.</span><span class="n">map</span><span class="w"> </span><span class="o">(</span><span class="k">fun</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">x</span><span class="o">.</span><span class="n">PValue</span><span class="o">)</span>
<span class="w">        </span><span class="k">let</span><span class="w"> </span><span class="nv">pvaluesAdj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nn">MultipleTesting</span><span class="p">.</span><span class="n">benjaminiHochbergFDR</span><span class="w"> </span><span class="n">pvalues</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">Array</span><span class="p">.</span><span class="n">ofSeq</span>
<span class="w">        </span><span class="n">moduleEnrichment</span>
<span class="w">        </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">Seq</span><span class="p">.</span><span class="n">mapi</span><span class="w"> </span><span class="o">(</span><span class="k">fun</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">x</span><span class="o">,</span><span class="n">pvaluesAdj</span><span class="o">.[</span><span class="n">i</span><span class="o">])</span>
<span class="w">        </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">Seq</span><span class="p">.</span><span class="n">filter</span><span class="w"> </span><span class="o">(</span><span class="k">fun</span><span class="w"> </span><span class="o">(</span><span class="n">item</span><span class="o">,</span><span class="n">pvalAdj</span><span class="o">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">item</span><span class="o">.</span><span class="n">PValue</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="o">.</span><span class="mi">05</span><span class="o">)</span><span class="w"> </span>
<span class="w">        </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">Seq</span><span class="p">.</span><span class="n">sortByDescending</span><span class="w"> </span><span class="o">(</span><span class="k">fun</span><span class="w"> </span><span class="o">(</span><span class="n">item</span><span class="o">,</span><span class="n">pvalAdj</span><span class="o">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">item</span><span class="o">.</span><span class="n">NumberOfDEsInBin</span><span class="o">)</span><span class="w"> </span>
<span class="w">        </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">Seq</span><span class="p">.</span><span class="n">map</span><span class="w"> </span><span class="o">(</span><span class="k">fun</span><span class="w"> </span><span class="o">(</span><span class="n">x</span><span class="o">,</span><span class="n">pvalAdj</span><span class="o">)</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">            </span><span class="c1">//TotalUnivers was renamed to TotalUniverse</span>
<span class="w">            </span><span class="o">[</span><span class="n">sprintf</span><span class="w"> </span><span class="s">"%i"</span><span class="w"> </span><span class="n">moduleNumber</span><span class="o">;</span><span class="w"> </span><span class="n">x</span><span class="o">.</span><span class="n">OntologyTerm</span><span class="o">;</span><span class="w"> </span><span class="n">sprintf</span><span class="w"> </span><span class="s">"%i"</span><span class="w"> </span><span class="n">x</span><span class="o">.</span><span class="n">TotalUnivers</span><span class="o">;</span><span class="w"> </span><span class="n">sprintf</span><span class="w"> </span><span class="s">"%i"</span><span class="w"> </span><span class="n">x</span><span class="o">.</span><span class="n">TotalNumberOfDE</span><span class="o">;</span><span class="w"> </span><span class="n">sprintf</span><span class="w"> </span><span class="s">"%i"</span><span class="w"> </span><span class="n">x</span><span class="o">.</span><span class="n">NumberInBin</span><span class="o">;</span><span class="n">sprintf</span><span class="w"> </span><span class="s">"%i"</span><span class="w"> </span><span class="n">x</span><span class="o">.</span><span class="n">NumberOfDEsInBin</span><span class="o">;</span><span class="w"> </span><span class="n">sprintf</span><span class="w"> </span><span class="s">"%f"</span><span class="n">x</span><span class="o">.</span><span class="n">PValue</span><span class="w"> </span><span class="o">;</span><span class="n">sprintf</span><span class="w"> </span><span class="s">"%f"</span><span class="w"> </span><span class="n">pvalAdj</span><span class="o">]</span>
<span class="w">            </span>
<span class="w">            </span><span class="o">)</span>
<span class="w">        </span><span class="o">)</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">Seq</span><span class="p">.</span><span class="n">choose</span><span class="o">(</span><span class="k">fun</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nn">Seq</span><span class="p">.</span><span class="n">isEmpty</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">Some</span><span class="w"> </span><span class="n">x</span><span class="o">)</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">Seq</span><span class="p">.</span><span class="n">map</span><span class="w"> </span><span class="o">(</span><span class="k">fun</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nn">List</span><span class="p">.</span><span class="n">ofSeq</span><span class="w"> </span><span class="n">x</span><span class="o">)</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">List</span><span class="p">.</span><span class="n">ofSeq</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">List</span><span class="p">.</span><span class="n">concat</span>

<span class="c1">// Build a Plotly.Net table of the ontology enrichment     </span>
<span class="k">let</span><span class="w"> </span><span class="nv">ontologyTable</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="k">let</span><span class="w"> </span><span class="nv">header</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="s">"&lt;b&gt;Community&lt;/b&gt;"</span><span class="o">;</span><span class="s">"OntologyTerm"</span><span class="o">;</span><span class="s">"TotalUniverse"</span><span class="o">;</span><span class="s">"TotalNumberOfDE"</span><span class="o">;</span><span class="s">"NumberInBin"</span><span class="o">;</span><span class="s">"NumberOfDEsInBin"</span><span class="o">;</span><span class="s">"PValue"</span><span class="o">;</span><span class="s">"pvalAdj"</span><span class="o">]</span>
<span class="w">    </span><span class="k">let</span><span class="w"> </span><span class="nv">rows</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
<span class="w">        </span><span class="n">ontologyResult</span>
<span class="w">    </span><span class="nn">Chart</span><span class="p">.</span><span class="n">Table</span><span class="o">(</span><span class="n">header</span><span class="o">,</span><span class="w"> </span><span class="n">rows</span><span class="o">)</span>

<span class="n">ontologyTable</span>
<span class="o">|&gt;</span><span class="w"> </span><span class="nn">Chart</span><span class="p">.</span><span class="n">withSize</span><span class="o">(</span><span class="mi">1300</span><span class="o">,</span><span class="mi">1000</span><span class="o">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output " data-mime-type="text/html">
<div><div></div><div></div><div><strong>Installed Packages</strong><ul><li><span>BioFSharp, 2.0.0-beta7</span></li><li><span>BioFSharp.Stats, 2.0.0-beta6</span></li></ul></div></div>
</div>

</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output " data-mime-type="text/html">
<div><div id="37cadc27-fb71-4b8c-ab0c-9033276b56f7"><!-- Plotly chart will be drawn inside this DIV --></div><script type="text/javascript">
var renderPlotly_37cadc27fb714b8cab0c9033276b56f7 = function() {
    var fsharpPlotlyRequire = requirejs.config({context:'fsharp-plotly',paths:{plotly:'https://cdn.plot.ly/plotly-2.18.1.min'}}) || require;
    fsharpPlotlyRequire(['plotly'], function(Plotly) {
        var data = [{"type":"table","cells":{"fill":{},"line":{},"values":[["2","2","2","2","6","6","6","6","6","6","7","7","8","8","9","9","10","10","10","12","15","15","15","18","18","18","19","19","19","19","19","19","19","19","19","19","19","19","20","21","21","24","27","29","29","29","29","30","30","30","32","32","32","32"],["dipeptidase activity [GO:0016805]","para-aminobenzoyl-glutamate hydrolase activity [GO:0071713]","protein heterodimerization activity [GO:0046982]","citrate (pro-3S)-lyase activity [GO:0008815]","cytochrome bo3 ubiquinol oxidase activity [GO:0009486]","electron transfer activity [GO:0009055]","oxidoreduction-driven active transmembrane transporter activity [GO:0015453]","proton transmembrane transporter activity [GO:0015078]","cytochrome-c oxidase activity [GO:0004129]","cytochrome o ubiquinol oxidase activity [GO:0008827]","thioredoxin peroxidase activity [GO:0008379]","carboxypeptidase activity [GO:0004180]","L-arabinose transmembrane transporter activity [GO:0015147]","RNA binding [GO:0003723]","succinate-semialdehyde dehydrogenase (NAD+) activity [GO:0004777]","dipeptide transmembrane transporter activity [GO:0071916]","ATP binding [GO:0005524]","zinc ion binding [GO:0008270]","S-adenosyl-L-methionine binding [GO:1904047]","phosphorelay response regulator activity [GO:0000156]","identical protein binding [GO:0042802]","DNA-binding transcription activator activity [GO:0001216]","bacterial-type cis-regulatory region sequence-specific DNA binding [GO:0000986]","cytochrome bo3 ubiquinol oxidase activity [GO:0009486]","electron transfer activity [GO:0009055]","oxidoreductase activity, acting on diphenols and related substances as donors, oxygen as acceptor [GO:0016682]","pyridoxal phosphate binding [GO:0030170]","amino acid binding [GO:0016597]","ABC-type sulfate transporter activity [GO:0015419]","3-deoxy-7-phosphoheptulonate synthase activity [GO:0003849]","arginine binding [GO:0034618]","NAD binding [GO:0051287]","ornithine carbamoyltransferase activity [GO:0004585]","carbamoyl-phosphate synthase (glutamine-hydrolyzing) activity [GO:0004088]","sulfate adenylyltransferase (ATP) activity [GO:0004781]","sulfite reductase (NADPH) activity [GO:0004783]","cysteine synthase activity [GO:0004124]","L-cysteine desulfhydrase activity [GO:0080146]","","proton-transporting ATP synthase activity, rotational mechanism [GO:0046933]","proton-transporting ATPase activity, rotational mechanism [GO:0046961]","betaine-aldehyde dehydrogenase activity [GO:0008802]","","DNA binding [GO:0003677]","nucleic acid binding [GO:0003676]","RNA binding [GO:0003723]","transcription antitermination factor activity, RNA binding [GO:0001072]","copper ion binding [GO:0005507]","copper ion transmembrane transporter activity [GO:0005375]","transition metal ion binding [GO:0046914]","metal ion binding [GO:0046872]","electron transfer activity [GO:0009055]","oxidoreductase activity, acting on diphenols and related substances as donors, oxygen as acceptor [GO:0016682]","heme binding [GO:0020037]"],["483","483","483","483","483","483","483","483","483","483","483","483","483","483","483","483","483","483","483","483","483","483","483","483","483","483","483","483","483","483","483","483","483","483","483","483","483","483","483","483","483","483","483","483","483","483","483","483","483","483","483","483","483","483"],["25","25","25","25","28","28","28","28","28","28","67","67","30","30","21","21","21","21","21","16","18","18","18","10","10","10","83","83","83","83","83","83","83","83","83","83","83","83","2","12","12","10","5","8","8","8","8","23","23","23","8","8","8","8"],["3","2","2","2","6","11","4","4","3","3","2","2","2","4","2","2","43","12","2","5","41","5","2","6","11","6","12","6","4","3","2","3","2","2","2","2","2","2","26","8","6","2","26","10","5","4","3","9","3","2","22","11","6","7"],["2","2","2","2","4","4","4","4","3","3","2","2","2","2","2","2","5","3","2","2","5","2","2","2","2","2","6","4","4","3","2","2","2","2","2","2","2","2","2","5","4","2","2","2","2","2","2","4","3","2","2","2","2","2"],["0.003804","0.001289","0.001289","0.001289","0.000126","0.002266","0.000005","0.000005","0.000088","0.000088","0.009497","0.009497","0.001869","0.010776","0.000902","0.000902","0.030611","0.012132","0.000902","0.005004","0.012905","0.006353","0.000657","0.005546","0.019231","0.005546","0.008384","0.009281","0.000410","0.002462","0.014617","0.041390","0.014617","0.014617","0.014617","0.014617","0.014617","0.014617","0.002792","0.000000","0.000003","0.000193","0.025233","0.010124","0.001188","0.000716","0.000359","0.000424","0.000047","0.001087","0.046983","0.012270","0.003490","0.004845"],["0.006657","0.003007","0.003007","0.003007","0.000177","0.002643","0.000016","0.000016","0.000154","0.000154","0.071229","0.071229","0.005606","0.016164","0.002706","0.002706","0.051018","0.030330","0.004510","0.010009","0.017207","0.012707","0.002629","0.011092","0.025642","0.011092","0.026577","0.026577","0.008205","0.024615","0.026577","0.068984","0.026577","0.026577","0.026577","0.026577","0.026577","0.026577","0.002792","0.000000","0.000003","0.000193","0.025233","0.010124","0.001584","0.001431","0.001431","0.000636","0.000142","0.001087","0.046983","0.016360","0.009689","0.009689"]]},"header":{"fill":{},"line":{},"values":["<b>Community</b>","OntologyTerm","TotalUniverse","TotalNumberOfDE","NumberInBin","NumberOfDEsInBin","PValue","pvalAdj"]}}];
        var layout = {"width":1300,"height":1000,"template":{"layout":{"title":{"x":0.05},"font":{"color":"rgba(42, 63, 95, 1.0)"},"paper_bgcolor":"rgba(255, 255, 255, 1.0)","plot_bgcolor":"rgba(229, 236, 246, 1.0)","autotypenumbers":"strict","colorscale":{"diverging":[[0.0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1.0,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"hovermode":"closest","hoverlabel":{"align":"left"},"coloraxis":{"colorbar":{"outlinewidth":0.0,"ticks":""}},"geo":{"showland":true,"landcolor":"rgba(229, 236, 246, 1.0)","showlakes":true,"lakecolor":"rgba(255, 255, 255, 1.0)","subunitcolor":"rgba(255, 255, 255, 1.0)","bgcolor":"rgba(255, 255, 255, 1.0)"},"mapbox":{"style":"light"},"polar":{"bgcolor":"rgba(229, 236, 246, 1.0)","radialaxis":{"linecolor":"rgba(255, 255, 255, 1.0)","gridcolor":"rgba(255, 255, 255, 1.0)","ticks":""},"angularaxis":{"linecolor":"rgba(255, 255, 255, 1.0)","gridcolor":"rgba(255, 255, 255, 1.0)","ticks":""}},"scene":{"xaxis":{"ticks":"","linecolor":"rgba(255, 255, 255, 1.0)","gridcolor":"rgba(255, 255, 255, 1.0)","gridwidth":2.0,"zerolinecolor":"rgba(255, 255, 255, 1.0)","backgroundcolor":"rgba(229, 236, 246, 1.0)","showbackground":true},"yaxis":{"ticks":"","linecolor":"rgba(255, 255, 255, 1.0)","gridcolor":"rgba(255, 255, 255, 1.0)","gridwidth":2.0,"zerolinecolor":"rgba(255, 255, 255, 1.0)","backgroundcolor":"rgba(229, 236, 246, 1.0)","showbackground":true},"zaxis":{"ticks":"","linecolor":"rgba(255, 255, 255, 1.0)","gridcolor":"rgba(255, 255, 255, 1.0)","gridwidth":2.0,"zerolinecolor":"rgba(255, 255, 255, 1.0)","backgroundcolor":"rgba(229, 236, 246, 1.0)","showbackground":true}},"ternary":{"aaxis":{"ticks":"","linecolor":"rgba(255, 255, 255, 1.0)","gridcolor":"rgba(255, 255, 255, 1.0)"},"baxis":{"ticks":"","linecolor":"rgba(255, 255, 255, 1.0)","gridcolor":"rgba(255, 255, 255, 1.0)"},"caxis":{"ticks":"","linecolor":"rgba(255, 255, 255, 1.0)","gridcolor":"rgba(255, 255, 255, 1.0)"},"bgcolor":"rgba(229, 236, 246, 1.0)"},"xaxis":{"title":{"standoff":15},"ticks":"","automargin":"height+width+left+right+top+bottom","linecolor":"rgba(255, 255, 255, 1.0)","gridcolor":"rgba(255, 255, 255, 1.0)","zerolinecolor":"rgba(255, 255, 255, 1.0)","zerolinewidth":2.0},"yaxis":{"title":{"standoff":15},"ticks":"","automargin":"height+width+left+right+top+bottom","linecolor":"rgba(255, 255, 255, 1.0)","gridcolor":"rgba(255, 255, 255, 1.0)","zerolinecolor":"rgba(255, 255, 255, 1.0)","zerolinewidth":2.0},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"shapedefaults":{"line":{"color":"rgba(42, 63, 95, 1.0)"}},"colorway":["rgba(99, 110, 250, 1.0)","rgba(239, 85, 59, 1.0)","rgba(0, 204, 150, 1.0)","rgba(171, 99, 250, 1.0)","rgba(255, 161, 90, 1.0)","rgba(25, 211, 243, 1.0)","rgba(255, 102, 146, 1.0)","rgba(182, 232, 128, 1.0)","rgba(255, 151, 255, 1.0)","rgba(254, 203, 82, 1.0)"]},"data":{"bar":[{"marker":{"line":{"color":"rgba(229, 236, 246, 1.0)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"error_x":{"color":"rgba(42, 63, 95, 1.0)"},"error_y":{"color":"rgba(42, 63, 95, 1.0)"}}],"barpolar":[{"marker":{"line":{"color":"rgba(229, 236, 246, 1.0)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}}}],"carpet":[{"aaxis":{"linecolor":"rgba(255, 255, 255, 1.0)","gridcolor":"rgba(255, 255, 255, 1.0)","endlinecolor":"rgba(42, 63, 95, 1.0)","minorgridcolor":"rgba(255, 255, 255, 1.0)","startlinecolor":"rgba(42, 63, 95, 1.0)"},"baxis":{"linecolor":"rgba(255, 255, 255, 1.0)","gridcolor":"rgba(255, 255, 255, 1.0)","endlinecolor":"rgba(42, 63, 95, 1.0)","minorgridcolor":"rgba(255, 255, 255, 1.0)","startlinecolor":"rgba(42, 63, 95, 1.0)"}}],"choropleth":[{"colorbar":{"outlinewidth":0.0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contour":[{"colorbar":{"outlinewidth":0.0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"colorbar":{"outlinewidth":0.0,"ticks":""}}],"heatmap":[{"colorbar":{"outlinewidth":0.0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"colorbar":{"outlinewidth":0.0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}}}],"histogram2d":[{"colorbar":{"outlinewidth":0.0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0.0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"colorbar":{"outlinewidth":0.0,"ticks":""}}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0.0,"ticks":""}}}],"pie":[{"automargin":true}],"scatter":[{"marker":{"colorbar":{"outlinewidth":0.0,"ticks":""}}}],"scatter3d":[{"marker":{"colorbar":{"outlinewidth":0.0,"ticks":""}},"line":{"colorbar":{"outlinewidth":0.0,"ticks":""}}}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0.0,"ticks":""}}}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0.0,"ticks":""}}}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0.0,"ticks":""}}}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0.0,"ticks":""}}}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0.0,"ticks":""}}}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0.0,"ticks":""}}}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0.0,"ticks":""}}}],"surface":[{"colorbar":{"outlinewidth":0.0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"table":[{"cells":{"fill":{"color":"rgba(235, 240, 248, 1.0)"},"line":{"color":"rgba(255, 255, 255, 1.0)"}},"header":{"fill":{"color":"rgba(200, 212, 227, 1.0)"},"line":{"color":"rgba(255, 255, 255, 1.0)"}}}]}}};
        var config = {"responsive":true};
        Plotly.newPlot('37cadc27-fb71-4b8c-ab0c-9033276b56f7', data, layout, config);
    });
};
if ((typeof(requirejs) !==  typeof(Function)) || (typeof(requirejs.config) !== typeof(Function))) {
    var script = document.createElement("script");
    script.setAttribute("src", "https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js");
    script.onload = function(){
        renderPlotly_37cadc27fb714b8cab0c9033276b56f7();
    };
    document.getElementsByTagName("head")[0].appendChild(script);
}
else {
    renderPlotly_37cadc27fb714b8cab0c9033276b56f7();
}
</script></div>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>From the table above I have chosen to show community 30 as an example of the differences between community detection and PCA.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[18]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-F#"><pre><span></span><span class="k">let</span><span class="w"> </span><span class="nv">cytoVerticesOntology</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="nn">Array</span><span class="p">.</span><span class="n">map2</span><span class="w"> </span><span class="o">(</span><span class="k">fun</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">(</span><span class="n">v</span><span class="o">,</span><span class="n">l</span><span class="o">))</span><span class="w"> </span><span class="o">(</span><span class="n">louvainGraph</span><span class="o">.</span><span class="n">GetVertices</span><span class="bp">()</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="nn">Vertices</span><span class="p">.</span><span class="n">getLabelList</span><span class="w"> </span><span class="n">louvainGraph</span><span class="o">)</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">List</span><span class="p">.</span><span class="n">ofArray</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">List</span><span class="p">.</span><span class="n">map</span><span class="o">(</span><span class="k">fun</span><span class="w"> </span><span class="o">(</span><span class="n">v</span><span class="o">,(</span><span class="n">l</span><span class="o">,</span><span class="n">c</span><span class="o">))</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">        </span><span class="k">let</span><span class="w"> </span><span class="nv">styling</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="nn">CyParam</span><span class="p">.</span><span class="n">label</span><span class="w"> </span><span class="n">l</span><span class="o">;</span><span class="k">if</span><span class="w"> </span><span class="n">c</span><span class="o">=</span><span class="mi">30</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="nn">CyParam</span><span class="p">.</span><span class="n">color</span><span class="w"> </span><span class="o">(</span><span class="n">colorMap</span><span class="o">.</span><span class="n">Item</span><span class="w"> </span><span class="o">(</span><span class="n">c</span><span class="o">));</span><span class="nn">CyParam</span><span class="p">.</span><span class="n">weight</span><span class="w"> </span><span class="o">(</span><span class="n">sqrt</span><span class="w"> </span><span class="o">(</span><span class="kt">float</span><span class="w"> </span><span class="o">(</span><span class="n">louvainGraph</span><span class="o">.</span><span class="n">Degree</span><span class="w"> </span><span class="n">v</span><span class="o">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="o">.</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="o">(*)</span><span class="w"> </span><span class="mi">10</span><span class="o">.)]</span>
<span class="w">        </span><span class="o">(</span><span class="nn">Elements</span><span class="p">.</span><span class="n">node</span><span class="w"> </span><span class="o">(</span><span class="kt">string</span><span class="w"> </span><span class="n">v</span><span class="o">)</span><span class="w"> </span><span class="n">styling</span><span class="o">)</span>

<span class="w">    </span><span class="o">)</span>
<span class="k">let</span><span class="w"> </span><span class="nv">cytoGraphOntology</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>

<span class="w">    </span><span class="nn">CyGraph</span><span class="p">.</span><span class="n">initEmpty</span><span class="w"> </span><span class="bp">()</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">CyGraph</span><span class="p">.</span><span class="n">withElements</span><span class="w"> </span><span class="n">cytoVerticesOntology</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">CyGraph</span><span class="p">.</span><span class="n">withElements</span><span class="w"> </span><span class="n">cytoEdges</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">CyGraph</span><span class="p">.</span><span class="n">withStyle</span><span class="w"> </span><span class="s">"node"</span><span class="w"> </span>
<span class="w">        </span><span class="o">[</span>
<span class="w">            </span><span class="nn">CyParam</span><span class="p">.</span><span class="n">shape</span><span class="w"> </span><span class="s">"circle"</span>
<span class="w">            </span><span class="nn">CyParam</span><span class="p">.</span><span class="n">content</span><span class="w"> </span><span class="o">=.</span><span class="w"> </span><span class="nn">CyParam</span><span class="p">.</span><span class="n">label</span>
<span class="w">            </span><span class="nn">CyParam</span><span class="p">.</span><span class="n">width</span><span class="w"> </span><span class="o">=.</span><span class="w"> </span><span class="nn">CyParam</span><span class="p">.</span><span class="n">weight</span>
<span class="w">            </span><span class="nn">CyParam</span><span class="p">.</span><span class="n">height</span><span class="w"> </span><span class="o">=.</span><span class="w"> </span><span class="nn">CyParam</span><span class="p">.</span><span class="n">weight</span>
<span class="w">            </span><span class="nn">CyParam</span><span class="p">.</span><span class="nn">Text</span><span class="p">.</span><span class="nn">Align</span><span class="p">.</span><span class="n">center</span>
<span class="w">            </span><span class="nn">CyParam</span><span class="p">.</span><span class="nn">Border</span><span class="p">.</span><span class="n">color</span><span class="w"> </span><span class="o">=.</span><span class="w"> </span><span class="nn">CyParam</span><span class="p">.</span><span class="n">color</span>
<span class="w">            </span><span class="nn">CyParam</span><span class="p">.</span><span class="nn">Background</span><span class="p">.</span><span class="n">color</span><span class="w"> </span><span class="o">=.</span><span class="w"> </span><span class="nn">CyParam</span><span class="p">.</span><span class="n">color</span>
<span class="w">        </span><span class="o">]</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">CyGraph</span><span class="p">.</span><span class="n">withStyle</span><span class="w"> </span><span class="s">"edge"</span><span class="w"> </span>
<span class="w">        </span><span class="o">[</span>
<span class="w">            </span><span class="nn">CyParam</span><span class="p">.</span><span class="nn">Line</span><span class="p">.</span><span class="n">color</span><span class="w"> </span><span class="s">"#3D1244"</span>
<span class="w">        </span><span class="o">]</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nn">CyGraph</span><span class="p">.</span><span class="n">withLayout</span><span class="w"> </span><span class="o">(</span><span class="nn">Layout</span><span class="p">.</span><span class="n">initCose</span><span class="w"> </span><span class="o">(</span><span class="nn">Layout</span><span class="p">.</span><span class="nn">LayoutOptions</span><span class="p">.</span><span class="n">Cose</span><span class="o">(</span><span class="n">NodeOverlap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">400</span><span class="o">,</span><span class="n">ComponentSpacing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span><span class="o">)))</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p><img src="https://csbiology.github.io/CSBlog/img/communityVsPCA.jpg" alt="Community detection vs PCA"></p>
<p>While comparing community 30 with its PCA counterpart it becomes apparent 
that this functional group would not have been detected based on clustering of the PCA.
This does not mean that the PCA is without its merits, but merely show that 
the application of different approached to datasets can and will deliver different results.
The combination and comparison between different methods is an important step in data evaluation 
and should always be considered when thinking about your dataflow.</p>
<h2 id="Further-reading">Further reading<a class="anchor-link" href="#Further-reading">&#182;</a></h2><ul>
<li><a href="https://doi.org/10.1088%2F1742-5468%2F2008%2F10%2FP10008">Blondel, Vincent D; Guillaume, Jean-Loup; Lambiotte, Renaud; Lefebvre, Etienne (9 October 2008). "Fast unfolding of communities in large networks". Journal of Statistical Mechanics: Theory and Experiment. 2008 (10): P10008. arXiv:0803.0476. Bibcode:2008JSMTE..10..008B. doi:10.1088/1742-5468/2008/10/P10008. S2CID 334423</a></li>
<li><a href="https://fslab.org">Fslab</a></li>
<li><a href="https://github.com/CSBiology/FSharp.FGL">FSharp.FGL</a></li>
</ul>

</div>
</div>
</div>
</div>

        </div>
        <footer class="footer is-dark">
          <div class="container">
            <div class="columns">
              <div class="column is-4">
                <div class="block">
                  <h3 class="subtitle is-white">
                    CSB - Computational Systems Biology
                  </h3>
                </div>
                <div class="block">
                  <p>
                    CSB is the department of 
                    <a href="https://csb.bio.uni-kl.de/" class="footer-link">
                      Prof. Dr. Timo Mühlhaus
                    </a>
                     at 
                    <a href="https://rptu.de/" class="footer-link">
                      RPTU Kaiserslauern.
                    </a>
                  </p>
                </div>
                <div class="block">
                  <p>
                    This website is mainly intended for internal purposes. It is maintained by members of the department.
                  </p>
                </div>
                <div class="block">
                  <div class="is-white">
                    <span class="icon">
                      <i class="fas fa-code-branch"></i>
                    </span>
                    <a class="footer-link" href="https://github.com/CSBiology/CSBlog">
                      website source code
                    </a>
                  </div>
                  <div class="is-white">
                    <span class="icon">
                      <i class="far fa-handshake"></i>
                    </span>
                    <a class="footer-link" href="https://github.com/orgs/CSBiology/people">
                      csb contributors
                    </a>
                  </div>
                </div>
              </div>
              <div class="column is-4">
                <div class="block">
                  <h3 class="subtitle is-white">
                    CSB projects
                  </h3>
                </div>
                <div class="block">
                  <div class="is-white">
                    <span class="icon">
                      <i class="fab fa-github"></i>
                    </span>
                    <a class="footer-link" href="https://github.com/CSBiology">
                      the csb organisation on github
                    </a>
                  </div>
                </div>
                <div class="block">
                  <div class="is-white">
                    <span class="icon">
                      <i class="fab fa-github"></i>
                    </span>
                    <a class="footer-link" href="https://github.com/CSBiology/BioFSharp">
                      BioFSharp - Computational Biology toolkit
                    </a>
                  </div>
                  <div class="is-white">
                    <span class="icon">
                      <i class="fab fa-github"></i>
                    </span>
                    <a class="footer-link" href="https://github.com/CSBiology/ProteomIQon">
                      ProteomIQon - Computational Protemics toolkit
                    </a>
                  </div>
                  <div class="is-white">
                    <span class="icon">
                      <i class="fab fa-github"></i>
                    </span>
                    <a class="footer-link" href="https://github.com/CSBiology/FsSpreadsheet">
                      FsSpreadsheet - Multi-target Spreadsheet datamodel
                    </a>
                  </div>
                  <div class="is-white">
                    <span class="icon">
                      <i class="fab fa-github"></i>
                    </span>
                    <a class="footer-link" href="https://github.com/CSBiology/DynamicObj">
                      DynamicObj - System.Dynamic for F#
                    </a>
                  </div>
                  <div class="is-white">
                    <span class="icon">
                      <i class="fab fa-github"></i>
                    </span>
                    <a class="footer-link" href="https://github.com/CSBiology/FSharpAux">
                      FSharpAux - Auxiliary functions for F#
                    </a>
                  </div>
                </div>
                <div class="block">
                  <h3 class="subtitle is-white">
                    These projects are originally CSB projects
                  </h3>
                </div>
                <div class="block">
                  <div class="is-white">
                    <span class="icon">
                      <i class="fab fa-github"></i>
                    </span>
                    <a class="footer-link" href="https://github.com/plotly/Plotly.NET">
                      Plotly.NET - .NET graphing library
                    </a>
                  </div>
                  <div class="is-white">
                    <span class="icon">
                      <i class="fab fa-github"></i>
                    </span>
                    <a class="footer-link" href="https://github.com/fslaborg/FSharp.Stats">
                      FSharp.Stats - datascience in F#
                    </a>
                  </div>
                </div>
              </div>
              <div class="column is-4">
                <div class="block">
                  <h3 class="subtitle is-white">
                    Further reading and partner projects
                  </h3>
                </div>
                <div class="block">
                  <div class="is-white">
                    <span class="icon">
                      <i class="fas fa-vial"></i>
                    </span>
                    <a class="footer-link" href="https://fslab.org">
                      FsLab - the F# data science stack
                    </a>
                  </div>
                </div>
                <div class="block">
                  <div class="is-white">
                    <span class="icon">
                      <i class="fas fa-graduation-cap"></i>
                    </span>
                    <a class="footer-link" href="https://csb.bio.uni-kl.de/#teaching">
                      CSB teaching materials
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </footer>
      </div>
    </div>
  </body>
</html>