<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>q values</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="author" content="">
    <link rel="shortcut icon" type="image/x-icon" href="/CSBlog//img/favicon.ico">
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <!-- <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script> -->

    <link type="text/css" rel="stylesheet" href="/CSBlog/content/fsdocs-default.css" />
    <link type="text/css" rel="stylesheet" href="/CSBlog/content/fsdocs-custom.css" />
    <script type="text/javascript" src="/CSBlog/content/fsdocs-tips.js"></script>
    <script type="text/javascript" src="/CSBlog/content/init.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@creativebulma/bulma-collapsible@1.0.4/dist/js/bulma-collapsible.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@creativebulma/bulma-collapsible@1.0.4/dist/css/bulma-collapsible.min.css">
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!-- BEGIN SEARCH BOX: this adds support for the search box -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/JavaScript-autoComplete/1.0.4/auto-complete.css" />
    <!-- END SEARCH BOX: this adds support for the search box -->
    
</head> 

<body>
    <div class="columns is-fullheight m-0">
        <div id="fsdocs-menu" class="column is-2 is-paddingless">
            <aside class="menu">
                <div class="container is-paddingless is-marginless has-background-dark">
                    <a href="/CSBlog/">
                        <figure class="image is-128x128 container">
                            <img src="/CSBlog/img/logo.png">
                        </figure>
                    </a>
                    <h2 class="title has-text-centered has-text-white pb-4">CSBlog</h2>
                </div>
                <div class="content">
                    <!-- BEGIN SEARCH BOX: this adds support for the search box -->
                    <div id="header">
                        <div class="field">
                            <div class="control has-icons-left has-icons-right searchbox" id="fsdocs-searchbox">
                                <input data-search-input="" id="search-by" type="search" placeholder="Search..." class="input"/>
                                <span class="icon is-small is-left">
                                    <i class="fas fa-search"></i>
                                </span>
                            </div>
                        </div>
                    </div>
                    <!-- END SEARCH BOX: this adds support for the search box -->
                    <ul class="navbar-nav">
                        <li class="nav-header">
  Overview
</li>             
<li class="nav-item">
  <a class="nav-link" href="/CSBlog/posts/about.html">
    About
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="/CSBlog/posts/blogposts_overview.html">
    BlogPosts
  </a>
</li>             
<li class="nav-header">
  Documentation
</li>             
<li class="nav-item">
  <a class="nav-link" href="/CSBlog/posts/documentation.html">
    Creating a Documentation
  </a>
</li>             
<li class="nav-header">
  Visualization
</li>             
<li class="nav-item">
  <a class="nav-link" href="/CSBlog/posts/WorkshopSeries_3_plotly.html">
    Introduction to Data visualization using Plotly.NET
  </a>
</li>             
<li class="nav-header">
  Implementation
</li>             
<li class="nav-item">
  <a class="nav-link" href="/CSBlog/posts/0_how2JSONSchema.html">
    How to develop and use a JSON Schema
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="/CSBlog/posts/1_how2Fable.html">
    How to use Fable
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="/CSBlog/posts/3_sequence_features.html">
    Modelling and visualizing sequence features with BioFSharp and Plotly.NET
  </a>
</li>             
<li class="nav-header">
  Learning resources
</li>             
<li class="nav-item">
  <a class="nav-link" href="/CSBlog/posts/4_qvalues.html">
    q values
  </a>
</li>             
<li class="nav-header">
  CSBar Reports
</li>             
<li class="nav-item">
  <a class="nav-link" href="/CSBlog/posts/CoffeeReport1.html">
    CSBar Report 1
  </a>
</li>
                    </ul>
                </div>
            </aside>
        </div>
        <div class="column is-10 is-paddingless">
            <div class="section pt-4">
                <div class="container" id="fsdocs-content">
                    
67.5
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs5', 5)" onmouseover="showTip(event, 'fs5', 5)" class="id">te</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs3', 6)" onmouseover="showTip(event, 'fs3', 6)" class="m">Seq</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs4', 7)" onmouseover="showTip(event, 'fs4', 7)" class="id">mean</span> <span class="pn">[</span><span class="n">123.</span><span class="pn">;</span><span class="n">12.</span><span class="pn">]</span>
</code></pre>
<table class="pre"><tr><td><pre><code>67.5</code></pre></td></tr></table>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs6', 8)" onmouseover="showTip(event, 'fs6', 8)" class="id">te2</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs3', 9)" onmouseover="showTip(event, 'fs3', 9)" class="m">Seq</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs7', 10)" onmouseover="showTip(event, 'fs7', 10)" class="id">average</span> <span class="pn">[</span><span class="n">123.</span><span class="pn">;</span><span class="n">12.</span><span class="pn">]</span>
</code></pre>
<table class="pre"><tr><td><pre><code>67.5</code></pre></td></tr></table>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">open</span> <span class="id">Plotly</span><span class="pn">.</span><span class="id">NET</span>
<span class="k">open</span> <span class="id">Plotly</span><span class="pn">.</span><span class="id">NET</span><span class="pn">.</span><span class="id">StyleParam</span>
<span class="k">open</span> <span class="id">Plotly</span><span class="pn">.</span><span class="id">NET</span><span class="pn">.</span><span class="id">LayoutObjects</span>



<span class="k">module</span> <span class="m">Chart</span> <span class="o">=</span> 

    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs8', 11)" onmouseover="showTip(event, 'fs8', 11)" class="fn">myAxis</span> <span onmouseout="hideTip(event, 'fs9', 12)" onmouseover="showTip(event, 'fs9', 12)" class="fn">name</span> <span class="o">=</span> <span class="id">LinearAxis</span><span class="pn">.</span><span class="id">init</span><span class="pn">(</span><span class="id">Title</span><span class="o">=</span><span class="id">Title</span><span class="pn">.</span><span class="id">init</span> <span onmouseout="hideTip(event, 'fs9', 13)" onmouseover="showTip(event, 'fs9', 13)" class="id">name</span><span class="pn">,</span><span class="id">Mirror</span><span class="o">=</span><span class="id">StyleParam</span><span class="pn">.</span><span class="id">Mirror</span><span class="pn">.</span><span class="id">All</span><span class="pn">,</span><span class="id">Ticks</span><span class="o">=</span><span class="id">StyleParam</span><span class="pn">.</span><span class="id">TickOptions</span><span class="pn">.</span><span class="id">Inside</span><span class="pn">,</span><span class="id">ShowGrid</span><span class="o">=</span><span class="k">false</span><span class="pn">,</span><span class="id">ShowLine</span><span class="o">=</span><span class="k">true</span><span class="pn">)</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs10', 14)" onmouseover="showTip(event, 'fs10', 14)" class="fn">withAxisTitles</span> <span onmouseout="hideTip(event, 'fs11', 15)" onmouseover="showTip(event, 'fs11', 15)" class="fn">x</span> <span onmouseout="hideTip(event, 'fs12', 16)" onmouseover="showTip(event, 'fs12', 16)" class="fn">y</span> <span onmouseout="hideTip(event, 'fs13', 17)" onmouseover="showTip(event, 'fs13', 17)" class="fn">chart</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs13', 18)" onmouseover="showTip(event, 'fs13', 18)" class="fn">chart</span> <span class="o">|&gt;</span> <span class="id">Chart</span><span class="pn">.</span><span class="id">withXAxis</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs8', 19)" onmouseover="showTip(event, 'fs8', 19)" class="id">myAxis</span> <span onmouseout="hideTip(event, 'fs11', 20)" onmouseover="showTip(event, 'fs11', 20)" class="id">x</span><span class="pn">)</span> <span class="o">|&gt;</span> <span class="id">Chart</span><span class="pn">.</span><span class="id">withYAxis</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs8', 21)" onmouseover="showTip(event, 'fs8', 21)" class="id">myAxis</span> <span onmouseout="hideTip(event, 'fs12', 22)" onmouseover="showTip(event, 'fs12', 22)" class="id">y</span><span class="pn">)</span>
    
</code></pre>
<h1><a name="q-values" class="anchor" href="#q-values">q values</a></h1>
<p><em><a href="https://github.com/bvenn">Benedikt Venn</a>, Jan 2022</em></p>
<h3><a name="Table-of-contents" class="anchor" href="#Table-of-contents">Table of contents</a></h3>
<ul>
<li><a href="#Introduction">Introduction</a></li>
<li><a href="#The-multiple-testing-problem">The multiple testing problem</a></li>
<li>
<a href="#False-discovery-rate">False discovery rate</a>
<ul>
<li><a href="#q-values">q values</a></li>
</ul>
</li>
<li><a href="#Quality-plots">Quality plots</a></li>
<li><a href="#Definitions-and-Notes">Definitions and Notes</a></li>
<li><a href="#References">References</a></li>
</ul>
<h2><a name="Introduction" class="anchor" href="#Introduction">Introduction</a></h2>
<b>High throughput techniques</b> like microarrays with its successor RNA-Seq and mass spectrometry proteomics lead to an huge data amount.
Thousands of features (e.g. transcripts or proteins) are measured simultaneously. <b>Differential expression analysis</b> aims to identify features, that change significantly
between two conditions. A common experimental setup is the analysis of which genes are over- or underexpressed between e.g. a wild type and a mutant.
<p>Hypothesis tests aim to identify differences between two or more samples. The most common statistical test is the <b>t test</b> that tests a difference of means. Hypothesis tests report
a p value, that correspond the probability of obtaining results at least as extreme as the observed results, assuming that the null hypothesis is correct. In other words:</p>
<p><em><center>If there is no effect (no mean difference), a p value of 0.05 indicates that in 5 % of the tests a false positive is reported.</center></em></p>
<hr>
<p>Consider two population distributions that follow a normal distribution. Both have the <b>same</b> mean and standard deviation.</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs14', 23)" onmouseover="showTip(event, 'fs14', 23)" class="id">list</span> <span class="o">=</span> <span class="pn">[</span><span class="n">1</span><span class="pn">,</span><span class="n">2</span><span class="pn">;</span><span class="n">1</span><span class="pn">,</span><span class="n">3</span><span class="pn">]</span>

<span onmouseout="hideTip(event, 'fs14', 24)" onmouseover="showTip(event, 'fs14', 24)" class="id">list</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs15', 25)" onmouseover="showTip(event, 'fs15', 25)" class="m">Chart</span><span class="pn">.</span><span class="id">Line</span> <span class="o">|&gt;</span> <span class="id">GenericChart</span><span class="pn">.</span><span class="id">toChartHTML</span>
</code></pre>
<div id="34f5eb81-49f1-4255-bccd-ea9e41aff192" style="width: 600px; height: 600px;"><!-- Plotly chart will be drawn inside this DIV --></div>
<script type="text/javascript">

            var renderPlotly_34f5eb8149f14255bccdea9e41aff192 = function() {
            var fsharpPlotlyRequire = requirejs.config({context:'fsharp-plotly',paths:{plotly:'https://cdn.plot.ly/plotly-latest.min'}}) || require;
            fsharpPlotlyRequire(['plotly'], function(Plotly) {

            var data = [{"type":"scatter","x":[1,1],"y":[2,3],"mode":"lines","marker":{}}];
            var layout = {};
            var config = {};
            Plotly.newPlot('34f5eb81-49f1-4255-bccd-ea9e41aff192', data, layout, config);
});
            };
            if ((typeof(requirejs) !==  typeof(Function)) || (typeof(requirejs.config) !== typeof(Function))) {
                var script = document.createElement("script");
                script.setAttribute("src", "https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js");
                script.onload = function(){
                    renderPlotly_34f5eb8149f14255bccdea9e41aff192();
                };
                document.getElementsByTagName("head")[0].appendChild(script);
            }
            else {
                renderPlotly_34f5eb8149f14255bccdea9e41aff192();
            }
</script>

<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">open</span> <span onmouseout="hideTip(event, 'fs16', 26)" onmouseover="showTip(event, 'fs16', 26)" class="id">FSharpAux</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 27)" onmouseover="showTip(event, 'fs1', 27)" class="id">FSharp</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs2', 28)" onmouseover="showTip(event, 'fs2', 28)" class="id">Stats</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 29)" onmouseover="showTip(event, 'fs1', 29)" class="id">FSharp</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs2', 30)" onmouseover="showTip(event, 'fs2', 30)" class="id">Stats</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs17', 31)" onmouseover="showTip(event, 'fs17', 31)" class="id">Distributions</span>


<span class="k">let</span> <span onmouseout="hideTip(event, 'fs18', 32)" onmouseover="showTip(event, 'fs18', 32)" class="id">distributionA</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs19', 33)" onmouseover="showTip(event, 'fs19', 33)" class="m">Continuous</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs20', 34)" onmouseover="showTip(event, 'fs20', 34)" class="id">normal</span> <span class="n">10.0</span> <span class="n">1.0</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs21', 35)" onmouseover="showTip(event, 'fs21', 35)" class="id">distributionB</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs19', 36)" onmouseover="showTip(event, 'fs19', 36)" class="m">Continuous</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs20', 37)" onmouseover="showTip(event, 'fs20', 37)" class="id">normal</span> <span class="n">10.0</span> <span class="n">1.0</span>
</code></pre>
<table class="pre"><tr><td><pre><code>No value returned by any evaluator</code></pre></td></tr></table>
<p>Samples with sample size 5 are randomly drawn from both population distributions.
Both samples are tested <b>if a mean difference exist</b> using a two sample t test where equal variances of the underlying population distribution are assumed.</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs26', 55)" onmouseover="showTip(event, 'fs26', 55)" class="fn">getSample</span> <span onmouseout="hideTip(event, 'fs27', 56)" onmouseover="showTip(event, 'fs27', 56)" class="fn">n</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs28', 57)" onmouseover="showTip(event, 'fs28', 57)" class="fn">dist</span><span class="pn">:</span> <span onmouseout="hideTip(event, 'fs17', 58)" onmouseover="showTip(event, 'fs17', 58)" class="id">Distributions</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs29', 59)" onmouseover="showTip(event, 'fs29', 59)" class="id">Distribution</span><span class="pn">&lt;</span><span onmouseout="hideTip(event, 'fs30', 60)" onmouseover="showTip(event, 'fs30', 60)" class="vt">float</span><span class="pn">,</span><span onmouseout="hideTip(event, 'fs30', 61)" onmouseover="showTip(event, 'fs30', 61)" class="vt">float</span><span class="pn">&gt;</span><span class="pn">)</span> <span class="o">=</span>
    <span onmouseout="hideTip(event, 'fs31', 62)" onmouseover="showTip(event, 'fs31', 62)" class="m">Vector</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs32', 63)" onmouseover="showTip(event, 'fs32', 63)" class="id">init</span> <span onmouseout="hideTip(event, 'fs27', 64)" onmouseover="showTip(event, 'fs27', 64)" class="fn">n</span> <span class="pn">(</span><span class="k">fun</span> <span class="id">_</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs28', 65)" onmouseover="showTip(event, 'fs28', 65)" class="fn">dist</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs33', 66)" onmouseover="showTip(event, 'fs33', 66)" class="id">Sample</span><span class="pn">(</span><span class="pn">)</span><span class="pn">)</span>
    
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs34', 67)" onmouseover="showTip(event, 'fs34', 67)" class="id">sampleA</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs26', 68)" onmouseover="showTip(event, 'fs26', 68)" class="fn">getSample</span> <span class="n">5</span> <span onmouseout="hideTip(event, 'fs18', 69)" onmouseover="showTip(event, 'fs18', 69)" class="id">distributionA</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs35', 70)" onmouseover="showTip(event, 'fs35', 70)" class="id">sampleB</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs26', 71)" onmouseover="showTip(event, 'fs26', 71)" class="fn">getSample</span> <span class="n">5</span> <span onmouseout="hideTip(event, 'fs21', 72)" onmouseover="showTip(event, 'fs21', 72)" class="id">distributionB</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs36', 73)" onmouseover="showTip(event, 'fs36', 73)" class="id">pValue</span> <span class="o">=</span> <span class="prop">(</span><span onmouseout="hideTip(event, 'fs37', 74)" onmouseover="showTip(event, 'fs37', 74)" class="id">Testing</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs38', 75)" onmouseover="showTip(event, 'fs38', 75)" class="m">TTest</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs39', 76)" onmouseover="showTip(event, 'fs39', 76)" class="id">twoSample</span> <span class="k">true</span> <span onmouseout="hideTip(event, 'fs34', 77)" onmouseover="showTip(event, 'fs34', 77)" class="id">sampleA</span> <span onmouseout="hideTip(event, 'fs35', 78)" onmouseover="showTip(event, 'fs35', 78)" class="id">sampleB</span><span class="pn">)</span><span class="pn">.</span><span class="id">PValue</span>
</code></pre>
<table class="pre"><tr><td><pre><code>0.643129126</code></pre></td></tr></table>
<p>10,000 tests are performed, each with new randomly drawn samples. This corresponds to an experiment in which <b>none of the features changed</b>
Note, that the mean intensities are arbitrary and must not be the same for all features! In the presented case all feature intensities are in average 10.
The same simulation can be performed with pairwise comparisons from distributions that differ for each feature, but are the same within the feature.
<b>The resulting p values are uniformely distributed between 0 and 1</b></p>
<br>
<img style="max-width:50%" src="../img/qvalue_01.svg"></img>
<p><em>Fig 1: p value distribution of the null hypothesis.</em>
<hr>
<br></p>
<p>Samples are called significantly different, if their p value is below a certain significance threshold (<span class="math">\(\alpha\)</span> level). While "the lower the better", a common threshold
is a p value of 0.05 or 0.01. In the presented case in average <span class="math">\(10,000 * 0.05 = 500\)</span> tests are <b>significant (red box), even though the populations do not differ</b>. They are called <b>false
positives (FP)</b>. Now lets repeat the same experiment, but this time sample 70% of the time from null features (no difference) and <b>add 30% samples of truly
differing</b> distributions. Therefore a third populations is generated, that differ in mean, but has an equal standard deviation:</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs55', 114)" onmouseover="showTip(event, 'fs55', 114)" class="id">distributionC</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs19', 115)" onmouseover="showTip(event, 'fs19', 115)" class="m">Continuous</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs20', 116)" onmouseover="showTip(event, 'fs20', 116)" class="id">normal</span> <span class="n">11.5</span> <span class="n">1.0</span>
</code></pre>
<img style="max-width:50%" src="../img/qvalue_02.svg"></img>
<p><em>Fig 2: p value distribution of the alternative hypothesis. Blue coloring indicate p values deriving from distribution A and B (null).
Orange coloring indicate p values deriving from distribution A and C (truly differing).</em></p>
<p>The pvalue distribution of the tests resulting from truly differing populations are <b>right skewed</b>, while the null tests again show a homogeneous distribution between 0 and 1.
Many, but not all of the tests that come from the truly differing populations are below 0.05, and therefore would be reported as significant.
In average 350 null features would be reported as significant even though they derive from null features (blue bars, 10,000 x 0.7 x 0.05 = 350).</p>
<h2><a name="The-multiple-testing-problem" class="anchor" href="#The-multiple-testing-problem">The multiple testing problem</a></h2>
<p>The hypothesis testing framework with the p value definition given above was <b>developed for performing just one test. If many tests are performed, like in modern high throuput studies, the probability to obtain a
false positive result increases.</b> The probability of at least one false positive is called Familywise error rate (FWER) and can be determined by <span class="math">\(FWER=1-(1-\alpha)^m\)</span> where
<span class="math">\(\alpha\)</span> corresponds to the significance threshold and <span class="math">\(m\)</span> is the number of performed tests.</p>
<table class="pre"><tr><td><pre><code>No value returned by any evaluator</code></pre></td></tr></table>
<p><em>Fig 3: Familiy wise error rate depending on number of performed tests. The black dashed line indicates the Bonferroni corrected FWER by <span class="math">\(p^* = \frac{\alpha}{m}\)</span>.</em></p>
<p>When 10,000 null features are tested with a p value threshold of 0.05, in average 500 tests are reported significant even if there is not a single comparisons in which the
population differ. <strong>If some of the features are in fact different, the number of false positives consequently decreases (remember, the p value is defined for tests of null features).</strong></p>
<p>Why the interpretation of high throughput data based on p values is difficult: The more features are measured, the more false positives you can expect. If 100 differentially
expressed genes are identified by p value thresholding, without further information about the magnitude of expected changes and the total number of measured transcripts, the
data is useless.</p>
<p>The p value threshold has no straight-forward interpretation when many tests are performed. Of course you could restrict the family wise error rate to 0.05, regardless
how many tests are performed. This is realized by dividing the <span class="math">\(\alpha\)</span> significance threshold by the number of tests, which is known as Bonferroni correction: <span class="math">\(p^* = \frac{\alpha}{m}\)</span>.
This correction drastically limit the false positive rate, but in an experiment with a huge count of expected changes, it additionally would result in many false negatives. The
FWER should be chosen if the costs of follow up studies to tests the candidates are dramatic or there is a huge waste of time to potentially study false positives.</p>
<h2><a name="False-discovery-rate" class="anchor" href="#False-discovery-rate">False discovery rate</a></h2>
<p>A more reasonable measure of significance with a simple interpretation is the so called false discovery rate (FDR). <strong>It describes the rate of expected false positives within the
overall reported significant features.</strong> The goal is to identify as many sig. features as possible while incurring a relatively low proportion of false positives.
Consequently a set of reported significant features together with the <b>FDR describes the confidence of this set</b>, without the requirement to
somehow incorporate the uncertainty that is introduced by the total number of tests performed. In the simulated case of 7,000 null tests and 3,000 tests resulting from truly
differing distributions above, the FDR can be calculated exactly. Therefore at e.g. a p value of 0.05 the number of false positives (blue in red box) are devided by the number
of significant reported tests (false positives + true positives).</p>
<br>
<hr>
<img style="max-width:75%" src="../img/qvalue_03.svg"></img>
<p><em>Fig 4: p value distribution of the alternative hypothesis.</em>
<hr>
<br></p>
<p>Given the conditions described in the first chapter, the FDR of this experiment with a p value threshold of 0.05 is 0.198. Out of the 2019 reported significant comparisons, in average 350
are expected to be false positives, which gives an straight forward interpretation of the data confidence. In real-world experiments the proportion of null tests and tests
deriving from an actual difference is of course unknown. <strong>The proportion of null tests however tends to be distributed equally in the p value histogram.</strong> By identification of
the average null frequency, a proportion of FP and TP can be determined and the FDR can be defined. This frequency estimate is called <span class="math">\(\pi_0\)</span>, which leads to an FDR definition of:</p>
<br>
<img style="max-width:75%" src="../img/qvalue_04.svg"></img>
<p><em>Fig 5: FDR calculation on simulated data.</em></p>
<br>
<h3><a name="q-values-1" class="anchor" href="#q-values-1">q values</a></h3>
<p>Consequently for each presented p value a corresponding FDR can be calculated. The minimum local FDR at each p value is called q value.</p>
<p><span class="math">\[\hat q(p_i) = min_{t \geq p_i} \hat{FDR}(p_i)\]</span></p>
<p>Since the q value is not monotonically increasing, it is smoothed by assigning the lowest FDR of all p values, that are equal or higher the current one.</p>
<p><strong>By defining <span class="math">\(\pi_0\)</span>, all other parameters can be calculated from the given p value distribution to determine the all q values.</strong> The most prominent
FDR-controlling method is known as Benjamini-Hochberg correction. It sets <span class="math">\(\pi_0\)</span> as 1, assuming that all features are null. In studies with an expected high proportion of true
positives, a <span class="math">\(\pi_0\)</span> of 1 is too conservative, since there definitely are true positives in the data.</p>
<p>A better estimation of <span class="math">\(\pi_0\)</span> is given in the following:</p>
<b>True positives are assumed to be right skewed while null tests are distributed equally between 0 and 1</b>. Consequently the right flat region of the p value histogram tends to correspond 
to the true frequency of null comparisons (Fig 5). As <b>real world example</b> 9856 genes were measured in triplicates under two conditions (control and treatment). The p value distribution of two 
sample t tests looks as follows:
<table class="pre"><tr><td><pre><code>No value returned by any evaluator</code></pre></td></tr></table>
<br>
<p><em>Fig 6: p value distributions of real world example. The frequency is given on the right, its density on the left. The black dashed line indicates the distribution, if all features
were null. The red dash-dotted line indicates the visual estimated pi0.</em></p>
<br>
<hr>
<p>By performing t tests for all comparisons 3743 (38 %) of the genes lead to a pvalue lower than 0.05.
By eye, you would estimate <span class="math">\(\pi_0\)</span> as 0.4, indicating, only a small fraction of the genes are unaltered (null). After q value calculations, you would filter for a specific FDR (e.g. 0.05) and
end up with an p value threshold of 0.04613, indicating a FDR of max. 0.05 in the final reported 3642 genes.</p>
<table class="pre"><tr><td class="snippet"><pre class="fssnip"><code lang="no-highlight">pi0     = 0.4
m       = 9856
D(p)    = number of sig. tests at given p
FP(p)   = p*0.4*9856
FDR(p)  = FP(p) / D(p)
</code></pre></td></tr></table>
<p>FDR(0.04613) = 0.4995</p>
<br>
<hr>
<table class="pre"><tr><td><pre><code>No value returned by any evaluator</code></pre></td></tr></table>
<p><em>Fig 7: FDR calculation on experiment data. Please zoom into the very first part of the curve to inspect the monotonicity.</em>
<hr></p>
<h3><a name="The-automatic-detection-of-is-facilitated-as-follows" class="anchor" href="#The-automatic-detection-of-is-facilitated-as-follows">The automatic detection of <span class="math">\(\pi_0\)</span> is facilitated as follows</a></h3>
<p>For a range of <span class="math">\(\lambda\)</span> in e.g. <span class="math">\(\{0.0  ..  0.05  ..  0.95\}\)</span>, calculate <span class="math">\(\hat \pi_0 (\lambda) = \frac {\#[p_j &gt; \lambda]}{m(1 - \lambda)}\)</span></p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs93', 297)" onmouseover="showTip(event, 'fs93', 297)" class="id">pi0Est</span> <span class="o">=</span> 
    <span class="pn">[|</span><span class="o">0.</span> <span class="o">..</span> <span class="n">0.05</span> <span class="o">..</span> <span class="n">1.</span><span class="pn">|]</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs41', 298)" onmouseover="showTip(event, 'fs41', 298)" class="m">Array</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs51', 299)" onmouseover="showTip(event, 'fs51', 299)" class="id">map</span> <span class="pn">(</span><span class="k">fun</span> <span onmouseout="hideTip(event, 'fs94', 300)" onmouseover="showTip(event, 'fs94', 300)" class="fn">lambda</span> <span class="k">-&gt;</span> 
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs95', 301)" onmouseover="showTip(event, 'fs95', 301)" class="fn">num</span> <span class="o">=</span> 
            <span onmouseout="hideTip(event, 'fs59', 302)" onmouseover="showTip(event, 'fs59', 302)" class="id">examplePVals</span> 
            <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs41', 303)" onmouseover="showTip(event, 'fs41', 303)" class="m">Array</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs73', 304)" onmouseover="showTip(event, 'fs73', 304)" class="id">sumBy</span> <span class="pn">(</span><span class="k">fun</span> <span onmouseout="hideTip(event, 'fs74', 305)" onmouseover="showTip(event, 'fs74', 305)" class="fn">x</span> <span class="k">-&gt;</span> <span class="k">if</span> <span onmouseout="hideTip(event, 'fs74', 306)" onmouseover="showTip(event, 'fs74', 306)" class="fn">x</span> <span class="o">&gt;</span> <span onmouseout="hideTip(event, 'fs94', 307)" onmouseover="showTip(event, 'fs94', 307)" class="fn">lambda</span> <span class="k">then</span> <span class="n">1.</span> <span class="k">else</span> <span class="n">0.</span><span class="pn">)</span> 
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs96', 308)" onmouseover="showTip(event, 'fs96', 308)" class="fn">den</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs30', 309)" onmouseover="showTip(event, 'fs30', 309)" class="fn">float</span> <span onmouseout="hideTip(event, 'fs59', 310)" onmouseover="showTip(event, 'fs59', 310)" class="id">examplePVals</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs86', 311)" onmouseover="showTip(event, 'fs86', 311)" class="id">Length</span> <span class="o">*</span> <span class="pn">(</span><span class="n">1.</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs94', 312)" onmouseover="showTip(event, 'fs94', 312)" class="fn">lambda</span><span class="pn">)</span>
        <span onmouseout="hideTip(event, 'fs94', 313)" onmouseover="showTip(event, 'fs94', 313)" class="fn">lambda</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs95', 314)" onmouseover="showTip(event, 'fs95', 314)" class="fn">num</span><span class="o">/</span><span onmouseout="hideTip(event, 'fs96', 315)" onmouseover="showTip(event, 'fs96', 315)" class="fn">den</span>
        <span class="pn">)</span>
</code></pre>
<table class="pre"><tr><td><pre><code>No value returned by any evaluator</code></pre></td></tr></table>
<p><em>Fig 8: pi0 estimation.</em>
<hr></p>
<p>The resulting diagram shows, that with increasing <span class="math">\(\lambda\)</span> its function value <span class="math">\(\hat \pi_0(\lambda)\)</span> tends to <span class="math">\(\pi_0\)</span>. The calculation <b>relates the actual proportion of tests greater than <span class="math">\(\lambda\)</span> to the proportion of <span class="math">\(\lambda\)</span> range the corresponding p values are in</b>.
In Storey &amp; Tibshirani 2003 this curve is fitted with a <b>cubic spline</b>. A weighting of the knots by <span class="math">\((1 - \lambda)\)</span> is recommended
but not specified in the final publication. Afterwards the function value at <span class="math">\(\hat \pi_0(1)\)</span> is defined as final estimator of <span class="math">\(\pi_0\)</span>.</p>
<p>Another method, that does not depend on fitting is based on <b>bootstrapping</b> and was introduced in Storey et al. (2004). It is implemented in FSharp.Stats:</p>
<ol>
<li><p>Determine the minimal <span class="math">\(\hat \pi_0 (\lambda)\)</span> and call it <span class="math">\(min \hat \pi_0\)</span> .</p></li>
<li>
<p>For each <span class="math">\(\lambda\)</span>, bootstrap the p values (e.g. 100 times) and calculate the mean squared error (MSE) from the difference of resulting <span class="math">\(\hat \pi_0^b\)</span> to <span class="math">\(min  \hat \pi_0\)</span>. The minimal MSE indicates the best <span class="math">\(\lambda\)</span>. With <span class="math">\(\lambda\)</span>
defined, <span class="math">\(\pi_0\)</span> can be determined. <em>Note: When bootstrapping an data set of size n, n elements are drawn with replacement.</em></p>
</li>
</ol>
<table class="pre"><tr><td><pre><code>No value returned by any evaluator</code></pre></td></tr></table>
<p><em>Fig 9: Bootstrapping for pi0 estimation. The dashed line indicates the minimal pi0 from Fig. 8.
The bootstrapped pi0 distribution that shows the least variation to the dashed line is the optimal. In the presented example it is either 0.8 or 0.85.</em>
<hr></p>
<p>For an <span class="math">\(\lambda\)</span>, range of <span class="math">\(\{0.0  ..  0.05  ..  0.95\}\)</span> the bootstrapping method determines either 0.8 or 0.85 as optimal <span class="math">\(\lambda\)</span> and therefore <span class="math">\(optimal  \hat \pi_0\)</span> is either <span class="math">\(0.3703\)</span> or <span class="math">\(0.3686\)</span>.</p>
<p>The <b>automated estimation</b> of <span class="math">\(\pi_0\)</span> based on bootstrapping is implemented in <code>FSharp.Stats.Testing.MultipleTesting.Qvalues</code>.</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">open</span> <span onmouseout="hideTip(event, 'fs37', 398)" onmouseover="showTip(event, 'fs37', 398)" class="id">Testing</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs115', 399)" onmouseover="showTip(event, 'fs115', 399)" class="m">MultipleTesting</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs116', 400)" onmouseover="showTip(event, 'fs116', 400)" class="id">pi0Stats</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs117', 401)" onmouseover="showTip(event, 'fs117', 401)" class="m">Qvalues</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs118', 402)" onmouseover="showTip(event, 'fs118', 402)" class="id">pi0BootstrapWithLambda</span> <span class="pn">[|</span><span class="o">0.0</span> <span class="o">..</span> <span class="n">0.05</span> <span class="o">..</span> <span class="n">0.95</span><span class="pn">|]</span> <span onmouseout="hideTip(event, 'fs59', 403)" onmouseover="showTip(event, 'fs59', 403)" class="id">examplePVals</span>
</code></pre>
<table class="pre"><tr><td><pre><code>No value returned by any evaluator</code></pre></td></tr></table>
<p>Subsequent to <span class="math">\(\pi_0\)</span> estimation the <b>q values can be determined</b> from a list of p values.</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs119', 405)" onmouseover="showTip(event, 'fs119', 405)" class="id">qValues</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs117', 406)" onmouseover="showTip(event, 'fs117', 406)" class="m">Qvalues</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs120', 407)" onmouseover="showTip(event, 'fs120', 407)" class="id">ofPValues</span> <span onmouseout="hideTip(event, 'fs116', 408)" onmouseover="showTip(event, 'fs116', 408)" class="id">pi0Stats</span> <span onmouseout="hideTip(event, 'fs59', 409)" onmouseover="showTip(event, 'fs59', 409)" class="id">examplePVals</span>
</code></pre>
<table class="pre"><tr><td><pre><code>No value returned by any evaluator</code></pre></td></tr></table>
<h2><a name="Quality-plots" class="anchor" href="#Quality-plots">Quality plots</a></h2>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs121', 411)" onmouseover="showTip(event, 'fs121', 411)" class="id">pi0Line</span> <span class="o">=</span> 
    <span class="id">Shape</span><span class="pn">.</span><span class="id">init</span><span class="pn">(</span><span class="id">ShapeType</span><span class="pn">.</span><span class="id">Line</span><span class="pn">,</span><span class="n">0.</span><span class="pn">,</span><span class="n">1.</span><span class="pn">,</span><span onmouseout="hideTip(event, 'fs116', 412)" onmouseover="showTip(event, 'fs116', 412)" class="id">pi0Stats</span><span class="pn">,</span><span onmouseout="hideTip(event, 'fs116', 413)" onmouseover="showTip(event, 'fs116', 413)" class="id">pi0Stats</span><span class="pn">,</span><span class="id">Line</span><span class="o">=</span><span class="id">Line</span><span class="pn">.</span><span class="id">init</span><span class="pn">(</span><span class="id">Dash</span><span class="o">=</span><span class="id">DrawingStyle</span><span class="pn">.</span><span class="id">Dash</span><span class="pn">)</span><span class="pn">)</span>

<span class="c">// relates the q value to each p value</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs122', 414)" onmouseover="showTip(event, 'fs122', 414)" class="id">p2q</span> <span class="o">=</span> 
    <span onmouseout="hideTip(event, 'fs41', 415)" onmouseover="showTip(event, 'fs41', 415)" class="m">Array</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs123', 416)" onmouseover="showTip(event, 'fs123', 416)" class="id">zip</span> <span onmouseout="hideTip(event, 'fs59', 417)" onmouseover="showTip(event, 'fs59', 417)" class="id">examplePVals</span> <span onmouseout="hideTip(event, 'fs119', 418)" onmouseover="showTip(event, 'fs119', 418)" class="id">qValues</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs41', 419)" onmouseover="showTip(event, 'fs41', 419)" class="m">Array</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs124', 420)" onmouseover="showTip(event, 'fs124', 420)" class="id">sortBy</span> <span onmouseout="hideTip(event, 'fs125', 421)" onmouseover="showTip(event, 'fs125', 421)" class="fn">fst</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs15', 422)" onmouseover="showTip(event, 'fs15', 422)" class="m">Chart</span><span class="pn">.</span><span class="id">Line</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs15', 423)" onmouseover="showTip(event, 'fs15', 423)" class="m">Chart</span><span class="pn">.</span><span class="id">withShape</span> <span onmouseout="hideTip(event, 'fs121', 424)" onmouseover="showTip(event, 'fs121', 424)" class="id">pi0Line</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs15', 425)" onmouseover="showTip(event, 'fs15', 425)" class="m">Chart</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs10', 426)" onmouseover="showTip(event, 'fs10', 426)" class="id">withAxisTitles</span> <span class="s">&quot;p value&quot;</span> <span class="s">&quot;q value&quot;</span>

<span class="c">// shows the p values distribution for an visual inspection of pi0 estimation</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs126', 427)" onmouseover="showTip(event, 'fs126', 427)" class="id">pValueDistribution</span> <span class="o">=</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs127', 428)" onmouseover="showTip(event, 'fs127', 428)" class="fn">frequencyBins</span> <span class="o">=</span> <span class="n">0.025</span> 
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs65', 429)" onmouseover="showTip(event, 'fs65', 429)" class="fn">m</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs59', 430)" onmouseover="showTip(event, 'fs59', 430)" class="id">examplePVals</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs86', 431)" onmouseover="showTip(event, 'fs86', 431)" class="id">Length</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs30', 432)" onmouseover="showTip(event, 'fs30', 432)" class="fn">float</span>
    <span onmouseout="hideTip(event, 'fs59', 433)" onmouseover="showTip(event, 'fs59', 433)" class="id">examplePVals</span> 
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs17', 434)" onmouseover="showTip(event, 'fs17', 434)" class="id">Distributions</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs47', 435)" onmouseover="showTip(event, 'fs47', 435)" class="m">Frequency</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs48', 436)" onmouseover="showTip(event, 'fs48', 436)" class="id">create</span> <span onmouseout="hideTip(event, 'fs127', 437)" onmouseover="showTip(event, 'fs127', 437)" class="fn">frequencyBins</span> 
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs49', 438)" onmouseover="showTip(event, 'fs49', 438)" class="m">Map</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs50', 439)" onmouseover="showTip(event, 'fs50', 439)" class="id">toArray</span> 
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs41', 440)" onmouseover="showTip(event, 'fs41', 440)" class="m">Array</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs51', 441)" onmouseover="showTip(event, 'fs51', 441)" class="id">map</span> <span class="pn">(</span><span class="k">fun</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs52', 442)" onmouseover="showTip(event, 'fs52', 442)" class="fn">k</span><span class="pn">,</span><span onmouseout="hideTip(event, 'fs53', 443)" onmouseover="showTip(event, 'fs53', 443)" class="fn">c</span><span class="pn">)</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs52', 444)" onmouseover="showTip(event, 'fs52', 444)" class="fn">k</span><span class="pn">,</span><span onmouseout="hideTip(event, 'fs30', 445)" onmouseover="showTip(event, 'fs30', 445)" class="fn">float</span> <span onmouseout="hideTip(event, 'fs53', 446)" onmouseover="showTip(event, 'fs53', 446)" class="fn">c</span> <span class="o">/</span> <span onmouseout="hideTip(event, 'fs127', 447)" onmouseover="showTip(event, 'fs127', 447)" class="fn">frequencyBins</span> <span class="o">/</span> <span onmouseout="hideTip(event, 'fs65', 448)" onmouseover="showTip(event, 'fs65', 448)" class="fn">m</span><span class="pn">)</span> 
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs15', 449)" onmouseover="showTip(event, 'fs15', 449)" class="m">Chart</span><span class="pn">.</span><span class="id">StackedColumn</span> 
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs15', 450)" onmouseover="showTip(event, 'fs15', 450)" class="m">Chart</span><span class="pn">.</span><span class="id">withTraceName</span> <span class="s">&quot;p values&quot;</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs15', 451)" onmouseover="showTip(event, 'fs15', 451)" class="m">Chart</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs10', 452)" onmouseover="showTip(event, 'fs10', 452)" class="id">withAxisTitles</span> <span class="s">&quot;p value&quot;</span> <span class="s">&quot;frequency density&quot;</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs15', 453)" onmouseover="showTip(event, 'fs15', 453)" class="m">Chart</span><span class="pn">.</span><span class="id">withShape</span> <span onmouseout="hideTip(event, 'fs121', 454)" onmouseover="showTip(event, 'fs121', 454)" class="id">pi0Line</span>

<span class="c">// shows pi0 estimation in relation to lambda</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs128', 455)" onmouseover="showTip(event, 'fs128', 455)" class="id">pi0Estimation</span> <span class="o">=</span> 
    <span class="c">//Testing.MultipleTesting.Qvalues.pi0hats [|0. .. 0.05 .. 0.96|] examplePVals</span>
    <span class="pn">[|</span><span class="o">0.</span> <span class="o">..</span> <span class="n">0.05</span> <span class="o">..</span> <span class="n">0.95</span><span class="pn">|]</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs41', 456)" onmouseover="showTip(event, 'fs41', 456)" class="m">Array</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs51', 457)" onmouseover="showTip(event, 'fs51', 457)" class="id">map</span> <span class="pn">(</span><span class="k">fun</span> <span onmouseout="hideTip(event, 'fs94', 458)" onmouseover="showTip(event, 'fs94', 458)" class="fn">lambda</span> <span class="k">-&gt;</span> 
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs95', 459)" onmouseover="showTip(event, 'fs95', 459)" class="fn">num</span> <span class="o">=</span>   
            <span onmouseout="hideTip(event, 'fs59', 460)" onmouseover="showTip(event, 'fs59', 460)" class="id">examplePVals</span> 
            <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs41', 461)" onmouseover="showTip(event, 'fs41', 461)" class="m">Array</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs73', 462)" onmouseover="showTip(event, 'fs73', 462)" class="id">sumBy</span> <span class="pn">(</span><span class="k">fun</span> <span onmouseout="hideTip(event, 'fs74', 463)" onmouseover="showTip(event, 'fs74', 463)" class="fn">x</span> <span class="k">-&gt;</span> <span class="k">if</span> <span onmouseout="hideTip(event, 'fs74', 464)" onmouseover="showTip(event, 'fs74', 464)" class="fn">x</span> <span class="o">&gt;</span> <span onmouseout="hideTip(event, 'fs94', 465)" onmouseover="showTip(event, 'fs94', 465)" class="fn">lambda</span> <span class="k">then</span> <span class="n">1.</span> <span class="k">else</span> <span class="n">0.</span><span class="pn">)</span>
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs96', 466)" onmouseover="showTip(event, 'fs96', 466)" class="fn">den</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs30', 467)" onmouseover="showTip(event, 'fs30', 467)" class="fn">float</span> <span onmouseout="hideTip(event, 'fs59', 468)" onmouseover="showTip(event, 'fs59', 468)" class="id">examplePVals</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs86', 469)" onmouseover="showTip(event, 'fs86', 469)" class="id">Length</span> <span class="o">*</span> <span class="pn">(</span><span class="n">1.</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs94', 470)" onmouseover="showTip(event, 'fs94', 470)" class="fn">lambda</span><span class="pn">)</span>
        <span onmouseout="hideTip(event, 'fs94', 471)" onmouseover="showTip(event, 'fs94', 471)" class="fn">lambda</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs95', 472)" onmouseover="showTip(event, 'fs95', 472)" class="fn">num</span><span class="o">/</span><span onmouseout="hideTip(event, 'fs96', 473)" onmouseover="showTip(event, 'fs96', 473)" class="fn">den</span>
        <span class="pn">)</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs15', 474)" onmouseover="showTip(event, 'fs15', 474)" class="m">Chart</span><span class="pn">.</span><span class="id">Point</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs15', 475)" onmouseover="showTip(event, 'fs15', 475)" class="m">Chart</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs10', 476)" onmouseover="showTip(event, 'fs10', 476)" class="id">withAxisTitles</span> <span class="s">&quot;$\lambda$&quot;</span> <span class="s">&quot;$\hat \pi_0(\lambda)$&quot;</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs15', 477)" onmouseover="showTip(event, 'fs15', 477)" class="m">Chart</span><span class="pn">.</span><span class="id">withMathTex</span><span class="pn">(</span><span class="k">true</span><span class="pn">)</span>
</code></pre>
<table class="pre"><tr><td><pre><code>No value returned by any evaluator</code></pre></td></tr></table>
<p><em>Fig 10: p value relation to q values. At a p value of 1 the q value is equal to $\pi</em>0$ (black dashed line)._</p>
<table class="pre"><tr><td><pre><code>No value returned by any evaluator</code></pre></td></tr></table>
<p><em>Fig 11: p value density distribution. The dashed line indicates pi0 estimated by Storeys bootstrapping method.</em></p>
<table class="pre"><tr><td><pre><code>No value returned by any evaluator</code></pre></td></tr></table>
<p><em>Fig 12: Visual pi0 estimation.</em></p>
<h2><a name="Definitions-and-Notes" class="anchor" href="#Definitions-and-Notes">Definitions and Notes</a></h2>
<ul>
<li>q values are not always greater than their associated p values. q values can maximal be <span class="math">\(\pi_0\)</span>.</li>
<li>
Storey &amp; Tibshirani (2003):
<ul>
<li><em>"The q-value for a particular feature is the expected proportion of false positives occurring up through that feature on the list."</em></li>
<li><em>"The precise definition of the q-value for a particular feature is the following. The q-value for a particular feature is the minimum false discovery rate that can be attained when calling all features up through that one on the list significant."</em></li>
<li><em>"The 0.05 q-value cut-off is arbitrary, and we do not recommend that this value necessarily be used."</em></li>
<li><em>"The Benjamini &amp; Hochberg (1995) methodology also forces one to choose an acceptable FDR level before any data are seen, which is often going to be impractical."</em></li>
</ul>
</li>
<li>
A method exists, to improve the q value estimation if the effects are asymmetric, meaning that negative effects are stronger than positives, or vice versa. This method published in 2014 by Orr et al. estimates a global <span class="math">\(m_0\)</span> and then splits the p values 
in two groups before calulating q values for each p value set. The applicability of this strategy however is questionable, as the number of up- and downregulated features must be equal, which is not the case in most biological experimental setups.
</li>
</ul>
<h2><a name="References" class="anchor" href="#References">References</a></h2>
<ul>
<li>Statistical significance for genomewide studies, John D. Storey, Robert Tibshirani, Proceedings of the National Academy of Sciences Aug 2003, 100 (16) 9440-9445; <a href="https://www.pnas.org/content/100/16/9440">DOI: 10.1073/pnas.1530509100</a></li>
<li>Strong Control, Conservative Point Estimation and Simultaneous Conservative Consistency of False Discovery Rates: A Unified Approach, Storey, John D., Jonathan E. Taylor, and David Siegmund, Journal of the Royal Statistical Society. Series B (Statistical Methodology), vol. 66, no. 1, [Royal Statistical Society, Wiley], 2004, pp. 187-205, <a href="https://www.jstor.org/stable/3647634?seq=1#metadata_info_tab_contents"><a href="http://www.jstor.org/stable/3647634">http://www.jstor.org/stable/3647634</a></a>.</li>
<li>An improved method for computing q-values when the distribution of effect sizes is asymmetric, Orr M, Liu P, Nettleton D., Bioinformatics. 2014 Nov 1;30(21):3044-53. <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4609005/">doi: 10.1093/bioinformatics/btu432</a>. Epub 2014 Jul 14. PMID: 25024290; PMCID: PMC4609005.</li>
<li>Nettleton, Dan, et al. "Estimating the Number of True Null Hypotheses from a Histogram of p Values." Journal of Agricultural, Biological, and Environmental Statistics, vol. 11, no. 3, [International Biometric Society, Springer], 2006, pp. 337-56, <a href="http://www.jstor.org/stable/27595607.">http://www.jstor.org/stable/27595607.</a></li>
<li>Benjamini Y, Hochberg Y. On the Adaptive Control of the False Discovery Rate in Multiple Testing With Independent Statistics. Journal of Educational and Behavioral Statistics. 2000;25(1):60-83. doi:10.3102/10769986025001060</li>
</ul>

                </div>
            </div>
        </div>
        <div class="fsdocs-tip" id="fs1">Multiple items<br />namespace FSharp<br /><br />--------------------<br />namespace Microsoft.FSharp</div>
<div class="fsdocs-tip" id="fs2">namespace FSharp.Stats</div>
<div class="fsdocs-tip" id="fs3">Multiple items<br />module Seq

from FSharp.Stats<br /><em>&lt;summary&gt;
 Module to compute common statistical measure
&lt;/summary&gt;</em><br /><br />--------------------<br />module Seq

from Microsoft.FSharp.Collections<br /><em>&lt;summary&gt;Contains operations for working with values of type &lt;see cref=&quot;T:Microsoft.FSharp.Collections.seq`1&quot; /&gt;.&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs4">val mean : items:seq&lt;&#39;T&gt; -&gt; &#39;U (requires member ( + ) and member get_Zero and member DivideByInt and member ( / ))<br /><em>&lt;summary&gt;
   Computes the population mean (Normalized by N)
 &lt;/summary&gt;<br />&lt;param name=&quot;items&quot;&gt;The input sequence.&lt;/param&gt;<br />&lt;remarks&gt;Returns default value if data is empty or if any entry is NaN.&lt;/remarks&gt;<br />&lt;returns&gt;population mean (Normalized by N)&lt;/returns&gt;</em></div>
<div class="fsdocs-tip" id="fs5">val te : float</div>
<div class="fsdocs-tip" id="fs6">val te2 : float</div>
<div class="fsdocs-tip" id="fs7">val average : source:seq&lt;&#39;T&gt; -&gt; &#39;T (requires member ( + ) and member DivideByInt and member get_Zero)<br /><em>&lt;summary&gt;Returns the average of the elements in the sequence.&lt;/summary&gt;<br />&lt;remarks&gt;The elements are averaged using the &lt;c&gt;+&lt;/c&gt; operator, &lt;c&gt;DivideByInt&lt;/c&gt; method and &lt;c&gt;Zero&lt;/c&gt; property 
 associated with the element type.&lt;/remarks&gt;<br />&lt;param name=&quot;source&quot;&gt;The input sequence.&lt;/param&gt;<br />&lt;returns&gt;The average.&lt;/returns&gt;<br />&lt;exception cref=&quot;T:System.ArgumentNullException&quot;&gt;Thrown when the input sequence is null.&lt;/exception&gt;<br />&lt;exception cref=&quot;T:System.ArgumentException&quot;&gt;Thrown when the input sequence has zero elements.&lt;/exception&gt;</em></div>
<div class="fsdocs-tip" id="fs8">val myAxis : name:&#39;a -&gt; &#39;b</div>
<div class="fsdocs-tip" id="fs9">val name : &#39;a</div>
<div class="fsdocs-tip" id="fs10">val withAxisTitles : x:&#39;a -&gt; y:&#39;b -&gt; chart:&#39;c -&gt; &#39;d</div>
<div class="fsdocs-tip" id="fs11">val x : &#39;a</div>
<div class="fsdocs-tip" id="fs12">val y : &#39;b</div>
<div class="fsdocs-tip" id="fs13">val chart : &#39;c</div>
<div class="fsdocs-tip" id="fs14">Multiple items<br />val list : (int * int) list<br /><br />--------------------<br />type &#39;T list = List&lt;&#39;T&gt;<br /><em>&lt;summary&gt;The type of immutable singly-linked lists. &lt;/summary&gt;<br />&lt;remarks&gt;See the &lt;see cref=&quot;T:Microsoft.FSharp.Collections.ListModule&quot; /&gt; module for further operations related to lists.

 Use the constructors &lt;c&gt;[]&lt;/c&gt; and &lt;c&gt;::&lt;/c&gt; (infix) to create values of this type, or
 the notation &lt;c&gt;[1; 2; 3]&lt;/c&gt;. Use the values in the &lt;c&gt;List&lt;/c&gt; module to manipulate 
 values of this type, or pattern match against the values directly.

  See also &lt;a href=&quot;https://docs.microsoft.com/dotnet/fsharp/language-reference/lists&quot;&gt;F# Language Guide - Lists&lt;/a&gt;.
 &lt;/remarks&gt;</em></div>
<div class="fsdocs-tip" id="fs15">module Chart

from 4_qvalues</div>
<div class="fsdocs-tip" id="fs16">namespace FSharpAux</div>
<div class="fsdocs-tip" id="fs17">namespace FSharp.Stats.Distributions</div>
<div class="fsdocs-tip" id="fs18">val distributionA : Distribution&lt;float,float&gt;</div>
<div class="fsdocs-tip" id="fs19">module Continuous

from FSharp.Stats.Distributions</div>
<div class="fsdocs-tip" id="fs20">val normal : mu:float -&gt; sigma:float -&gt; Distribution&lt;float,float&gt;<br /><em>&lt;summary&gt;
 Initializes a Normal distribution        
&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs21">val distributionB : Distribution&lt;float,float&gt;</div>
<div class="fsdocs-tip" id="fs22">val distributionChartAB : obj</div>
<div class="fsdocs-tip" id="fs23">Multiple items<br />module List

from FSharp.Stats<br /><em>&lt;summary&gt;
 Module to compute common statistical measure on list
&lt;/summary&gt;</em><br /><br />--------------------<br />module List

from FSharpAux<br /><br />--------------------<br />module List

from Microsoft.FSharp.Collections<br /><em>&lt;summary&gt;Contains operations for working with values of type &lt;see cref=&quot;T:Microsoft.FSharp.Collections.list`1&quot; /&gt;.&lt;/summary&gt;<br />&lt;namespacedoc&gt;&lt;summary&gt;Operations for collections such as lists, arrays, sets, maps and sequences. See also 
    &lt;a href=&quot;https://docs.microsoft.com/dotnet/fsharp/language-reference/fsharp-collection-types&quot;&gt;F# Collection Types&lt;/a&gt; in the F# Language Guide.
 &lt;/summary&gt;&lt;/namespacedoc&gt;</em><br /><br />--------------------<br />type List&lt;&#39;T&gt; =
  | ( [] )
  | ( :: ) of Head: &#39;T * Tail: &#39;T list
    interface IReadOnlyList&lt;&#39;T&gt;
    interface IReadOnlyCollection&lt;&#39;T&gt;
    interface IEnumerable
    interface IEnumerable&lt;&#39;T&gt;
    member GetReverseIndex : rank:int * offset:int -&gt; int
    member GetSlice : startIndex:int option * endIndex:int option -&gt; &#39;T list
    static member Cons : head:&#39;T * tail:&#39;T list -&gt; &#39;T list
    member Head : &#39;T
    member IsEmpty : bool
    member Item : index:int -&gt; &#39;T with get
    ...<br /><em>&lt;summary&gt;The type of immutable singly-linked lists.&lt;/summary&gt;<br />&lt;remarks&gt;Use the constructors &lt;c&gt;[]&lt;/c&gt; and &lt;c&gt;::&lt;/c&gt; (infix) to create values of this type, or
 the notation &lt;c&gt;[1;2;3]&lt;/c&gt;. Use the values in the &lt;c&gt;List&lt;/c&gt; module to manipulate 
 values of this type, or pattern match against the values directly.
 &lt;/remarks&gt;<br />&lt;exclude /&gt;</em></div>
<div class="fsdocs-tip" id="fs24">val map : mapping:(&#39;T -&gt; &#39;U) -&gt; list:&#39;T list -&gt; &#39;U list<br /><em>&lt;summary&gt;Builds a new collection whose elements are the results of applying the given function
 to each of the elements of the collection.&lt;/summary&gt;<br />&lt;param name=&quot;mapping&quot;&gt;The function to transform elements from the input list.&lt;/param&gt;<br />&lt;param name=&quot;list&quot;&gt;The input list.&lt;/param&gt;<br />&lt;returns&gt;The list of transformed elements.&lt;/returns&gt;</em></div>
<div class="fsdocs-tip" id="fs25">abstract member Distribution.PDF : &#39;b -&gt; float</div>
<div class="fsdocs-tip" id="fs26">val getSample : n:int -&gt; dist:Distribution&lt;float,float&gt; -&gt; Vector&lt;float&gt;</div>
<div class="fsdocs-tip" id="fs27">val n : int</div>
<div class="fsdocs-tip" id="fs28">val dist : Distribution&lt;float,float&gt;</div>
<div class="fsdocs-tip" id="fs29">type Distribution&lt;&#39;a,&#39;b&gt; =
  abstract member CDF : &#39;a -&gt; float
  abstract member PDF : &#39;b -&gt; float
  abstract member Sample : unit -&gt; &#39;b
  abstract member Mean : &#39;a
  abstract member StandardDeviation : &#39;a
  abstract member Variance : &#39;a<br /><em>&lt;summary&gt;
 Interface which every probability distribution must implement.
&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs30">Multiple items<br />val float : value:&#39;T -&gt; float (requires member op_Explicit)<br /><em>&lt;summary&gt;Converts the argument to 64-bit float. This is a direct conversion for all 
 primitive numeric types. For strings, the input is converted using &lt;c&gt;Double.Parse()&lt;/c&gt;  
 with InvariantCulture settings. Otherwise the operation requires an appropriate
 static conversion method on the input type.&lt;/summary&gt;<br />&lt;param name=&quot;value&quot;&gt;The input value.&lt;/param&gt;<br />&lt;returns&gt;The converted float&lt;/returns&gt;</em><br /><br />--------------------<br />[&lt;Struct&gt;]
type float = System.Double<br /><em>&lt;summary&gt;An abbreviation for the CLI type &lt;see cref=&quot;T:System.Double&quot; /&gt;.&lt;/summary&gt;<br />&lt;category&gt;Basic Types&lt;/category&gt;</em><br /><br />--------------------<br />type float&lt;&#39;Measure&gt; =
  float<br /><em>&lt;summary&gt;The type of double-precision floating point numbers, annotated with a unit of measure. 
 The unit of measure is erased in compiled code and when values of this type
 are analyzed using reflection. The type is representationally equivalent to 
 &lt;see cref=&quot;T:System.Double&quot; /&gt;.&lt;/summary&gt;<br />&lt;category index=&quot;6&quot;&gt;Basic Types with Units of Measure&lt;/category&gt;</em></div>
<div class="fsdocs-tip" id="fs31">Multiple items<br />module Vector

from FSharp.Stats<br /><em>&lt;summary&gt;
Basic vector operations
&lt;/summary&gt;</em><br /><br />--------------------<br />type Vector&lt;&#39;T&gt; =
  interface IEnumerable
  interface IEnumerable&lt;&#39;T&gt;
  interface IStructuralEquatable
  interface IStructuralComparable
  interface IComparable
  new : opsV:INumeric&lt;&#39;T&gt; option * arrV:&#39;T array -&gt; Vector&lt;&#39;T&gt;
  override Equals : yobj:obj -&gt; bool
  override GetHashCode : unit -&gt; int
  member GetSlice : start:int option * finish:int option -&gt; Vector&lt;&#39;T&gt;
  member Permute : p:permutation -&gt; Vector&lt;&#39;T&gt;
  ...<br /><br />--------------------<br />new : opsV:INumeric&lt;&#39;T&gt; option * arrV:&#39;T array -&gt; Vector&lt;&#39;T&gt;</div>
<div class="fsdocs-tip" id="fs32">val init : count:int -&gt; initializer:(int -&gt; float) -&gt; Vector&lt;float&gt;<br /><em>&lt;summary&gt;
Initiates vector of length count and fills it by applying initializer function on indices
&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs33">abstract member Distribution.Sample : unit -&gt; &#39;b</div>
<div class="fsdocs-tip" id="fs34">val sampleA : Vector&lt;float&gt;</div>
<div class="fsdocs-tip" id="fs35">val sampleB : Vector&lt;float&gt;</div>
<div class="fsdocs-tip" id="fs36">val pValue : float</div>
<div class="fsdocs-tip" id="fs37">namespace FSharp.Stats.Testing</div>
<div class="fsdocs-tip" id="fs38">module TTest

from FSharp.Stats.Testing</div>
<div class="fsdocs-tip" id="fs39">val twoSample : assumeEqualVariances:bool -&gt; sample1:Vector&lt;float&gt; -&gt; sample2:Vector&lt;float&gt; -&gt; Testing.TestStatistics.TTestStatistics<br /><em>&lt;summary&gt;
 Computes a t-test or a Welch test (unequal variances)
&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs40">val nullDist : float []</div>
<div class="fsdocs-tip" id="fs41">Multiple items<br />module Array

from FSharp.Stats<br /><em>&lt;summary&gt;
 Module to compute common statistical measure on array
&lt;/summary&gt;</em><br /><br />--------------------<br />module Array

from FSharpAux<br /><br />--------------------<br />module Array

from Microsoft.FSharp.Collections<br /><em>&lt;summary&gt;Contains operations for working with arrays.&lt;/summary&gt;<br />&lt;remarks&gt;
  See also &lt;a href=&quot;https://docs.microsoft.com/dotnet/fsharp/language-reference/arrays&quot;&gt;F# Language Guide - Arrays&lt;/a&gt;.
 &lt;/remarks&gt;</em></div>
<div class="fsdocs-tip" id="fs42">val init : count:int -&gt; initializer:(int -&gt; &#39;T) -&gt; &#39;T []<br /><em>&lt;summary&gt;Creates an array given the dimension and a generator function to compute the elements.&lt;/summary&gt;<br />&lt;param name=&quot;count&quot;&gt;The number of elements to initialize.&lt;/param&gt;<br />&lt;param name=&quot;initializer&quot;&gt;The function to generate the initial values for each index.&lt;/param&gt;<br />&lt;returns&gt;The created array.&lt;/returns&gt;<br />&lt;exception cref=&quot;T:System.ArgumentException&quot;&gt;Thrown when count is negative.&lt;/exception&gt;</em></div>
<div class="fsdocs-tip" id="fs43">val x : int</div>
<div class="fsdocs-tip" id="fs44">val sA : Vector&lt;float&gt;</div>
<div class="fsdocs-tip" id="fs45">val sB : Vector&lt;float&gt;</div>
<div class="fsdocs-tip" id="fs46">val nullDistributionChart : obj</div>
<div class="fsdocs-tip" id="fs47">module Frequency

from FSharp.Stats.Distributions<br /><em>&lt;summary&gt;
 Represents a histogram (map from values to integer frequencies).
&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs48">val create : bandwidth:float -&gt; data:seq&lt;float&gt; -&gt; Map&lt;float,int&gt;<br /><em>&lt;summary&gt;
 Creates probability mass function (histogram)    
&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs49">Multiple items<br />module Map

from FSharpAux<br /><br />--------------------<br />module Map

from Microsoft.FSharp.Collections<br /><em>&lt;summary&gt;Contains operations for working with values of type &lt;see cref=&quot;T:Microsoft.FSharp.Collections.Map`2&quot; /&gt;.&lt;/summary&gt;</em><br /><br />--------------------<br />type Map&lt;&#39;Key,&#39;Value (requires comparison)&gt; =
  interface IReadOnlyDictionary&lt;&#39;Key,&#39;Value&gt;
  interface IReadOnlyCollection&lt;KeyValuePair&lt;&#39;Key,&#39;Value&gt;&gt;
  interface IEnumerable
  interface IComparable
  interface IEnumerable&lt;KeyValuePair&lt;&#39;Key,&#39;Value&gt;&gt;
  interface ICollection&lt;KeyValuePair&lt;&#39;Key,&#39;Value&gt;&gt;
  interface IDictionary&lt;&#39;Key,&#39;Value&gt;
  new : elements:seq&lt;&#39;Key * &#39;Value&gt; -&gt; Map&lt;&#39;Key,&#39;Value&gt;
  member Add : key:&#39;Key * value:&#39;Value -&gt; Map&lt;&#39;Key,&#39;Value&gt;
  member Change : key:&#39;Key * f:(&#39;Value option -&gt; &#39;Value option) -&gt; Map&lt;&#39;Key,&#39;Value&gt;
  ...<br /><em>&lt;summary&gt;Immutable maps based on binary trees, where keys are ordered by F# generic comparison. By default
 comparison is the F# structural comparison function or uses implementations of the IComparable interface on key values.&lt;/summary&gt;<br />&lt;remarks&gt;See the &lt;see cref=&quot;T:Microsoft.FSharp.Collections.MapModule&quot; /&gt; module for further operations on maps.

 All members of this class are thread-safe and may be used concurrently from multiple threads.&lt;/remarks&gt;</em><br /><br />--------------------<br />new : elements:seq&lt;&#39;Key * &#39;Value&gt; -&gt; Map&lt;&#39;Key,&#39;Value&gt;</div>
<div class="fsdocs-tip" id="fs50">val toArray : table:Map&lt;&#39;Key,&#39;T&gt; -&gt; (&#39;Key * &#39;T) [] (requires comparison)<br /><em>&lt;summary&gt;Returns an array of all key-value pairs in the mapping.
 The array will be ordered by the keys of the map.&lt;/summary&gt;<br />&lt;param name=&quot;table&quot;&gt;The input map.&lt;/param&gt;<br />&lt;returns&gt;The array of key/value pairs.&lt;/returns&gt;</em></div>
<div class="fsdocs-tip" id="fs51">val map : mapping:(&#39;T -&gt; &#39;U) -&gt; array:&#39;T [] -&gt; &#39;U []<br /><em>&lt;summary&gt;Builds a new array whose elements are the results of applying the given function
 to each of the elements of the array.&lt;/summary&gt;<br />&lt;param name=&quot;mapping&quot;&gt;The function to transform elements of the array.&lt;/param&gt;<br />&lt;param name=&quot;array&quot;&gt;The input array.&lt;/param&gt;<br />&lt;returns&gt;The array of transformed elements.&lt;/returns&gt;<br />&lt;exception cref=&quot;T:System.ArgumentNullException&quot;&gt;Thrown when the input array is null.&lt;/exception&gt;</em></div>
<div class="fsdocs-tip" id="fs52">val k : float</div>
<div class="fsdocs-tip" id="fs53">val c : int</div>
<div class="fsdocs-tip" id="fs54">val thresholdLine : obj</div>
<div class="fsdocs-tip" id="fs55">val distributionC : Distribution&lt;float,float&gt;</div>
<div class="fsdocs-tip" id="fs56">val distributionChartAC : obj</div>
<div class="fsdocs-tip" id="fs57">val bonferroniLine : obj</div>
<div class="fsdocs-tip" id="fs58">val fwer : obj</div>
<div class="fsdocs-tip" id="fs59">val examplePVals : float []</div>
<div class="fsdocs-tip" id="fs60">namespace System</div>
<div class="fsdocs-tip" id="fs61">namespace System.IO</div>
<div class="fsdocs-tip" id="fs62">type File =
  static member AppendAllLines : path: string * contents: IEnumerable&lt;string&gt; -&gt; unit + 1 overload
  static member AppendAllLinesAsync : path: string * contents: IEnumerable&lt;string&gt; * encoding: Encoding *?cancellationToken: CancellationToken -&gt; Task + 1 overload
  static member AppendAllText : path: string * contents: string -&gt; unit + 1 overload
  static member AppendAllTextAsync : path: string * contents: string * encoding: Encoding *?cancellationToken: CancellationToken -&gt; Task + 1 overload
  static member AppendText : path: string -&gt; StreamWriter
  static member Copy : sourceFileName: string * destFileName: string -&gt; unit + 1 overload
  static member Create : path: string -&gt; FileStream + 2 overloads
  static member CreateText : path: string -&gt; StreamWriter
  static member Decrypt : path: string -&gt; unit
  static member Delete : path: string -&gt; unit
  ...<br /><em>&lt;summary&gt;Provides static methods for the creation, copying, deletion, moving, and opening of a single file, and aids in the creation of &lt;see cref=&quot;T:System.IO.FileStream&quot; /&gt; objects.&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs63">System.IO.File.ReadAllLines(path: string) : string []<br />System.IO.File.ReadAllLines(path: string, encoding: System.Text.Encoding) : string []</div>
<div class="fsdocs-tip" id="fs64">val tail : array:&#39;T [] -&gt; &#39;T []<br /><em>&lt;summary&gt;Returns a new array containing the elements of the original except the first element.&lt;/summary&gt;<br />&lt;param name=&quot;array&quot;&gt;The input array.&lt;/param&gt;<br />&lt;exception cref=&quot;T:System.ArgumentException&quot;&gt;Thrown when the array is empty.&lt;/exception&gt;<br />&lt;exception cref=&quot;T:System.ArgumentNullException&quot;&gt;Thrown when the input array is null.&lt;/exception&gt;<br />&lt;returns&gt;A new array containing the elements of the original except the first element.&lt;/returns&gt;</em></div>
<div class="fsdocs-tip" id="fs65">val m : float</div>
<div class="fsdocs-tip" id="fs66">val length : array:&#39;T [] -&gt; int<br /><em>&lt;summary&gt;Returns the length of an array. You can also use property arr.Length.&lt;/summary&gt;<br />&lt;param name=&quot;array&quot;&gt;The input array.&lt;/param&gt;<br />&lt;returns&gt;The length of the array.&lt;/returns&gt;<br />&lt;exception cref=&quot;T:System.NullReferenceException&quot;&gt;Thrown when the input array is null.&lt;/exception&gt;</em></div>
<div class="fsdocs-tip" id="fs67">val nullLine : obj</div>
<div class="fsdocs-tip" id="fs68">val empLine : obj</div>
<div class="fsdocs-tip" id="fs69">val exampleDistribution : obj</div>
<div class="fsdocs-tip" id="fs70">val pi0 : float</div>
<div class="fsdocs-tip" id="fs71">val getD : p:float -&gt; float</div>
<div class="fsdocs-tip" id="fs72">val p : float</div>
<div class="fsdocs-tip" id="fs73">val sumBy : projection:(&#39;T -&gt; &#39;U) -&gt; array:&#39;T [] -&gt; &#39;U (requires member ( + ) and member get_Zero)<br /><em>&lt;summary&gt;Returns the sum of the results generated by applying the function to each element of the array.&lt;/summary&gt;<br />&lt;param name=&quot;projection&quot;&gt;The function to transform the array elements into the type to be summed.&lt;/param&gt;<br />&lt;param name=&quot;array&quot;&gt;The input array.&lt;/param&gt;<br />&lt;returns&gt;The resulting sum.&lt;/returns&gt;<br />&lt;exception cref=&quot;T:System.ArgumentNullException&quot;&gt;Thrown when the input array is null.&lt;/exception&gt;</em></div>
<div class="fsdocs-tip" id="fs74">val x : float</div>
<div class="fsdocs-tip" id="fs75">val getFP : p:float -&gt; float</div>
<div class="fsdocs-tip" id="fs76">val getFDR : p:float -&gt; float</div>
<div class="fsdocs-tip" id="fs77">val qvaluesNotSmoothed : obj</div>
<div class="fsdocs-tip" id="fs78">val sort : array:&#39;T [] -&gt; &#39;T [] (requires comparison)<br /><em>&lt;summary&gt;Sorts the elements of an array, returning a new array. Elements are compared using &lt;see cref=&quot;M:Microsoft.FSharp.Core.Operators.compare&quot; /&gt;. &lt;/summary&gt;<br />&lt;remarks&gt;This is not a stable sort, i.e. the original order of equal elements is not necessarily preserved. 
 For a stable sort, consider using &lt;see cref=&quot;M:Microsoft.FSharp.Collections.SeqModule.Sort&quot; /&gt;.&lt;/remarks&gt;<br />&lt;param name=&quot;array&quot;&gt;The input array.&lt;/param&gt;<br />&lt;returns&gt;The sorted array.&lt;/returns&gt;<br />&lt;exception cref=&quot;T:System.ArgumentNullException&quot;&gt;Thrown when the input array is null.&lt;/exception&gt;</em></div>
<div class="fsdocs-tip" id="fs79">val qvaluesSmoothed : obj</div>
<div class="fsdocs-tip" id="fs80">val pValsSorted : float []</div>
<div class="fsdocs-tip" id="fs81">val sortDescending : array:&#39;T [] -&gt; &#39;T [] (requires comparison)<br /><em>&lt;summary&gt;Sorts the elements of an array, in descending order, returning a new array. Elements are compared using &lt;see cref=&quot;M:Microsoft.FSharp.Core.Operators.compare&quot; /&gt;. &lt;/summary&gt;<br />&lt;remarks&gt;This is not a stable sort, i.e. the original order of equal elements is not necessarily preserved. 
 For a stable sort, consider using &lt;see cref=&quot;M:Microsoft.FSharp.Collections.SeqModule.Sort&quot; /&gt;.&lt;/remarks&gt;<br />&lt;param name=&quot;array&quot;&gt;The input array.&lt;/param&gt;<br />&lt;returns&gt;The sorted array.&lt;/returns&gt;</em></div>
<div class="fsdocs-tip" id="fs82">val loop : (int -&gt; float -&gt; (float * float) list -&gt; (float * float) list)</div>
<div class="fsdocs-tip" id="fs83">val i : int</div>
<div class="fsdocs-tip" id="fs84">val lowest : float</div>
<div class="fsdocs-tip" id="fs85">val acc : (float * float) list</div>
<div class="fsdocs-tip" id="fs86">property System.Array.Length: int with get<br /><em>&lt;summary&gt;Gets the total number of elements in all the dimensions of the &lt;see cref=&quot;T:System.Array&quot; /&gt;.&lt;/summary&gt;<br />&lt;exception cref=&quot;T:System.OverflowException&quot;&gt;The array is multidimensional and contains more than &lt;see cref=&quot;F:System.Int32.MaxValue&quot; /&gt; elements.&lt;/exception&gt;<br />&lt;returns&gt;The total number of elements in all the dimensions of the &lt;see cref=&quot;T:System.Array&quot; /&gt;; zero if there are no elements in the array.&lt;/returns&gt;</em></div>
<div class="fsdocs-tip" id="fs87">val rev : list:&#39;T list -&gt; &#39;T list<br /><em>&lt;summary&gt;Returns a new list with the elements in reverse order.&lt;/summary&gt;<br />&lt;param name=&quot;list&quot;&gt;The input list.&lt;/param&gt;<br />&lt;returns&gt;The reversed list.&lt;/returns&gt;</em></div>
<div class="fsdocs-tip" id="fs88">val q : float</div>
<div class="fsdocs-tip" id="fs89">val eXpos : int</div>
<div class="fsdocs-tip" id="fs90">val filter : predicate:(&#39;T -&gt; bool) -&gt; array:&#39;T [] -&gt; &#39;T []<br /><em>&lt;summary&gt;Returns a new collection containing only the elements of the collection
 for which the given predicate returns &quot;true&quot;.&lt;/summary&gt;<br />&lt;param name=&quot;predicate&quot;&gt;The function to test the input elements.&lt;/param&gt;<br />&lt;param name=&quot;array&quot;&gt;The input array.&lt;/param&gt;<br />&lt;returns&gt;An array containing the elements for which the given predicate returns true.&lt;/returns&gt;<br />&lt;exception cref=&quot;T:System.ArgumentNullException&quot;&gt;Thrown when the input array is null.&lt;/exception&gt;</em></div>
<div class="fsdocs-tip" id="fs91">val p2qValeChart : obj</div>
<div class="fsdocs-tip" id="fs92">val sprintf : format:Printf.StringFormat&lt;&#39;T&gt; -&gt; &#39;T<br /><em>&lt;summary&gt;Print to a string using the given format.&lt;/summary&gt;<br />&lt;param name=&quot;format&quot;&gt;The formatter.&lt;/param&gt;<br />&lt;returns&gt;The formatted result.&lt;/returns&gt;</em></div>
<div class="fsdocs-tip" id="fs93">val pi0Est : (float * float) []</div>
<div class="fsdocs-tip" id="fs94">val lambda : float</div>
<div class="fsdocs-tip" id="fs95">val num : float</div>
<div class="fsdocs-tip" id="fs96">val den : float</div>
<div class="fsdocs-tip" id="fs97">val pi0EstChart : obj</div>
<div class="fsdocs-tip" id="fs98">val getpi0Bootstrap : lambda:float [] -&gt; pValues:float [] -&gt; (float * float []) []</div>
<div class="fsdocs-tip" id="fs99">val lambda : float []</div>
<div class="fsdocs-tip" id="fs100">val pValues : float []</div>
<div class="fsdocs-tip" id="fs101">val rnd : System.Random</div>
<div class="fsdocs-tip" id="fs102">Multiple items<br />type Random =
  new : unit -&gt; unit + 1 overload
  member Next : unit -&gt; int + 2 overloads
  member NextBytes : buffer: byte [] -&gt; unit + 1 overload
  member NextDouble : unit -&gt; float
  member Sample : unit -&gt; float<br /><em>&lt;summary&gt;Represents a pseudo-random number generator, which is an algorithm that produces a sequence of numbers that meet certain statistical requirements for randomness.&lt;/summary&gt;</em><br /><br />--------------------<br />System.Random() : System.Random<br />System.Random(Seed: int) : System.Random</div>
<div class="fsdocs-tip" id="fs103">val getpi0hat : (float -&gt; float [] -&gt; float)</div>
<div class="fsdocs-tip" id="fs104">val pVals : float []</div>
<div class="fsdocs-tip" id="fs105">val hits : float</div>
<div class="fsdocs-tip" id="fs106">val getMSE : (float -&gt; float [])</div>
<div class="fsdocs-tip" id="fs107">val mse : float []</div>
<div class="fsdocs-tip" id="fs108">val b : int</div>
<div class="fsdocs-tip" id="fs109">val sampleWithReplacement : rnd:System.Random -&gt; source:&#39;a array -&gt; k:int -&gt; &#39;a []<br /><em>&lt;summary&gt;
 Samples from an array of obj wit replacement (with putting back)
&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs110">val l : float</div>
<div class="fsdocs-tip" id="fs111">val minimalpihat : float</div>
<div class="fsdocs-tip" id="fs112">val minpiHatShape : obj</div>
<div class="fsdocs-tip" id="fs113">val bootstrappedPi0 : obj</div>
<div class="fsdocs-tip" id="fs114">val x : float []</div>
<div class="fsdocs-tip" id="fs115">module MultipleTesting

from FSharp.Stats.Testing<br /><em>&lt;summary&gt;
 This module contains functions to adjust for multiple testing errors in statistical tests.
&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs116">val pi0Stats : float</div>
<div class="fsdocs-tip" id="fs117">module Qvalues

from FSharp.Stats.Testing.MultipleTesting<br /><em>&lt;summary&gt;
 Estimate the q-values for a given set of p-values. The q-value of a test measures the proportion of false positives incurred (called the false discovery rate) when that particular test is called significant. 
&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs118">val pi0BootstrapWithLambda : lambda:float [] -&gt; pValues:float [] -&gt; float<br /><em>&lt;summary&gt;
 Estimates pi0 from given p-Values by Storeys bootstrap .
 pi0 is the value to which, one can find certain values of the distribution at random.
 If this returns 0. lambda needs to be smaller.
 Math Definition for lambda = [0,1) . Contains values from 0 to 1, but not 1.
&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs119">val qValues : float []</div>
<div class="fsdocs-tip" id="fs120">val ofPValues : pi0:float -&gt; pValues:float [] -&gt; float []<br /><em>&lt;summary&gt;
 Calculates q-values from given p-values and returns an array of qValues in the same order.
 &#39;pi0&#39; can be calculated with &#39;pi0Bootstrap&#39; or &#39;pi0BootstrapWithLambda&#39;.
&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs121">val pi0Line : obj</div>
<div class="fsdocs-tip" id="fs122">val p2q : obj</div>
<div class="fsdocs-tip" id="fs123">val zip : array1:&#39;T1 [] -&gt; array2:&#39;T2 [] -&gt; (&#39;T1 * &#39;T2) []<br /><em>&lt;summary&gt;Combines the two arrays into an array of pairs. The two arrays must have equal lengths, otherwise an &lt;c&gt;ArgumentException&lt;/c&gt; is
 raised.&lt;/summary&gt;<br />&lt;param name=&quot;array1&quot;&gt;The first input array.&lt;/param&gt;<br />&lt;param name=&quot;array2&quot;&gt;The second input array.&lt;/param&gt;<br />&lt;exception cref=&quot;T:System.ArgumentNullException&quot;&gt;Thrown when either of the input arrays is null.&lt;/exception&gt;<br />&lt;exception cref=&quot;T:System.ArgumentException&quot;&gt;Thrown when the input arrays differ in length.&lt;/exception&gt;<br />&lt;returns&gt;The array of tupled elements.&lt;/returns&gt;</em></div>
<div class="fsdocs-tip" id="fs124">val sortBy : projection:(&#39;T -&gt; &#39;Key) -&gt; array:&#39;T [] -&gt; &#39;T [] (requires comparison)<br /><em>&lt;summary&gt;Sorts the elements of an array, using the given projection for the keys and returning a new array. 
 Elements are compared using &lt;see cref=&quot;M:Microsoft.FSharp.Core.Operators.compare&quot; /&gt;.&lt;/summary&gt;<br />&lt;remarks&gt;This is not a stable sort, i.e. the original order of equal elements is not necessarily preserved. 
 For a stable sort, consider using &lt;see cref=&quot;M:Microsoft.FSharp.Collections.SeqModule.Sort&quot; /&gt;.&lt;/remarks&gt;<br />&lt;param name=&quot;projection&quot;&gt;The function to transform array elements into the type that is compared.&lt;/param&gt;<br />&lt;param name=&quot;array&quot;&gt;The input array.&lt;/param&gt;<br />&lt;returns&gt;The sorted array.&lt;/returns&gt;<br />&lt;exception cref=&quot;T:System.ArgumentNullException&quot;&gt;Thrown when the input array is null.&lt;/exception&gt;</em></div>
<div class="fsdocs-tip" id="fs125">val fst : tuple:(&#39;T1 * &#39;T2) -&gt; &#39;T1<br /><em>&lt;summary&gt;Return the first element of a tuple, &lt;c&gt;fst (a,b) = a&lt;/c&gt;.&lt;/summary&gt;<br />&lt;param name=&quot;tuple&quot;&gt;The input tuple.&lt;/param&gt;<br />&lt;returns&gt;The first value.&lt;/returns&gt;</em></div>
<div class="fsdocs-tip" id="fs126">val pValueDistribution : obj</div>
<div class="fsdocs-tip" id="fs127">val frequencyBins : float</div>
<div class="fsdocs-tip" id="fs128">val pi0Estimation : obj</div>

    </div>

    <!-- BEGIN SEARCH BOX: this adds support for the search box -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/JavaScript-autoComplete/1.0.4/auto-complete.css" />
    <script type="text/javascript">var fsdocs_search_baseurl = '/CSBlog/'</script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.8/lunr.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/JavaScript-autoComplete/1.0.4/auto-complete.min.js"></script>
    <script type="text/javascript" src="/CSBlog/content/fsdocs-search.js"></script>
    <!-- END SEARCH BOX: this adds support for the search box -->
</body>
<footer>
    <script>
        bulmaCollapsible.attach('.is-collapsible');
    </script>
</footer>
</html>